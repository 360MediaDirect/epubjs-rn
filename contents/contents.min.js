(function(s,u){'object'==typeof exports&&'object'==typeof module?module.exports=u(require('xmldom')):'function'==typeof define&&define.amd?define(['xmldom'],u):'object'==typeof exports?exports.EPUBJSContents=u(require('xmldom')):s.EPUBJSContents=u(s.xmldom)})(this,function(t){return function(s){function u(f){if(p[f])return p[f].exports;var g=p[f]={exports:{},id:f,loaded:!1};return s[f].call(g.exports,g,g.exports,u),g.loaded=!0,g.exports}var p={};return u.m=s,u.c=p,u.p='',u(0)}([function(s,u,p){var f=p(1);s.exports=f},function(s,u,p){'use strict';function f(L){return L&&L.__esModule?L:{default:L}}function g(L,P){if(!(L instanceof P))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var y=function(){function L(P,A){for(var O=0;O<A.length;O++){var z=A[O];z.enumerable=z.enumerable||!1,z.configurable=!0,'value'in z&&(z.writable=!0),Object.defineProperty(P,z.key,z)}}return function(P,A,O){return A&&L(P.prototype,A),O&&L(P,O),P}}(),v=p(2),x=f(v),k=p(17),C=p(19),S=f(C),E=p(20),T=f(E),_=p(21),R=['keydown','keyup','keypressed','mouseup','mousedown','click','touchend','touchstart'],N=function(){function L(P,A,O){g(this,L),this.epubcfi=new S.default,this.document=P,this.documentElement=this.document.documentElement,this.content=A||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.cfiBase=O||'',this.listeners()}return y(L,[{key:'width',value:function(A){var O=this.content;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.width=A),this.window.getComputedStyle(O).width}},{key:'height',value:function(A){var O=this.content;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.height=A),this.window.getComputedStyle(O).height}},{key:'contentWidth',value:function(A){var O=this.content||this.document.body;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.width=A),this.window.getComputedStyle(O).width}},{key:'contentHeight',value:function(A){var O=this.content||this.document.body;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.height=A),this.window.getComputedStyle(O).height}},{key:'textWidth',value:function(){var A,O=this.document.createRange(),z=this.content||this.document.body;return O.selectNodeContents(z),A=O.getBoundingClientRect().width,A}},{key:'textHeight',value:function(){var A,O=this.document.createRange(),z=this.content||this.document.body;return O.selectNodeContents(z),A=O.getBoundingClientRect().height,A}},{key:'scrollWidth',value:function(){var A=this.documentElement.scrollWidth;return A}},{key:'scrollHeight',value:function(){var A=this.documentElement.scrollHeight;return A}},{key:'overflow',value:function(A){return A&&(this.documentElement.style.overflow=A),this.window.getComputedStyle(this.documentElement).overflow}},{key:'overflowX',value:function(A){return A&&(this.documentElement.style.overflowX=A),this.window.getComputedStyle(this.documentElement).overflowX}},{key:'overflowY',value:function(A){return A&&(this.documentElement.style.overflowY=A),this.window.getComputedStyle(this.documentElement).overflowY}},{key:'css',value:function(A,O,z){var B=this.content||this.document.body;return O&&B.style.setProperty(A,O,z?'important':''),this.window.getComputedStyle(B)[A]}},{key:'viewport',value:function(A){var O,z,B,W,M,U,I=this.document.querySelector('meta[name=\'viewport\']'),D='';if(I&&I.hasAttribute('content')){var F=I.getAttribute('content'),H=F.match(/width\s*=\s*([^,]*)/g),X=F.match(/height\s*=\s*([^,]*)/g),Y=F.match(/initial-scale\s*=\s*([^,]*)/g),Q=F.match(/minimum-scale\s*=\s*([^,]*)/g),V=F.match(/maximum-scale\s*=\s*([^,]*)/g),J=F.match(/user-scalable\s*=\s*([^,]*)/g);H[1]&&(O=H[1]),X[1]&&(z=X[1]),Y[1]&&(B=Y[1]),Q[1]&&(W=Q[1]),V[1]&&(M=V[1]),J[1]&&(U=J[1])}return A&&(D+='width='+(A.width||O),D+=', height='+(A.height||z),(A.scale||B)&&(D+=', initial-scale='+(A.scale||B)),(A.scalable||U)&&(D+=', minimum-scale='+(A.scale||W),D+=', maximum-scale='+(A.scale||M),D+=', user-scalable='+(A.scalable||U)),!I&&(I=this.document.createElement('meta'),I.setAttribute('name','viewport'),this.document.querySelector('head').appendChild(I)),I.setAttribute('content',D)),{width:parseInt(O),height:parseInt(z)}}},{key:'expand',value:function(){this.emit('expand')}},{key:'listeners',value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),this.resizeListeners(),this.linksHandler()}},{key:'removeListeners',value:function(){this.removeEventListeners(),this.removeSelectionListeners()}},{key:'resizeListeners',value:function(){var A,O;clearTimeout(this.expanding),A=this.scrollWidth(),O=this.scrollHeight(),(A!=this._size.width||O!=this._size.height)&&(this._size={width:A,height:O},this.emit('resize',this._size)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:'mediaQueryListeners',value:function(){var A=this.document.styleSheets,O=function(U){U.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this);for(var z=0;z<A.length;z+=1){var B;try{B=A[z].cssRules}catch(U){return}if(!B)return;for(var W=0;W<B.length;W+=1)if(B[W].media){var M=this.window.matchMedia(B[W].media.mediaText);M.addListener(O)}}}},{key:'observe',value:function(A){var O=this,z=new MutationObserver(function(){O._expanding&&O.expand()});return z.observe(A,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),z}},{key:'imageLoadListeners',value:function(){var O,A=this.document.querySelectorAll('img');for(var z=0;z<A.length;z++)O=A[z],'undefined'!=typeof O.naturalWidth&&0===O.naturalWidth&&(O.onload=this.expand.bind(this))}},{key:'fontLoadListeners',value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.expand()}.bind(this))}},{key:'root',value:function(){return this.document?this.document.documentElement:null}},{key:'locationOf',value:function(A,O){var z,B={left:0,top:0};if(this.document){if(this.epubcfi.isCfiString(A)){var W=new S.default(A).toRange(this.document,O);W&&(W.startContainer.nodeType===Node.ELEMENT_NODE?(z=W.startContainer.getBoundingClientRect(),B.left=z.left,B.top=z.top):W.collapsed?z=W.getClientRects()[0]:z=W.getBoundingClientRect())}else if('string'==typeof A&&-1<A.indexOf('#')){var M=A.substring(A.indexOf('#')+1),U=this.document.getElementById(M);U&&(z=U.getBoundingClientRect())}return z&&(B.left=z.left,B.top=z.top),B}}},{key:'addStylesheet',value:function(A){return new Promise(function(O){var z,B=!1;return this.document?(z=this.document.querySelector('link[href=\''+A+'\']'),z?void O(!0):void(z=this.document.createElement('link'),z.type='text/css',z.rel='stylesheet',z.href=A,z.onload=z.onreadystatechange=function(){B||this.readyState&&'complete'!=this.readyState||(B=!0,setTimeout(function(){O(!0)},1))},this.document.head.appendChild(z))):void O(!1)}.bind(this))}},{key:'addStylesheetRules',value:function(A){var O,z,B='epubjs-inserted-css';if(this.document&&A&&0!==A.length)if(O=this.document.getElementById('#'+B),O||(O=this.document.createElement('style'),O.id=B),this.document.head.appendChild(O),z=O.sheet,'[object Array]'===Object.prototype.toString.call(A))for(var W=0,M=A.length;W<M;W++){var U=1,I=A[W],D=A[W][0],F='';'[object Array]'===Object.prototype.toString.call(I[1][0])&&(I=I[1],U=0);for(var H=I.length;U<H;U++){var X=I[U];F+=X[0]+':'+X[1]+(X[2]?' !important':'')+';\n'}z.insertRule(D+'{'+F+'}',z.cssRules.length)}else{var Y=Object.keys(A);Y.forEach(function($){var K=A[$],ee=Object.keys(K),te=ee.map(function(ne){return ne+':'+K[ne]}).join(';');z.insertRule($+'{'+te+'}',z.cssRules.length)})}}},{key:'addScript',value:function(A){return new Promise(function(O){var z,B=!1;return this.document?void(z=this.document.createElement('script'),z.type='text/javascript',z.async=!0,z.src=A,z.onload=z.onreadystatechange=function(){B||this.readyState&&'complete'!=this.readyState||(B=!0,setTimeout(function(){O(!0)},1))},this.document.head.appendChild(z)):void O(!1)}.bind(this))}},{key:'addClass',value:function(A){var O;this.document&&(O=this.content||this.document.body,O.classList.add(A))}},{key:'removeClass',value:function(A){var O;this.document&&(O=this.content||this.document.body,O.classList.remove(A))}},{key:'addEventListeners',value:function(){this.document&&R.forEach(function(A){this.document.addEventListener(A,this.triggerEvent.bind(this),!1)},this)}},{key:'removeEventListeners',value:function(){this.document&&R.forEach(function(A){this.document.removeEventListener(A,this.triggerEvent,!1)},this)}},{key:'triggerEvent',value:function(A){this.emit(A.type,A)}},{key:'addSelectionListeners',value:function(){this.document&&this.document.addEventListener('selectionchange',this.onSelectionChange.bind(this),!1)}},{key:'removeSelectionListeners',value:function(){this.document&&this.document.removeEventListener('selectionchange',this.onSelectionChange,!1)}},{key:'onSelectionChange',value:function(){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var A=this.window.getSelection();this.triggerSelectedEvent(A)}.bind(this),500)}},{key:'triggerSelectedEvent',value:function(A){var O,z;A&&0<A.rangeCount&&(O=A.getRangeAt(0),!O.collapsed&&(z=new S.default(O,this.cfiBase).toString(),this.emit('selected',z),this.emit('selectedRange',O)))}},{key:'range',value:function(A,O){var z=new S.default(A);return z.toRange(this.document,O)}},{key:'cfiFromRange',value:function(A,O){return new S.default(A,this.cfiBase,O).toString()}},{key:'cfiFromNode',value:function(A,O){return new S.default(A,this.cfiBase,O).toString()}},{key:'map',value:function(A){var P=new T.default(A);return P.section()}},{key:'size',value:function(A,O){0<=A&&this.width(A),0<=O&&this.height(O),this.css('margin','0'),this.css('box-sizing','border-box')}},{key:'columns',value:function(A,O,z,B){var W=(0,k.prefixed)('column-axis'),M=(0,k.prefixed)('column-gap'),U=(0,k.prefixed)('column-width'),I=(0,k.prefixed)('column-fill');this.width(A),this.height(O),this.viewport({width:A,height:O,scale:1,scalable:'no'}),this.css('overflow-y','hidden'),this.css('margin','0',!0),this.css('padding','0',!0),this.css('box-sizing','border-box'),this.css('max-width','inherit'),this.css(W,'horizontal'),this.css(I,'auto'),this.css(M,B+'px'),this.css(U,z+'px')}},{key:'scaler',value:function(A,O,z){var B='';this.css('transform-origin','top left'),(0<=O||0<=z)&&(B=' translate('+(O||0)+'px, '+(z||0)+'px )'),this.css('transform','scale('+A+')'+B)}},{key:'fit',value:function(A,O){var z=this.viewport(),B=A/z.width,W=O/z.height,M=B<W?B:W,U=(O-z.height*M)/2;this.width(A),this.height(O),this.overflow('hidden'),this.viewport({scale:1}),this.scaler(M,0,U),this.css('background-color','transparent')}},{key:'mapPage',value:function(A,O,z,B,W){var M=new T.default(O,W);return M.page(this,A,z,B)}},{key:'linksHandler',value:function(){var A=this;(0,_.replaceLinks)(this.content,function(O){A.emit('link',O)})}},{key:'destroy',value:function(){this.observer&&this.observer.disconnect(),this.removeListeners()}}],[{key:'listenedEvents',get:function(){return R}}]),L}();(0,x.default)(N.prototype),u.default=N,s.exports=u['default']},function(s,u,p){'use strict';var T,_,R,N,L,P,A,f=p(3),g=p(16),y=Function.prototype.apply,v=Function.prototype.call,x=Object.create,k=Object.defineProperty,C=Object.defineProperties,S=Object.prototype.hasOwnProperty,E={configurable:!0,enumerable:!1,writable:!0};T=function(O,z){var B;return g(z),S.call(this,'__ee__')?B=this.__ee__:(B=E.value=x(null),k(this,'__ee__',E),E.value=null),B[O]?'object'==typeof B[O]?B[O].push(z):B[O]=[B[O],z]:B[O]=z,this},_=function(O,z){var B,W;return g(z),W=this,T.call(this,O,B=function(){R.call(W,O,B),y.call(z,this,arguments)}),B.__eeOnceListener__=z,this},R=function(O,z){var B,W,M,U;if(g(z),!S.call(this,'__ee__'))return this;if(B=this.__ee__,!B[O])return this;if(W=B[O],'object'==typeof W)for(U=0;M=W[U];++U)(M===z||M.__eeOnceListener__===z)&&(2===W.length?B[O]=W[U?0:1]:W.splice(U,1));else(W===z||W.__eeOnceListener__===z)&&delete B[O];return this},N=function(O){var z,B,W,M,U;if(S.call(this,'__ee__')&&(M=this.__ee__[O],M))if('object'==typeof M){for(B=arguments.length,U=Array(B-1),z=1;z<B;++z)U[z-1]=arguments[z];for(M=M.slice(),z=0;W=M[z];++z)y.call(W,this,U)}else switch(arguments.length){case 1:v.call(M,this);break;case 2:v.call(M,this,arguments[1]);break;case 3:v.call(M,this,arguments[1],arguments[2]);break;default:for(B=arguments.length,U=Array(B-1),z=1;z<B;++z)U[z-1]=arguments[z];y.call(M,this,U);}},L={on:T,once:_,off:R,emit:N},P={on:f(T),once:f(_),off:f(R),emit:f(N)},A=C({},P),s.exports=u=function(O){return null==O?x(A):C(Object(O),P)},u.methods=L},function(s,u,p){'use strict';var x,f=p(4),g=p(11),y=p(12),v=p(13);x=s.exports=function(k,C){var S,E,T,_,R;return 2>arguments.length||'string'!=typeof k?(_=C,C=k,k=null):_=arguments[2],null==k?(S=T=!0,E=!1):(S=v.call(k,'c'),E=v.call(k,'e'),T=v.call(k,'w')),R={value:C,configurable:S,enumerable:E,writable:T},_?f(g(_),R):R},x.gs=function(k,C,S){var E,T,_,R;return'string'==typeof k?_=arguments[3]:(_=S,S=C,C=k,k=null),null==C?C=void 0:y(C)?null==S?S=void 0:!y(S)&&(_=S,S=void 0):(_=C,C=S=void 0),null==k?(E=!0,T=!1):(E=v.call(k,'c'),T=v.call(k,'e')),R={get:C,set:S,configurable:E,enumerable:T},_?f(g(_),R):R}},function(s,u,p){'use strict';s.exports=p(5)()?Object.assign:p(6)},function(s){'use strict';s.exports=function(){var p,u=Object.assign;return!('function'!=typeof u)&&(p={foo:'raz'},u(p,{bar:'dwa'},{trzy:'trzy'}),'razdwatrzy'===p.foo+p.bar+p.trzy)}},function(s,u,p){'use strict';var f=p(7),g=p(10),y=Math.max;s.exports=function(v,x){var k,C,E,S=y(arguments.length,2);for(v=Object(g(v)),E=function(T){try{v[T]=x[T]}catch(_){k||(k=_)}},C=1;C<S;++C)x=arguments[C],f(x).forEach(E);if(k!==void 0)throw k;return v}},function(s,u,p){'use strict';s.exports=p(8)()?Object.keys:p(9)},function(s){'use strict';s.exports=function(){try{return Object.keys('primitive'),!0}catch(u){return!1}}},function(s){'use strict';var u=Object.keys;s.exports=function(p){return u(null==p?p:Object(p))}},function(s){'use strict';s.exports=function(u){if(null==u)throw new TypeError('Cannot use null or undefined');return u}},function(s){'use strict';var u=Array.prototype.forEach,p=Object.create,f=function(g,y){for(var v in g)y[v]=g[v]};s.exports=function(){var g=p(null);return u.call(arguments,function(y){null==y||f(Object(y),g)}),g}},function(s){'use strict';s.exports=function(u){return'function'==typeof u}},function(s,u,p){'use strict';s.exports=p(14)()?String.prototype.contains:p(15)},function(s){'use strict';var u='razdwatrzy';s.exports=function(){return!('function'!=typeof u.contains)&&!0===u.contains('dwa')&&!1===u.contains('foo')}},function(s){'use strict';var u=String.prototype.indexOf;s.exports=function(p){return-1<u.call(this,p,arguments[1])}},function(s){'use strict';s.exports=function(u){if('function'!=typeof u)throw new TypeError(u+' is not a function');return u}},function(s,u,p){'use strict';function f(){var E=new Date().getTime(),T='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(_){var R=0|(E+16*Math.random())%16;return E=Math.floor(E/16),('x'==_?R:8|7&R).toString(16)});return T}function g(E){return!isNaN(parseFloat(E))&&isFinite(E)}function y(E,T,_,R,N){var O,L=R||0,P=N||T.length,A=parseInt(L+(P-L)/2);return(_||(_=function(B,W){return B>W?1:B<W?-1:B==W?0:void 0}),0>=P-L)?A:(O=_(T[A],E),1==P-L?0<O?A:A+1:0===O?A:-1===O?y(E,T,_,A,P):y(E,T,_,L,A))}function v(E,T,_,R,N){var O,L=R||0,P=N||T.length,A=parseInt(L+(P-L)/2);return(_||(_=function(B,W){return B>W?1:B<W?-1:B==W?0:void 0}),0>=P-L)?-1:(O=_(T[A],E),1==P-L?0===O?A:-1:0===O?A:-1===O?v(E,T,_,A,P):v(E,T,_,L,A))}function x(E,T){var _=E.parentNode,R=_.childNodes,N,L=-1;for(var P=0;P<R.length&&(N=R[P],N.nodeType===T&&L++,N!=E);P++);return L}function k(E,T){return'undefined'==typeof E.querySelector?E.getElementsByTagName(T):E.querySelectorAll(T)}function C(E,T,_){for(var R=document.createTreeWalker(E,_,null,!1),N=void 0;N=R.nextNode();)T(N)}function S(E,T){if(T(E))return!0;if(E=E.firstChild,E)do{var _=S(E,T);if(_)return!0;E=E.nextSibling}while(E)}Object.defineProperty(u,'__esModule',{value:!0}),u.isElement=function(T){return!!(T&&1==T.nodeType)},u.uuid=f,u.documentHeight=function(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},u.isNumber=g,u.isFloat=function(T){return g(T)&&Math.floor(T)!==T},u.prefixed=function(T){var _=['-Webkit-','-moz-','-o-','-ms-'],R=T[0].toUpperCase()+T.slice(1),N=_.length;if('undefined'==typeof document||'undefined'!=typeof document.body.style[T])return T;for(var L=0;L<N;L++)if('undefined'!=typeof document.body.style[_[L]+R])return _[L]+R;return T},u.defaults=function(T){for(var _=1,R=arguments.length;_<R;_++){var N=arguments[_];for(var L in N)void 0===T[L]&&(T[L]=N[L])}return T},u.extend=function(T){var _=[].slice.call(arguments,1);return _.forEach(function(R){R&&Object.getOwnPropertyNames(R).forEach(function(N){Object.defineProperty(T,N,Object.getOwnPropertyDescriptor(R,N))})}),T},u.insert=function(T,_,R){var N=y(T,_,R);return _.splice(N,0,T),N},u.locationOf=y,u.indexOfSorted=v,u.bounds=function(T){var _=window.getComputedStyle(T),R=0,N=0;return['width','paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(L){R+=parseFloat(_[L])||0}),['height','paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(L){N+=parseFloat(_[L])||0}),{height:N,width:R}},u.borders=function(T){var _=window.getComputedStyle(T),R=0,N=0;return['paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(L){R+=parseFloat(_[L])||0}),['paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(L){N+=parseFloat(_[L])||0}),{height:N,width:R}},u.windowBounds=function(){var T=window.innerWidth,_=window.innerHeight;return{top:0,left:0,right:T,bottom:_,width:T,height:_}},u.cleanStringForXpath=function(T){var _=T.match(/[^'"]+|['"]/g);return _=_.map(function(R){return'\''===R?'"\'"':'"'===R?'\'"\'':'\''+R+'\''}),'concat(\'\','+_.join(',')+')'},u.indexOfNode=x,u.indexOfTextNode=function(T){return x(T,3)},u.indexOfElementNode=function(T){return x(T,1)},u.isXml=function(T){return-1<['xml','opf','ncx'].indexOf(T)},u.createBlob=function(T,_){return new Blob([T],{type:_})},u.createBlobUrl=function(T,_){var N,R=window.URL||window.webkitURL||window.mozURL,L=this.createBlob(T,_);return N=R.createObjectURL(L),N},u.createBase64Url=function(T,_){var R,N;if('string'==typeof T)return R=btoa(T),N='data:'+_+';base64,'+R,N},u.type=function(T){return Object.prototype.toString.call(T).slice(8,-1)},u.parse=function(T,_,R){var N,L;return L='undefined'==typeof DOMParser||R?p(18).DOMParser:DOMParser,65279===T.charCodeAt(0)&&(T=T.slice(1)),N=new L().parseFromString(T,_),N},u.qs=function(T,_){var R;if(!T)throw new Error('No Element Provided');return'undefined'==typeof T.querySelector?(R=T.getElementsByTagName(_),R.length)?R[0]:void 0:T.querySelector(_)},u.qsa=k,u.qsp=function(T,_,R){var N,L;if('undefined'!=typeof T.querySelector){for(var P in _+='[',R)_+=P+'=\''+R[P]+'\'';return _+=']',T.querySelector(_)}return(N=T.getElementsByTagName(_),L=Array.prototype.slice.call(N,0).filter(function(A){for(var O in R)if(A.getAttribute(O)===R[O])return!0;return!1}),L)?L[0]:void 0},u.sprint=function(T,_){var R=T.ownerDocument||T;'undefined'==typeof R.createTreeWalker?S(T,function(N){N&&3===N.nodeType&&_(N)},!0):C(T,_,NodeFilter.SHOW_TEXT)},u.treeWalker=C,u.walk=S,u.blob2base64=function(T){return new Promise(function(_){var R=new FileReader;R.readAsDataURL(T),R.onloadend=function(){_(R.result)}})},u.defer=function(){var T=this;this.resolve=null,this.reject=null,this.id=f(),this.promise=new Promise(function(_,R){T.resolve=_,T.reject=R}),Object.freeze(this)},u.querySelectorByType=function(T,_,R){var N;if('undefined'!=typeof T.querySelector&&(N=T.querySelector(_+'[*|type="'+R+'"]')),!N||0===N.length){N=k(T,_);for(var L=0;L<N.length;L++)if(N[L].getAttributeNS('http://www.idpf.org/2007/ops','type')===R)return N[L]}else return N},u.findChildren=function(T){var _=[],R=T.childNodes;for(var N=0;N<R.length;N++){var L=R[N];1===L.nodeType&&_.push(L)}return _},u.requestAnimationFrame='undefined'!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)},function(s){s.exports=t},function(s,u,p){'use strict';function f(S,E){if(!(S instanceof E))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var g='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(S){return typeof S}:function(S){return S&&'function'==typeof Symbol&&S.constructor===Symbol&&S!==Symbol.prototype?'symbol':typeof S},y=function(){function S(E,T){for(var _=0;_<T.length;_++){var R=T[_];R.enumerable=R.enumerable||!1,R.configurable=!0,'value'in R&&(R.writable=!0),Object.defineProperty(E,R.key,R)}}return function(E,T,_){return T&&S(E.prototype,T),_&&S(E,_),E}}(),v=p(17),x=1,k=3,C=function(){function S(E,T,_){f(this,S);var R;if(this.str='',this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof S))return new S(E,T,_);if('string'==typeof T?this.base=this.parseComponent(T):'object'===('undefined'==typeof T?'undefined':g(T))&&T.steps&&(this.base=T),R=this.checkType(E),'string'===R)return this.str=E,(0,v.extend)(this,this.parse(E));if('range'===R)return(0,v.extend)(this,this.fromRange(E,this.base,_));if('node'===R)return(0,v.extend)(this,this.fromNode(E,this.base,_));if('EpubCFI'===R&&E.path)return E;if(!E)return this;throw new TypeError('not a valid argument for EpubCFI')}return y(S,[{key:'checkType',value:function(T){return this.isCfiString(T)?'string':'object'===('undefined'==typeof T?'undefined':g(T))&&('Range'===(0,v.type)(T)||'undefined'!=typeof T.startContainer)?'range':'object'===('undefined'==typeof T?'undefined':g(T))&&'undefined'!=typeof T.nodeType?'node':'object'===('undefined'==typeof T?'undefined':g(T))&&T instanceof S&&'EpubCFI'}},{key:'parse',value:function(T){var R,N,L,_={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return'string'==typeof T?(0===T.indexOf('epubcfi(')&&')'===T[T.length-1]&&(T=T.slice(8,T.length-1)),R=this.getChapterComponent(T),!R)?{spinePos:-1}:(_.base=this.parseComponent(R),N=this.getPathComponent(T),_.path=this.parseComponent(N),L=this.getRange(T),L&&(_.range=!0,_.start=this.parseComponent(L[0]),_.end=this.parseComponent(L[1])),_.spinePos=_.base.steps[1].index,_):{spinePos:-1}}},{key:'parseComponent',value:function(T){var L,_={steps:[],terminal:{offset:null,assertion:null}},R=T.split(':'),N=R[0].split('/');return 1<R.length&&(L=R[1],_.terminal=this.parseTerminal(L)),''===N[0]&&N.shift(),_.steps=N.map(function(P){return this.parseStep(P)}.bind(this)),_}},{key:'parseStep',value:function(T){var _,R,N,L,P;if(L=T.match(/\[(.*)\]/),L&&L[1]&&(P=L[1]),R=parseInt(T),!isNaN(R))return 0==R%2?(_='element',N=R/2-1):(_='text',N=(R-1)/2),{type:_,index:N,id:P||null}}},{key:'parseTerminal',value:function(T){var _,R,N=T.match(/\[(.*)\]/);return N&&N[1]?(_=parseInt(T.split('[')[0])||null,R=N[1]):_=parseInt(T)||null,{offset:_,assertion:R}}},{key:'getChapterComponent',value:function(T){var _=T.split('!');return _[0]}},{key:'getPathComponent',value:function(T){var _=T.split('!');if(_[1]){var R=_[1].split(',');return R[0]}}},{key:'getRange',value:function(T){var _=T.split(',');return 3===_.length&&[_[1],_[2]]}},{key:'getCharecterOffsetComponent',value:function(T){var _=T.split(':');return _[1]||''}},{key:'joinSteps',value:function(T){return T?T.map(function(_){var R='';return'element'===_.type&&(R+=2*(_.index+1)),'text'===_.type&&(R+=1+2*_.index),_.id&&(R+='['+_.id+']'),R}).join('/'):''}},{key:'segmentString',value:function(T){var E='/';return E+=this.joinSteps(T.steps),T.terminal&&null!=T.terminal.offset&&(E+=':'+T.terminal.offset),T.terminal&&null!=T.terminal.assertion&&(E+='['+T.terminal.assertion+']'),E}},{key:'toString',value:function(){var T='epubcfi(';return T+=this.segmentString(this.base),T+='!',T+=this.segmentString(this.path),this.start&&(T+=',',T+=this.segmentString(this.start)),this.end&&(T+=',',T+=this.segmentString(this.end)),T+=')',T}},{key:'compare',value:function(T,_){var R,N,L,P;if('string'==typeof T&&(T=new S(T)),'string'==typeof _&&(_=new S(_)),T.spinePos>_.spinePos)return 1;if(T.spinePos<_.spinePos)return-1;T.range?(R=T.path.steps.concat(T.start.steps),L=T.start.terminal):(R=T.path.steps,L=T.path.terminal),_.range?(N=_.path.steps.concat(_.start.steps),P=_.start.terminal):(N=_.path.steps,P=_.path.terminal);for(var A=0;A<R.length;A++){if(!R[A])return-1;if(!N[A])return 1;if(R[A].index>N[A].index)return 1;if(R[A].index<N[A].index)return-1}return R.length<N.length?1:L.offset>P.offset?1:L.offset<P.offset?-1:0}},{key:'step',value:function(T){var _=T.nodeType===k?'text':'element';return{id:T.id,tagName:T.tagName,type:_,index:this.position(T)}}},{key:'filteredStep',value:function(T,_){var N,R=this.filter(T,_);if(R)return N=R.nodeType===k?'text':'element',{id:R.id,tagName:R.tagName,type:N,index:this.filteredPosition(R,_)}}},{key:'pathTo',value:function(T,_,R){for(var P,N={steps:[],terminal:{offset:null,assertion:null}},L=T;L&&L.parentNode&&9!=L.parentNode.nodeType;)P=R?this.filteredStep(L,R):this.step(L),P&&N.steps.unshift(P),L=L.parentNode;return null!=_&&0<=_&&(N.terminal.offset=_,'text'!=N.steps[N.steps.length-1].type&&N.steps.push({type:'text',index:0})),N}},{key:'equalStep',value:function(T,_){return T&&_&&T.index===_.index&&T.id===_.id&&T.type===_.type}},{key:'fromRange',value:function(T,_,R){var N={range:!1,base:{},path:{},start:null,end:null},L=T.startContainer,P=T.endContainer,A=T.startOffset,O=T.endOffset,z=!1;if(R&&(z=null!=L.ownerDocument.querySelector('.'+R)),'string'==typeof _?(N.base=this.parseComponent(_),N.spinePos=N.base.steps[1].index):'object'===('undefined'==typeof _?'undefined':g(_))&&(N.base=_),T.collapsed)z&&(A=this.patchOffset(L,A,R)),N.path=this.pathTo(L,A,R);else{N.range=!0,z&&(A=this.patchOffset(L,A,R)),N.start=this.pathTo(L,A,R),z&&(O=this.patchOffset(P,O,R)),N.end=this.pathTo(P,O,R),N.path={steps:[],terminal:null};var W,B=N.start.steps.length;for(W=0;W<B&&this.equalStep(N.start.steps[W],N.end.steps[W]);W++)W===B-1?N.start.terminal===N.end.terminal&&(N.path.steps.push(N.start.steps[W]),N.range=!1):N.path.steps.push(N.start.steps[W]);N.start.steps=N.start.steps.slice(N.path.steps.length),N.end.steps=N.end.steps.slice(N.path.steps.length)}return N}},{key:'fromNode',value:function(T,_,R){var N={range:!1,base:{},path:{},start:null,end:null};return'string'==typeof _?(N.base=this.parseComponent(_),N.spinePos=N.base.steps[1].index):'object'===('undefined'==typeof _?'undefined':g(_))&&(N.base=_),N.path=this.pathTo(T,null,R),N}},{key:'filter',value:function(T,_){var R,N,L,P,A,O=!1;return(T.nodeType===k?(O=!0,L=T.parentNode,R=T.parentNode.classList.contains(_)):(O=!1,R=T.classList.contains(_)),R&&O)?(P=L.previousSibling,A=L.nextSibling,P&&P.nodeType===k?N=P:A&&A.nodeType===k&&(N=A),N)?N:T:R&&!O?!1:T}},{key:'patchOffset',value:function(T,_,R){if(T.nodeType!=k)throw new Error('Anchor must be a text node');var N=T,L=_;for(T.parentNode.classList.contains(R)&&(N=T.parentNode);N.previousSibling;){if(N.previousSibling.nodeType!==x)L+=N.previousSibling.textContent.length;else if(N.previousSibling.classList.contains(R))L+=N.previousSibling.textContent.length;else break;N=N.previousSibling}return L}},{key:'normalizedMap',value:function(T,_,R){var P,O,z,N={},L=-1,A=T.length;for(P=0;P<A;P++)O=T[P].nodeType,O===x&&T[P].classList.contains(R)&&(O=k),0<P&&O===k&&z===k?N[P]=L:_===O&&(L=L+1,N[P]=L),z=O;return N}},{key:'position',value:function(T){var _,R;return T.nodeType===x?(_=T.parentNode.children,!_&&(_=(0,v.findChildren)(T.parentNode)),R=Array.prototype.indexOf.call(_,T)):(_=this.textNodes(T.parentNode),R=_.indexOf(T)),R}},{key:'filteredPosition',value:function(T,_){var R,N,L;return T.nodeType===x?(R=T.parentNode.children,L=this.normalizedMap(R,x,_)):(R=T.parentNode.childNodes,T.parentNode.classList.contains(_)&&(T=T.parentNode,R=T.parentNode.childNodes),L=this.normalizedMap(R,k,_)),N=Array.prototype.indexOf.call(R,T),L[N]}},{key:'stepsToXpath',value:function(T){var _=['.','*'];return T.forEach(function(R){var N=R.index+1;R.id?_.push('*[position()='+N+' and @id=\''+R.id+'\']'):'text'===R.type?_.push('text()['+N+']'):_.push('*['+N+']')}),_.join('/')}},{key:'stepsToQuerySelector',value:function(T){var _=['html'];return T.forEach(function(R){var N=R.index+1;R.id?_.push('#'+R.id):'text'!==R.type&&_.push('*:nth-child('+N+')')}),_.join('>')}},{key:'textNodes',value:function(T,_){return Array.prototype.slice.call(T.childNodes).filter(function(R){return R.nodeType===k||_&&R.classList.contains(_)})}},{key:'walkToNode',value:function(T,_,R){var P,O,N=_||document,L=N.documentElement,A=T.length;for(O=0;O<A&&(P=T[O],'element'===P.type?P.id?L=N.getElementById(P.id):L=L.children[P.index]:'text'===P.type&&(L=this.textNodes(L,R)[P.index]),!!L);O++);return L}},{key:'findNode',value:function(T,_,R){var L,P,N=_||document;return R||'undefined'==typeof N.evaluate?R?L=this.walkToNode(T,N,R):L=this.walkToNode(T,N):(P=this.stepsToXpath(T),L=N.evaluate(P,N,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),L}},{key:'fixMiss',value:function(T,_,R,N){var O,z,L=this.findNode(T.slice(0,-1),R,N),P=L.childNodes,A=this.normalizedMap(P,k,N),B=T[T.length-1].index;for(var W in A){if(!A.hasOwnProperty(W))return;if(A[W]===B)if(O=P[W],z=O.textContent.length,_>z)_=_-z;else{L=O.nodeType===x?O.childNodes[0]:O;break}}return{container:L,offset:_}}},{key:'toRange',value:function(T,_){var L,P,A,O,B,W,U,R=T||document,N=R.createRange(),z=this,M=!!_&&null!=R.querySelector('.'+_);if(z.range?(L=z.start,B=z.path.steps.concat(L.steps),A=this.findNode(B,R,M?_:null),P=z.end,W=z.path.steps.concat(P.steps),O=this.findNode(W,R,M?_:null)):(L=z.path,B=z.path.steps,A=this.findNode(z.path.steps,R,M?_:null)),A)try{null==L.terminal.offset?N.setStart(A,0):N.setStart(A,L.terminal.offset)}catch(I){U=this.fixMiss(B,L.terminal.offset,R,M?_:null),N.setStart(U.container,U.offset)}else return null;if(O)try{null==P.terminal.offset?N.setEnd(O,0):N.setEnd(O,P.terminal.offset)}catch(I){U=this.fixMiss(W,z.end.terminal.offset,R,M?_:null),N.setEnd(U.container,U.offset)}return N}},{key:'isCfiString',value:function(T){return'string'==typeof T&&0===T.indexOf('epubcfi(')&&')'===T[T.length-1]}},{key:'generateChapterComponent',value:function(T,_,R){var N=parseInt(_),L='/'+2*(T+1)+'/';return L+=2*(N+1),R&&(L+='['+R+']'),L}}]),S}();u.default=C,s.exports=u['default']},function(s,u,p){'use strict';function f(k,C){if(!(k instanceof C))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var g=function(){function k(C,S){for(var E=0;E<S.length;E++){var T=S[E];T.enumerable=T.enumerable||!1,T.configurable=!0,'value'in T&&(T.writable=!0),Object.defineProperty(C,T.key,T)}}return function(C,S,E){return S&&k(C.prototype,S),E&&k(C,E),C}}(),y=p(19),v=function(C){return C&&C.__esModule?C:{default:C}}(y),x=function(){function k(C,S){f(this,k),this.layout=C,this.horizontal='paginated'===this.layout.flow,this._dev=S}return g(k,[{key:'section',value:function(S){var E=this.findRanges(S),T=this.rangeListToCfiList(S.section.cfiBase,E);return T}},{key:'page',value:function(S,E,T,_){var N,R=S&&S.document&&S.document.body;if(R){if(N=this.rangePairToCfiPair(E,{start:this.findStart(R,T,_),end:this.findEnd(R,T,_)}),!0===this._dev){var L=S.document,P=new v.default(N.start).toRange(L),A=new v.default(N.end).toRange(L),O=L.defaultView.getSelection(),z=L.createRange();O.removeAllRanges(),z.setStart(P.startContainer,P.startOffset),z.setEnd(A.endContainer,A.endOffset),O.addRange(z)}return N}}},{key:'walk',value:function(S,E){for(var _,R,T=document.createTreeWalker(S,NodeFilter.SHOW_TEXT,{acceptNode:function(L){return 0<L.data.trim().length?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);(_=T.nextNode())&&(R=E(_),!R););return R}},{key:'findRanges',value:function(S){var P,A,E=[],T=S.contents.scrollWidth(),_=Math.ceil(T/this.layout.spreadWidth),R=_*this.layout.divisor,N=this.layout.columnWidth,L=this.layout.gap;for(var O=0;O<R.pages;O++)P=(N+L)*O,A=N*(O+1)+L*O,E.push({start:this.findStart(S.document.body,P,A),end:this.findEnd(S.document.body,P,A)});return E}},{key:'findStart',value:function(S,E,T){for(var N,L,_=this,R=[S],P=S;R.length;)if(N=R.shift(),L=this.walk(N,function(A){var O,z,B,W;return(A.nodeType==Node.TEXT_NODE?(W=document.createRange(),W.selectNodeContents(A),B=W.getBoundingClientRect()):B=A.getBoundingClientRect(),O=_.horizontal?B.left:B.top,z=_.horizontal?B.right:B.bottom,O>=E&&O<=T)?A:z>E?A:void(P=A,R.push(A))}),L)return this.findTextStartRange(L,E,T);return this.findTextStartRange(P,E,T)}},{key:'findEnd',value:function(S,E,T){for(var N,P,_=this,R=[S],L=S;R.length;)if(N=R.shift(),P=this.walk(N,function(A){var O,z,B,W;return(A.nodeType==Node.TEXT_NODE?(W=document.createRange(),W.selectNodeContents(A),B=W.getBoundingClientRect()):B=A.getBoundingClientRect(),O=_.horizontal?B.left:B.top,z=_.horizontal?B.right:B.bottom,O>T&&L)?L:z>T?A:void(L=A,R.push(A))}),P)return this.findTextEndRange(P,E,T);return this.findTextEndRange(L,E,T)}},{key:'findTextStartRange',value:function(S,E){var _,R,N,T=this.splitTextNodeIntoRanges(S);for(var L=0;L<T.length;L++)if(_=T[L],R=_.getBoundingClientRect(),N=this.horizontal?R.left:R.top,N>=E)return _;return T[0]}},{key:'findTextEndRange',value:function(S,E,T){var R,N,L,P,A,_=this.splitTextNodeIntoRanges(S);for(var O=0;O<_.length;O++){if(N=_[O],L=N.getBoundingClientRect(),P=this.horizontal?L.left:L.top,A=this.horizontal?L.right:L.bottom,P>T&&R)return R;if(A>T)return N;R=N}return _[_.length-1]}},{key:'splitTextNodeIntoRanges',value:function(S,E){var N,T=[],_=S.textContent||'',R=_.trim(),L=S.ownerDocument,P=E||' ',A=R.indexOf(P);if(-1===A||S.nodeType!=Node.TEXT_NODE)return N=L.createRange(),N.selectNodeContents(S),[N];for(N=L.createRange(),N.setStart(S,0),N.setEnd(S,A),T.push(N),N=!1;-1!=A;)A=R.indexOf(P,A+1),0<A&&(N&&(N.setEnd(S,A),T.push(N)),N=L.createRange(),N.setStart(S,A+1));return N&&(N.setEnd(S,R.length),T.push(N)),T}},{key:'rangePairToCfiPair',value:function(S,E){var T=E.start,_=E.end;T.collapse(!0),_.collapse(!1);var R=new v.default(T,S).toString(),N=new v.default(_,S).toString();return{start:R,end:N}}},{key:'rangeListToCfiList',value:function(S,E){var _,T=[];for(var R=0;R<E.length;R++)_=this.rangePairToCfiPair(S,E[R]),T.push(_);return T}}]),k}();u.default=x,s.exports=u['default']},function(s,u,p){'use strict';Object.defineProperty(u,'__esModule',{value:!0}),u.replaceBase=function(x,k){var C,S;x&&(S=(0,f.qs)(x,'head'),C=(0,f.qs)(S,'base'),!C&&(C=x.createElement('base'),S.insertBefore(C,S.firstChild)),C.setAttribute('href',k.url))},u.replaceCanonical=function(x,k){var C,S,E=k.url;x&&(C=(0,f.qs)(x,'head'),S=(0,f.qs)(C,'link[rel=\'canonical\']'),S?S.setAttribute('href',E):(S=x.createElement('link'),S.setAttribute('rel','canonical'),S.setAttribute('href',E),C.appendChild(S)))},u.replaceLinks=function(x,k){var C=x.querySelectorAll('a[href]'),S=(0,f.qs)(x.ownerDocument,'base'),E=S?S.href:void 0,T=function(R){var N=R.getAttribute('href');if(0!==N.indexOf('mailto:')){var L=-1<N.indexOf('://'),P=new y.default(N,E);L?R.setAttribute('target','_blank'):R.onclick=function(){return P&&P.hash?k(P.Path.path+P.hash):P?k(P.Path.path):k(N),!1}}}.bind(this);for(var _=0;_<C.length;_++)T(C[_])},u.substitute=function(x,k,C){return k.forEach(function(S,E){S&&C[E]&&(x=x.replace(new RegExp(S,'g'),C[E]))}),x};var f=p(17),g=p(22),y=function(x){return x&&x.__esModule?x:{default:x}}(g)},function(s,u,p){'use strict';function f(E){return E&&E.__esModule?E:{default:E}}function g(E,T){if(!(E instanceof T))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var y=function(){function E(T,_){for(var R=0;R<_.length;R++){var N=_[R];N.enumerable=N.enumerable||!1,N.configurable=!0,'value'in N&&(N.writable=!0),Object.defineProperty(T,N.key,N)}}return function(T,_,R){return _&&E(T.prototype,_),R&&E(T,R),T}}(),v=p(23),x=f(v),k=p(24),C=f(k),S=function(){function E(T,_){g(this,E);var R=-1<T.indexOf('://'),N=T;if(this.Url=void 0,this.href=T,this.protocol='',this.origin='',this.hash='',this.hash='',this.search='',this.base=_,!R&&!1!==_&&'string'!=typeof _&&window&&window.location&&(this.base=window.location.href),R||this.base)try{this.Url=this.base?new URL(T,this.base):new URL(T),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,N=this.Url.pathname}catch(L){this.Url=void 0}this.Path=new x.default(N),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}return y(E,[{key:'path',value:function(){return this.Path}},{key:'resolve',value:function(_){var N,R=-1<_.indexOf('://');return R?_:(N=C.default.resolve(this.directory,_),this.origin+N)}},{key:'relative',value:function(_){return C.default.relative(_,this.directory)}},{key:'toString',value:function(){return this.href}}]),E}();u.default=S,s.exports=u['default']},function(s,u,p){'use strict';function f(k,C){if(!(k instanceof C))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var g=function(){function k(C,S){for(var E=0;E<S.length;E++){var T=S[E];T.enumerable=T.enumerable||!1,T.configurable=!0,'value'in T&&(T.writable=!0),Object.defineProperty(C,T.key,T)}}return function(C,S,E){return S&&k(C.prototype,S),E&&k(C,E),C}}(),y=p(24),v=function(C){return C&&C.__esModule?C:{default:C}}(y),x=function(){function k(C){f(this,k);var S,E;S=C.indexOf('://'),-1<S&&(C=new URL(C).pathname),E=this.parse(C),this.path=C,this.directory=this.isDirectory(C)?C:E.dir+'/',this.filename=E.base,this.extension=E.ext.slice(1)}return g(k,[{key:'parse',value:function(S){return v.default.parse(S)}},{key:'isAbsolute',value:function(S){return v.default.isAbsolute(S||this.path)}},{key:'isDirectory',value:function(S){return'/'===S.charAt(S.length-1)}},{key:'resolve',value:function(S){return v.default.resolve(this.directory,S)}},{key:'relative',value:function(S){return v.default.relative(this.directory,S)}},{key:'splitPath',value:function(S){return this.splitPathRe.exec(S).slice(1)}},{key:'toString',value:function(){return this.path}}]),k}();u.default=x,s.exports=u['default']},function(s,u,p){(function(f){'use strict';function g(k){if('string'!=typeof k)throw new TypeError('Path must be a string. Received '+k)}function y(k,C){var S='',E=-1,T=0,_;for(var R=0;R<=k.length;++R){if(R<k.length)_=k.charCodeAt(R);else if(47===_)break;else _=47;if(47===_){if(E==R-1||1==T);else if(E!=R-1&&2==T){if(2>S.length||46!==S.charCodeAt(S.length-1)||46!==S.charCodeAt(S.length-2))if(2<S.length){for(var N=S.length-1,L=N;0<=L&&47!==S.charCodeAt(L);--L);if(L!==N){S=-1===L?'':S.slice(0,L),E=R,T=0;continue}}else if(2===S.length||1===S.length){S='',E=R,T=0;continue}C&&(0<S.length?S+='/..':S='..')}else 0<S.length?S+='/'+k.slice(E+1,R):S=k.slice(E+1,R);E=R,T=0}else 46===_&&-1!=T?++T:T=-1}return S}function v(k,C){var S=C.dir||C.root,E=C.base||(C.name||'')+(C.ext||'');return S?S===C.root?S+E:S+k+E:E}if(!f)var f={cwd:function(){return'/'}};var x={resolve:function(){var E,C='',S=!1;for(var T=arguments.length-1;-1<=T&&!S;T--){var _;(0<=T?_=arguments[T]:(void 0==E&&(E=f.cwd()),_=E),g(_),0!==_.length)&&(C=_+'/'+C,S=47===_.charCodeAt(0))}return(C=y(C,!S),S)?0<C.length?'/'+C:'/':0<C.length?C:'.'},normalize:function(C){if(g(C),0===C.length)return'.';var S=47===C.charCodeAt(0),E=47===C.charCodeAt(C.length-1);return C=y(C,!S),0!==C.length||S||(C='.'),0<C.length&&E&&(C+='/'),S?'/'+C:C},isAbsolute:function(C){return g(C),0<C.length&&47===C.charCodeAt(0)},join:function(){if(0===arguments.length)return'.';var C;for(var S=0;S<arguments.length;++S){var E=arguments[S];g(E),0<E.length&&(C==void 0?C=E:C+='/'+E)}return void 0===C?'.':x.normalize(C)},relative:function(C,S){if(g(C),g(S),C===S)return'';if(C=x.resolve(C),S=x.resolve(S),C===S)return'';for(var E=1;E<C.length&&47===C.charCodeAt(E);++E);for(var T=C.length,_=T-E,R=1;R<S.length&&47===S.charCodeAt(R);++R);for(var N=S.length,L=N-R,P=_<L?_:L,A=-1,O=0;O<=P;++O){if(O===P){if(L>P){if(47===S.charCodeAt(R+O))return S.slice(R+O+1);if(0==O)return S.slice(R+O)}else _>P&&(47===C.charCodeAt(E+O)?A=O:0===O&&(A=0));break}var z=C.charCodeAt(E+O),B=S.charCodeAt(R+O);if(z!==B)break;else 47===z&&(A=O)}var W='';for(O=E+A+1;O<=T;++O)(O===T||47===C.charCodeAt(O))&&(W+=0===W.length?'..':'/..');return 0<W.length?W+S.slice(R+A):(R+=A,47===S.charCodeAt(R)&&++R,S.slice(R))},_makeLong:function(C){return C},dirname:function(C){if(g(C),0===C.length)return'.';var S=C.charCodeAt(0),E=47===S,T=-1,_=!0;for(var R=C.length-1;1<=R;--R)if(S=C.charCodeAt(R),47!==S)_=!1;else if(!_){T=R;break}return-1===T?E?'/':'.':E&&1===T?'//':C.slice(0,T)},basename:function(C,S){if(S!==void 0&&'string'!=typeof S)throw new TypeError('"ext" argument must be a string');g(C);var E=0,T=-1,_=!0,R;if(void 0!==S&&0<S.length&&S.length<=C.length){if(S.length===C.length&&S===C)return'';var N=S.length-1,L=-1;for(R=C.length-1;0<=R;--R){var P=C.charCodeAt(R);if(47!==P)-1==L&&(_=!1,L=R+1),0<=N&&(P===S.charCodeAt(N)?-1==--N&&(T=R):(N=-1,T=L));else if(!_){E=R+1;break}}return E===T?T=L:-1===T&&(T=C.length),C.slice(E,T)}for(R=C.length-1;0<=R;--R)if(47!==C.charCodeAt(R))-1==T&&(_=!1,T=R+1);else if(!_){E=R+1;break}return-1===T?'':C.slice(E,T)},extname:function(C){g(C);var S=-1,E=0,T=-1,_=!0,R=0;for(var N=C.length-1;0<=N;--N){var L=C.charCodeAt(N);if(47===L){if(!_){E=N+1;break}continue}-1==T&&(_=!1,T=N+1),46===L?-1==S?S=N:1!=R&&(R=1):-1!=S&&(R=-1)}return-1===S||-1===T||0==R||1==R&&S===T-1&&S===E+1?'':C.slice(S,T)},format:function(C){if(null===C||'object'!=typeof C)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof C);return v('/',C)},parse:function(C){g(C);var S={root:'',dir:'',base:'',ext:'',name:''};if(0===C.length)return S;var _,E=C.charCodeAt(0),T=47===E;T?(S.root='/',_=1):_=0;for(var R=-1,N=0,L=-1,P=!0,A=C.length-1,O=0;A>=_;--A){if(E=C.charCodeAt(A),47===E){if(!P){N=A+1;break}continue}-1==L&&(P=!1,L=A+1),46===E?-1==R?R=A:1!=O&&(O=1):-1!=R&&(O=-1)}return-1==R||-1==L||0==O||1==O&&R==L-1&&R==N+1?-1!=L&&(0==N&&T?S.base=S.name=C.slice(1,L):S.base=S.name=C.slice(N,L)):(0==N&&T?(S.name=C.slice(1,R),S.base=C.slice(1,L)):(S.name=C.slice(N,R),S.base=C.slice(N,L)),S.ext=C.slice(R,L)),0<N?S.dir=C.slice(0,N-1):T&&(S.dir='/'),S},sep:'/',delimiter:':',posix:null};s.exports=x}).call(u,p(25))},function(s){function u(){throw new Error('setTimeout has not been defined')}function p(){throw new Error('clearTimeout has not been defined')}function f(L){if(S===setTimeout)return setTimeout(L,0);if((S===u||!S)&&setTimeout)return S=setTimeout,setTimeout(L,0);try{return S(L,0)}catch(P){try{return S.call(null,L,0)}catch(A){return S.call(this,L,0)}}}function g(L){if(E===clearTimeout)return clearTimeout(L);if((E===p||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(L);try{return E(L)}catch(P){try{return E.call(null,L)}catch(A){return E.call(this,L)}}}function y(){_&&R&&(_=!1,R.length?T=R.concat(T):N=-1,T.length&&v())}function v(){if(!_){var L=f(y);_=!0;for(var P=T.length;P;){for(R=T,T=[];++N<P;)R&&R[N].run();N=-1,P=T.length}R=null,_=!1,g(L)}}function x(L,P){this.fun=L,this.array=P}function k(){}var C=s.exports={},S,E;(function(){try{S='function'==typeof setTimeout?setTimeout:u}catch(L){S=u}try{E='function'==typeof clearTimeout?clearTimeout:p}catch(L){E=p}})();var T=[],_=!1,R,N=-1;C.nextTick=function(L){var P=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)P[A-1]=arguments[A];T.push(new x(L,P)),1!==T.length||_||f(v)},x.prototype.run=function(){this.fun.apply(null,this.array)},C.title='browser',C.browser=!0,C.env={},C.argv=[],C.version='',C.versions={},C.on=k,C.addListener=k,C.once=k,C.off=k,C.removeListener=k,C.removeAllListeners=k,C.emit=k,C.binding=function(){throw new Error('process.binding is not supported')},C.cwd=function(){return'/'},C.chdir=function(){throw new Error('process.chdir is not supported')},C.umask=function(){return 0}}])});