(function(s,u){'object'==typeof exports&&'object'==typeof module?module.exports=u(require('xmldom')):'function'==typeof define&&define.amd?define(['xmldom'],u):'object'==typeof exports?exports.EPUBJSContents=u(require('xmldom')):s.EPUBJSContents=u(s.xmldom)})(this,function(t){return function(s){function u(f){if(p[f])return p[f].exports;var g=p[f]={exports:{},id:f,loaded:!1};return s[f].call(g.exports,g,g.exports,u),g.loaded=!0,g.exports}var p={};return u.m=s,u.c=p,u.p='',u(0)}([function(s,u,p){var f=p(1);s.exports=f},function(s,u,p){'use strict';function f(L){return L&&L.__esModule?L:{default:L}}function g(L,P){if(!(L instanceof P))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var y=function(){function L(P,A){for(var O=0;O<A.length;O++){var B=A[O];B.enumerable=B.enumerable||!1,B.configurable=!0,'value'in B&&(B.writable=!0),Object.defineProperty(P,B.key,B)}}return function(P,A,O){return A&&L(P.prototype,A),O&&L(P,O),P}}(),x=p(2),v=f(x),k=p(17),C=p(19),E=f(C),S=p(20),T=f(S),_=p(21),N=['keydown','keyup','keypressed','mouseup','mousedown','click','touchend','touchstart'],R=function(){function L(P,A,O){g(this,L),this.epubcfi=new E.default,this.document=P,this.documentElement=this.document.documentElement,this.content=A||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.cfiBase=O||'',this.listeners()}return y(L,[{key:'width',value:function(A){var O=this.content;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.width=A),this.window.getComputedStyle(O).width}},{key:'height',value:function(A){var O=this.content;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.height=A),this.window.getComputedStyle(O).height}},{key:'contentWidth',value:function(A){var O=this.content||this.document.body;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.width=A),this.window.getComputedStyle(O).width}},{key:'contentHeight',value:function(A){var O=this.content||this.document.body;return A&&(0,k.isNumber)(A)&&(A=A+'px'),A&&(O.style.height=A),this.window.getComputedStyle(O).height}},{key:'textWidth',value:function(){var A,O=this.document.createRange(),B=this.content||this.document.body;return O.selectNodeContents(B),A=O.getBoundingClientRect().width,A}},{key:'textHeight',value:function(){var A,O=this.document.createRange(),B=this.content||this.document.body;return O.selectNodeContents(B),A=O.getBoundingClientRect().height,A}},{key:'scrollWidth',value:function(){var A=this.documentElement.scrollWidth;return A}},{key:'scrollHeight',value:function(){var A=this.documentElement.scrollHeight;return A}},{key:'overflow',value:function(A){return A&&(this.documentElement.style.overflow=A),this.window.getComputedStyle(this.documentElement).overflow}},{key:'overflowX',value:function(A){return A&&(this.documentElement.style.overflowX=A),this.window.getComputedStyle(this.documentElement).overflowX}},{key:'overflowY',value:function(A){return A&&(this.documentElement.style.overflowY=A),this.window.getComputedStyle(this.documentElement).overflowY}},{key:'css',value:function(A,O,B){var z=this.content||this.document.body;return O&&z.style.setProperty(A,O,B?'important':''),this.window.getComputedStyle(z)[A]}},{key:'viewport',value:function(A){var O,B,z,W,M=this.document.querySelector('meta[name=\'viewport\']'),U='';if(M&&M.hasAttribute('content')){var I=M.getAttribute('content'),D=I.split(/\s*,\s*/);D[0]&&(O=D[0].replace('width=','').trim()),D[1]&&(B=D[1].replace('height=','').trim()),D[2]&&(z=D[2].replace('initial-scale=','').trim()),D[3]&&(W=D[3].replace('user-scalable=','').trim())}return A&&(U+='width='+(A.width||O),U+=', height='+(A.height||B),(A.scale||z)&&(U+=', initial-scale='+(A.scale||z)),(A.scalable||W)&&(U+=', user-scalable='+(A.scalable||W)),!M&&(M=this.document.createElement('meta'),M.setAttribute('name','viewport'),this.document.querySelector('head').appendChild(M)),M.setAttribute('content',U)),{width:parseInt(O),height:parseInt(B)}}},{key:'expand',value:function(){this.emit('expand')}},{key:'listeners',value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),this.resizeListeners(),this.linksHandler()}},{key:'removeListeners',value:function(){this.removeEventListeners(),this.removeSelectionListeners()}},{key:'resizeListeners',value:function(){var A,O;clearTimeout(this.expanding),A=this.scrollWidth(),O=this.scrollHeight(),(A!=this._size.width||O!=this._size.height)&&(this._size={width:A,height:O},this.emit('resize',this._size)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:'mediaQueryListeners',value:function(){var A=this.document.styleSheets,O=function(U){U.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this);for(var B=0;B<A.length;B+=1){var z;try{z=A[B].cssRules}catch(U){return}if(!z)return;for(var W=0;W<z.length;W+=1)if(z[W].media){var M=this.window.matchMedia(z[W].media.mediaText);M.addListener(O)}}}},{key:'observe',value:function(A){var O=this,B=new MutationObserver(function(){O._expanding&&O.expand()});return B.observe(A,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),B}},{key:'imageLoadListeners',value:function(){var O,A=this.document.querySelectorAll('img');for(var B=0;B<A.length;B++)O=A[B],'undefined'!=typeof O.naturalWidth&&0===O.naturalWidth&&(O.onload=this.expand.bind(this))}},{key:'fontLoadListeners',value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.expand()}.bind(this))}},{key:'root',value:function(){return this.document?this.document.documentElement:null}},{key:'locationOf',value:function(A,O){var B,z={left:0,top:0};if(this.document){if(this.epubcfi.isCfiString(A)){var W=new E.default(A).toRange(this.document,O);W&&(W.startContainer.nodeType===Node.ELEMENT_NODE?(B=W.startContainer.getBoundingClientRect(),z.left=B.left,z.top=B.top):W.collapsed?B=W.getClientRects()[0]:B=W.getBoundingClientRect())}else if('string'==typeof A&&-1<A.indexOf('#')){var M=A.substring(A.indexOf('#')+1),U=this.document.getElementById(M);U&&(B=U.getBoundingClientRect())}return B&&(z.left=B.left,z.top=B.top),z}}},{key:'addStylesheet',value:function(A){return new Promise(function(O){var B,z=!1;return this.document?(B=this.document.querySelector('link[href=\''+A+'\']'),B?void O(!0):void(B=this.document.createElement('link'),B.type='text/css',B.rel='stylesheet',B.href=A,B.onload=B.onreadystatechange=function(){z||this.readyState&&'complete'!=this.readyState||(z=!0,setTimeout(function(){O(!0)},1))},this.document.head.appendChild(B))):void O(!1)}.bind(this))}},{key:'addStylesheetRules',value:function(A){var O,B,z='epubjs-inserted-css';if(this.document&&A&&0!==A.length)if(O=this.document.getElementById('#'+z),O||(O=this.document.createElement('style'),O.id=z),this.document.head.appendChild(O),B=O.sheet,'[object Array]'===Object.prototype.toString.call(A))for(var W=0,M=A.length;W<M;W++){var U=1,I=A[W],D=A[W][0],H='';'[object Array]'===Object.prototype.toString.call(I[1][0])&&(I=I[1],U=0);for(var F=I.length;U<F;U++){var X=I[U];H+=X[0]+':'+X[1]+(X[2]?' !important':'')+';\n'}B.insertRule(D+'{'+H+'}',B.cssRules.length)}else{var Y=Object.keys(A);Y.forEach(function(Z){var $=A[Z],ee=Object.keys($),te=ee.map(function(ne){return ne+':'+$[ne]}).join(';');B.insertRule(Z+'{'+te+'}',B.cssRules.length)})}}},{key:'addScript',value:function(A){return new Promise(function(O){var B,z=!1;return this.document?void(B=this.document.createElement('script'),B.type='text/javascript',B.async=!0,B.src=A,B.onload=B.onreadystatechange=function(){z||this.readyState&&'complete'!=this.readyState||(z=!0,setTimeout(function(){O(!0)},1))},this.document.head.appendChild(B)):void O(!1)}.bind(this))}},{key:'addClass',value:function(A){var O;this.document&&(O=this.content||this.document.body,O.classList.add(A))}},{key:'removeClass',value:function(A){var O;this.document&&(O=this.content||this.document.body,O.classList.remove(A))}},{key:'addEventListeners',value:function(){this.document&&N.forEach(function(A){this.document.addEventListener(A,this.triggerEvent.bind(this),!1)},this)}},{key:'removeEventListeners',value:function(){this.document&&N.forEach(function(A){this.document.removeEventListener(A,this.triggerEvent,!1)},this)}},{key:'triggerEvent',value:function(A){this.emit(A.type,A)}},{key:'addSelectionListeners',value:function(){this.document&&this.document.addEventListener('selectionchange',this.onSelectionChange.bind(this),!1)}},{key:'removeSelectionListeners',value:function(){this.document&&this.document.removeEventListener('selectionchange',this.onSelectionChange,!1)}},{key:'onSelectionChange',value:function(){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var A=this.window.getSelection();this.triggerSelectedEvent(A)}.bind(this),500)}},{key:'triggerSelectedEvent',value:function(A){var O,B;A&&0<A.rangeCount&&(O=A.getRangeAt(0),!O.collapsed&&(B=new E.default(O,this.cfiBase).toString(),this.emit('selected',B),this.emit('selectedRange',O)))}},{key:'range',value:function(A,O){var B=new E.default(A);return B.toRange(this.document,O)}},{key:'map',value:function(A){var P=new T.default(A);return P.section()}},{key:'size',value:function(A,O){0<=A&&this.width(A),0<=O&&this.height(O),this.css('margin','0'),this.css('box-sizing','border-box')}},{key:'columns',value:function(A,O,B,z){var W=(0,k.prefixed)('column-axis'),M=(0,k.prefixed)('column-gap'),U=(0,k.prefixed)('column-width'),I=(0,k.prefixed)('column-fill');this.width(A),this.height(O),this.viewport({width:A,height:O,scale:1}),this.css('overflow-y','hidden'),this.css('margin','0',!0),this.css('padding','0',!0),this.css('box-sizing','border-box'),this.css('max-width','inherit'),this.css(W,'horizontal'),this.css(I,'auto'),this.css(M,z+'px'),this.css(U,B+'px')}},{key:'scaler',value:function(A,O,B){var z='';this.css('transform-origin','top left'),(0<=O||0<=B)&&(z=' translate('+(O||0)+'px, '+(B||0)+'px )'),this.css('transform','scale('+A+')'+z)}},{key:'fit',value:function(A,O){var B=this.viewport(),z=A/B.width,W=O/B.height,M=z<W?z:W,U=(O-B.height*M)/2;this.width(A),this.height(O),this.overflow('hidden'),this.viewport({scale:1}),this.scaler(M,0,U),this.css('background-color','transparent')}},{key:'mapPage',value:function(A,O,B){var z=new T.default;return z.page(this,A,O,B)}},{key:'linksHandler',value:function(){var A=this;(0,_.replaceLinks)(this.content,function(O){A.emit('link',O)})}},{key:'destroy',value:function(){this.observer&&this.observer.disconnect(),this.removeListeners()}}],[{key:'listenedEvents',get:function(){return N}}]),L}();(0,v.default)(R.prototype),u.default=R,s.exports=u['default']},function(s,u,p){'use strict';var T,_,N,R,L,P,A,f=p(3),g=p(16),y=Function.prototype.apply,x=Function.prototype.call,v=Object.create,k=Object.defineProperty,C=Object.defineProperties,E=Object.prototype.hasOwnProperty,S={configurable:!0,enumerable:!1,writable:!0};T=function(O,B){var z;return g(B),E.call(this,'__ee__')?z=this.__ee__:(z=S.value=v(null),k(this,'__ee__',S),S.value=null),z[O]?'object'==typeof z[O]?z[O].push(B):z[O]=[z[O],B]:z[O]=B,this},_=function(O,B){var z,W;return g(B),W=this,T.call(this,O,z=function(){N.call(W,O,z),y.call(B,this,arguments)}),z.__eeOnceListener__=B,this},N=function(O,B){var z,W,M,U;if(g(B),!E.call(this,'__ee__'))return this;if(z=this.__ee__,!z[O])return this;if(W=z[O],'object'==typeof W)for(U=0;M=W[U];++U)(M===B||M.__eeOnceListener__===B)&&(2===W.length?z[O]=W[U?0:1]:W.splice(U,1));else(W===B||W.__eeOnceListener__===B)&&delete z[O];return this},R=function(O){var B,z,W,M,U;if(E.call(this,'__ee__')&&(M=this.__ee__[O],M))if('object'==typeof M){for(z=arguments.length,U=Array(z-1),B=1;B<z;++B)U[B-1]=arguments[B];for(M=M.slice(),B=0;W=M[B];++B)y.call(W,this,U)}else switch(arguments.length){case 1:x.call(M,this);break;case 2:x.call(M,this,arguments[1]);break;case 3:x.call(M,this,arguments[1],arguments[2]);break;default:for(z=arguments.length,U=Array(z-1),B=1;B<z;++B)U[B-1]=arguments[B];y.call(M,this,U);}},L={on:T,once:_,off:N,emit:R},P={on:f(T),once:f(_),off:f(N),emit:f(R)},A=C({},P),s.exports=u=function(O){return null==O?v(A):C(Object(O),P)},u.methods=L},function(s,u,p){'use strict';var v,f=p(4),g=p(11),y=p(12),x=p(13);v=s.exports=function(k,C){var E,S,T,_,N;return 2>arguments.length||'string'!=typeof k?(_=C,C=k,k=null):_=arguments[2],null==k?(E=T=!0,S=!1):(E=x.call(k,'c'),S=x.call(k,'e'),T=x.call(k,'w')),N={value:C,configurable:E,enumerable:S,writable:T},_?f(g(_),N):N},v.gs=function(k,C,E){var S,T,_,N;return'string'==typeof k?_=arguments[3]:(_=E,E=C,C=k,k=null),null==C?C=void 0:y(C)?null==E?E=void 0:!y(E)&&(_=E,E=void 0):(_=C,C=E=void 0),null==k?(S=!0,T=!1):(S=x.call(k,'c'),T=x.call(k,'e')),N={get:C,set:E,configurable:S,enumerable:T},_?f(g(_),N):N}},function(s,u,p){'use strict';s.exports=p(5)()?Object.assign:p(6)},function(s){'use strict';s.exports=function(){var p,u=Object.assign;return!('function'!=typeof u)&&(p={foo:'raz'},u(p,{bar:'dwa'},{trzy:'trzy'}),'razdwatrzy'===p.foo+p.bar+p.trzy)}},function(s,u,p){'use strict';var f=p(7),g=p(10),y=Math.max;s.exports=function(x,v){var k,C,S,E=y(arguments.length,2);for(x=Object(g(x)),S=function(T){try{x[T]=v[T]}catch(_){k||(k=_)}},C=1;C<E;++C)v=arguments[C],f(v).forEach(S);if(k!==void 0)throw k;return x}},function(s,u,p){'use strict';s.exports=p(8)()?Object.keys:p(9)},function(s){'use strict';s.exports=function(){try{return Object.keys('primitive'),!0}catch(u){return!1}}},function(s){'use strict';var u=Object.keys;s.exports=function(p){return u(null==p?p:Object(p))}},function(s){'use strict';s.exports=function(u){if(null==u)throw new TypeError('Cannot use null or undefined');return u}},function(s){'use strict';var u=Array.prototype.forEach,p=Object.create,f=function(g,y){for(var x in g)y[x]=g[x]};s.exports=function(){var g=p(null);return u.call(arguments,function(y){null==y||f(Object(y),g)}),g}},function(s){'use strict';s.exports=function(u){return'function'==typeof u}},function(s,u,p){'use strict';s.exports=p(14)()?String.prototype.contains:p(15)},function(s){'use strict';var u='razdwatrzy';s.exports=function(){return!('function'!=typeof u.contains)&&!0===u.contains('dwa')&&!1===u.contains('foo')}},function(s){'use strict';var u=String.prototype.indexOf;s.exports=function(p){return-1<u.call(this,p,arguments[1])}},function(s){'use strict';s.exports=function(u){if('function'!=typeof u)throw new TypeError(u+' is not a function');return u}},function(s,u,p){'use strict';function f(){var E=new Date().getTime(),S='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(T){var _=0|(E+16*Math.random())%16;return E=Math.floor(E/16),('x'==T?_:8|7&_).toString(16)});return S}function g(E){return!isNaN(parseFloat(E))&&isFinite(E)}function y(E,S,T,_,N){var A,R=_||0,L=N||S.length,P=parseInt(R+(L-R)/2);return(T||(T=function(B,z){return B>z?1:B<z?-1:B==z?0:void 0}),0>=L-R)?P:(A=T(S[P],E),1==L-R?0<A?P:P+1:0===A?P:-1===A?y(E,S,T,P,L):y(E,S,T,R,P))}function x(E,S,T,_,N){var A,R=_||0,L=N||S.length,P=parseInt(R+(L-R)/2);return(T||(T=function(B,z){return B>z?1:B<z?-1:B==z?0:void 0}),0>=L-R)?-1:(A=T(S[P],E),1==L-R?0===A?P:-1:0===A?P:-1===A?x(E,S,T,P,L):x(E,S,T,R,P))}function v(E,S){return'undefined'==typeof E.querySelector?E.getElementsByTagName(S):E.querySelectorAll(S)}function k(E,S,T){for(var _=document.createTreeWalker(E,T,null,!1),N=void 0;N=_.nextNode();)S(N)}function C(E,S){if(S(E))return!0;if(E=E.firstChild,E)do{var T=C(E,S);if(T)return!0;E=E.nextSibling}while(E)}Object.defineProperty(u,'__esModule',{value:!0}),u.isElement=function(S){return!!(S&&1==S.nodeType)},u.uuid=f,u.documentHeight=function(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},u.isNumber=g,u.isFloat=function(S){return g(S)&&Math.floor(S)!==S},u.prefixed=function(S){var T=['-Webkit-','-moz-','-o-','-ms-'],_=S[0].toUpperCase()+S.slice(1),N=T.length;if('undefined'==typeof document||'undefined'!=typeof document.body.style[S])return S;for(var R=0;R<N;R++)if('undefined'!=typeof document.body.style[T[R]+_])return T[R]+_;return S},u.defaults=function(S){for(var T=1,_=arguments.length;T<_;T++){var N=arguments[T];for(var R in N)void 0===S[R]&&(S[R]=N[R])}return S},u.extend=function(S){var T=[].slice.call(arguments,1);return T.forEach(function(_){_&&Object.getOwnPropertyNames(_).forEach(function(N){Object.defineProperty(S,N,Object.getOwnPropertyDescriptor(_,N))})}),S},u.insert=function(S,T,_){var N=y(S,T,_);return T.splice(N,0,S),N},u.locationOf=y,u.indexOfSorted=x,u.bounds=function(S){var T=window.getComputedStyle(S),_=0,N=0;return['width','paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(R){_+=parseFloat(T[R])||0}),['height','paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(R){N+=parseFloat(T[R])||0}),{height:N,width:_}},u.borders=function(S){var T=window.getComputedStyle(S),_=0,N=0;return['paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(R){_+=parseFloat(T[R])||0}),['paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(R){N+=parseFloat(T[R])||0}),{height:N,width:_}},u.windowBounds=function(){var S=window.innerWidth,T=window.innerHeight;return{top:0,left:0,right:S,bottom:T,width:S,height:T}},u.cleanStringForXpath=function(S){var T=S.match(/[^'"]+|['"]/g);return T=T.map(function(_){return'\''===_?'"\'"':'"'===_?'\'"\'':'\''+_+'\''}),'concat(\'\','+T.join(',')+')'},u.indexOfTextNode=function(S){var T=S.parentNode,_=T.childNodes,N,R=-1;for(var L=0;L<_.length&&(N=_[L],N.nodeType===Node.TEXT_NODE&&R++,N!=S);L++);return R},u.isXml=function(S){return-1<['xml','opf','ncx'].indexOf(S)},u.createBlob=function(S,T){return new Blob([S],{type:T})},u.createBlobUrl=function(S,T){var N,_=window.URL||window.webkitURL||window.mozURL,R=this.createBlob(S,T);return N=_.createObjectURL(R),N},u.createBase64Url=function(S,T){var _,N;if('string'==typeof S)return _=btoa(S),N='data:'+T+';base64,'+_,N},u.type=function(S){return Object.prototype.toString.call(S).slice(8,-1)},u.parse=function(S,T,_){var N,R;return R='undefined'==typeof DOMParser||_?p(18).DOMParser:DOMParser,N=new R().parseFromString(S,T),N},u.qs=function(S,T){var _;if(!S)throw new Error('No Element Provided');return'undefined'==typeof S.querySelector?(_=S.getElementsByTagName(T),_.length)?_[0]:void 0:S.querySelector(T)},u.qsa=v,u.qsp=function(S,T,_){var N,R;if('undefined'!=typeof S.querySelector){for(var L in T+='[',_)T+=L+'=\''+_[L]+'\'';return T+=']',S.querySelector(T)}return(N=S.getElementsByTagName(T),R=Array.prototype.slice.call(N,0).filter(function(P){for(var A in _)if(P.getAttribute(A)===_[A])return!0;return!1}),R)?R[0]:void 0},u.sprint=function(S,T){var _=S.ownerDocument||S;'undefined'==typeof _.createTreeWalker?C(S,function(N){N&&3===N.nodeType&&T(N)},!0):k(S,T,NodeFilter.SHOW_TEXT)},u.treeWalker=k,u.walk=C,u.blob2base64=function(S){return new Promise(function(T){var _=new FileReader;_.readAsDataURL(S),_.onloadend=function(){T(_.result)}})},u.defer=function(){var S=this;this.resolve=null,this.reject=null,this.id=f(),this.promise=new Promise(function(T,_){S.resolve=T,S.reject=_}),Object.freeze(this)},u.querySelectorByType=function(S,T,_){var N;if('undefined'!=typeof S.querySelector&&(N=S.querySelector(T+'[*|type="'+_+'"]')),!N||0===N.length){N=v(S,T);for(var R=0;R<N.length;R++)if(N[R].getAttributeNS('http://www.idpf.org/2007/ops','type')===_)return N[R]}else return N},u.findChildren=function(S){var T=[],_=S.parentNode.childNodes;for(var N=0;N<_.length;N++){var R=_[N];1===R.nodeType&&T.push(R)}return T},u.requestAnimationFrame='undefined'!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)},function(s){s.exports=t},function(s,u,p){'use strict';function f(E,S){if(!(E instanceof S))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var g='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(E){return typeof E}:function(E){return E&&'function'==typeof Symbol&&E.constructor===Symbol&&E!==Symbol.prototype?'symbol':typeof E},y=function(){function E(S,T){for(var _=0;_<T.length;_++){var N=T[_];N.enumerable=N.enumerable||!1,N.configurable=!0,'value'in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}return function(S,T,_){return T&&E(S.prototype,T),_&&E(S,_),S}}(),x=p(17),v=1,k=3,C=function(){function E(S,T,_){f(this,E);var N;if(this.str='',this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof E))return new E(S,T,_);if('string'==typeof T?this.base=this.parseComponent(T):'object'===('undefined'==typeof T?'undefined':g(T))&&T.steps&&(this.base=T),N=this.checkType(S),'string'===N)return this.str=S,(0,x.extend)(this,this.parse(S));if('range'===N)return(0,x.extend)(this,this.fromRange(S,this.base,_));if('node'===N)return(0,x.extend)(this,this.fromNode(S,this.base,_));if('EpubCFI'===N&&S.path)return S;if(!S)return this;throw new TypeError('not a valid argument for EpubCFI')}return y(E,[{key:'checkType',value:function(T){return this.isCfiString(T)?'string':'object'===('undefined'==typeof T?'undefined':g(T))&&('Range'===(0,x.type)(T)||'undefined'!=typeof T.startContainer)?'range':'object'===('undefined'==typeof T?'undefined':g(T))&&'undefined'!=typeof T.nodeType?'node':'object'===('undefined'==typeof T?'undefined':g(T))&&T instanceof E&&'EpubCFI'}},{key:'parse',value:function(T){var N,R,L,_={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return'string'==typeof T?(0===T.indexOf('epubcfi(')&&')'===T[T.length-1]&&(T=T.slice(8,T.length-1)),N=this.getChapterComponent(T),!N)?{spinePos:-1}:(_.base=this.parseComponent(N),R=this.getPathComponent(T),_.path=this.parseComponent(R),L=this.getRange(T),L&&(_.range=!0,_.start=this.parseComponent(L[0]),_.end=this.parseComponent(L[1])),_.spinePos=_.base.steps[1].index,_):{spinePos:-1}}},{key:'parseComponent',value:function(T){var L,_={steps:[],terminal:{offset:null,assertion:null}},N=T.split(':'),R=N[0].split('/');return 1<N.length&&(L=N[1],_.terminal=this.parseTerminal(L)),''===R[0]&&R.shift(),_.steps=R.map(function(P){return this.parseStep(P)}.bind(this)),_}},{key:'parseStep',value:function(T){var _,N,R,L,P;if(L=T.match(/\[(.*)\]/),L&&L[1]&&(P=L[1]),N=parseInt(T),!isNaN(N))return 0==N%2?(_='element',R=N/2-1):(_='text',R=(N-1)/2),{type:_,index:R,id:P||null}}},{key:'parseTerminal',value:function(T){var _,N,R=T.match(/\[(.*)\]/);return R&&R[1]?(_=parseInt(T.split('[')[0])||null,N=R[1]):_=parseInt(T)||null,{offset:_,assertion:N}}},{key:'getChapterComponent',value:function(T){var _=T.split('!');return _[0]}},{key:'getPathComponent',value:function(T){var _=T.split('!');if(_[1]){var N=_[1].split(',');return N[0]}}},{key:'getRange',value:function(T){var _=T.split(',');return 3===_.length&&[_[1],_[2]]}},{key:'getCharecterOffsetComponent',value:function(T){var _=T.split(':');return _[1]||''}},{key:'joinSteps',value:function(T){return T?T.map(function(_){var N='';return'element'===_.type&&(N+=2*(_.index+1)),'text'===_.type&&(N+=1+2*_.index),_.id&&(N+='['+_.id+']'),N}).join('/'):''}},{key:'segmentString',value:function(T){var S='/';return S+=this.joinSteps(T.steps),T.terminal&&null!=T.terminal.offset&&(S+=':'+T.terminal.offset),T.terminal&&null!=T.terminal.assertion&&(S+='['+T.terminal.assertion+']'),S}},{key:'toString',value:function(){var T='epubcfi(';return T+=this.segmentString(this.base),T+='!',T+=this.segmentString(this.path),this.start&&(T+=',',T+=this.segmentString(this.start)),this.end&&(T+=',',T+=this.segmentString(this.end)),T+=')',T}},{key:'compare',value:function(T,_){var N,R,L,P;if('string'==typeof T&&(T=new E(T)),'string'==typeof _&&(_=new E(_)),T.spinePos>_.spinePos)return 1;if(T.spinePos<_.spinePos)return-1;T.range?(N=T.path.steps.concat(T.start.steps),L=T.start.terminal):(N=T.path.steps,L=T.path.terminal),_.range?(R=_.path.steps.concat(_.start.steps),P=_.start.terminal):(R=_.path.steps,P=_.path.terminal);for(var A=0;A<N.length;A++){if(!N[A])return-1;if(!R[A])return 1;if(N[A].index>R[A].index)return 1;if(N[A].index<R[A].index)return-1}return N.length<R.length?1:L.offset>P.offset?1:L.offset<P.offset?-1:0}},{key:'step',value:function(T){var _=T.nodeType===k?'text':'element';return{id:T.id,tagName:T.tagName,type:_,index:this.position(T)}}},{key:'filteredStep',value:function(T,_){var R,N=this.filter(T,_);if(N)return R=N.nodeType===k?'text':'element',{id:N.id,tagName:N.tagName,type:R,index:this.filteredPosition(N,_)}}},{key:'pathTo',value:function(T,_,N){for(var P,R={steps:[],terminal:{offset:null,assertion:null}},L=T;L&&L.parentNode&&9!=L.parentNode.nodeType;)P=N?this.filteredStep(L,N):this.step(L),P&&R.steps.unshift(P),L=L.parentNode;return null!=_&&0<=_&&(R.terminal.offset=_,'text'!=R.steps[R.steps.length-1].type&&R.steps.push({type:'text',index:0})),R}},{key:'equalStep',value:function(T,_){return T&&_&&T.index===_.index&&T.id===_.id&&T.type===_.type}},{key:'fromRange',value:function(T,_,N){var R={range:!1,base:{},path:{},start:null,end:null},L=T.startContainer,P=T.endContainer,A=T.startOffset,O=T.endOffset,B=!1;if(N&&(B=null!=L.ownerDocument.querySelector('.'+N)),'string'==typeof _?(R.base=this.parseComponent(_),R.spinePos=R.base.steps[1].index):'object'===('undefined'==typeof _?'undefined':g(_))&&(R.base=_),T.collapsed)B&&(A=this.patchOffset(L,A,N)),R.path=this.pathTo(L,A,N);else{R.range=!0,B&&(A=this.patchOffset(L,A,N)),R.start=this.pathTo(L,A,N),B&&(O=this.patchOffset(P,O,N)),R.end=this.pathTo(P,O,N),R.path={steps:[],terminal:null};var W,z=R.start.steps.length;for(W=0;W<z&&this.equalStep(R.start.steps[W],R.end.steps[W]);W++)W===z-1?R.start.terminal===R.end.terminal&&(R.path.steps.push(R.start.steps[W]),R.range=!1):R.path.steps.push(R.start.steps[W]);R.start.steps=R.start.steps.slice(R.path.steps.length),R.end.steps=R.end.steps.slice(R.path.steps.length)}return R}},{key:'fromNode',value:function(T,_,N){var R={range:!1,base:{},path:{},start:null,end:null};return'string'==typeof _?(R.base=this.parseComponent(_),R.spinePos=R.base.steps[1].index):'object'===('undefined'==typeof _?'undefined':g(_))&&(R.base=_),R.path=this.pathTo(T,null,N),R}},{key:'filter',value:function(T,_){var N,R,L,P,A,O=!1;return(T.nodeType===k?(O=!0,L=T.parentNode,N=T.parentNode.classList.contains(_)):(O=!1,N=T.classList.contains(_)),N&&O)?(P=L.previousSibling,A=L.nextSibling,P&&P.nodeType===k?R=P:A&&A.nodeType===k&&(R=A),R)?R:T:N&&!O?!1:T}},{key:'patchOffset',value:function(T,_,N){if(T.nodeType!=k)throw new Error('Anchor must be a text node');var R=T,L=_;for(T.parentNode.classList.contains(N)&&(R=T.parentNode);R.previousSibling;){if(R.previousSibling.nodeType!==v)L+=R.previousSibling.textContent.length;else if(R.previousSibling.classList.contains(N))L+=R.previousSibling.textContent.length;else break;R=R.previousSibling}return L}},{key:'normalizedMap',value:function(T,_,N){var P,O,B,R={},L=-1,A=T.length;for(P=0;P<A;P++)O=T[P].nodeType,O===v&&T[P].classList.contains(N)&&(O=k),0<P&&O===k&&B===k?R[P]=L:_===O&&(L=L+1,R[P]=L),B=O;return R}},{key:'position',value:function(T){var _,N;return T.nodeType===v?(_=T.parentNode.children,!_&&(_=(0,x.findChildren)(T.parentNode)),N=Array.prototype.indexOf.call(_,T)):(_=this.textNodes(T.parentNode),N=_.indexOf(T)),N}},{key:'filteredPosition',value:function(T,_){var N,R,L;return T.nodeType===v?(N=T.parentNode.children,L=this.normalizedMap(N,v,_)):(N=T.parentNode.childNodes,T.parentNode.classList.contains(_)&&(T=T.parentNode,N=T.parentNode.childNodes),L=this.normalizedMap(N,k,_)),R=Array.prototype.indexOf.call(N,T),L[R]}},{key:'stepsToXpath',value:function(T){var _=['.','*'];return T.forEach(function(N){var R=N.index+1;N.id?_.push('*[position()='+R+' and @id=\''+N.id+'\']'):'text'===N.type?_.push('text()['+R+']'):_.push('*['+R+']')}),_.join('/')}},{key:'stepsToQuerySelector',value:function(T){var _=['html'];return T.forEach(function(N){var R=N.index+1;N.id?_.push('#'+N.id):'text'!==N.type&&_.push('*:nth-child('+R+')')}),_.join('>')}},{key:'textNodes',value:function(T,_){return Array.prototype.slice.call(T.childNodes).filter(function(N){return N.nodeType===k||_&&N.classList.contains(_)})}},{key:'walkToNode',value:function(T,_,N){var P,O,R=_||document,L=R.documentElement,A=T.length;for(O=0;O<A&&(P=T[O],'element'===P.type?P.id?L=R.getElementById(P.id):L=L.children[P.index]:'text'===P.type&&(L=this.textNodes(L,N)[P.index]),!!L);O++);return L}},{key:'findNode',value:function(T,_,N){var L,P,R=_||document;return N||'undefined'==typeof R.evaluate?N?L=this.walkToNode(T,R,N):L=this.walkToNode(T,R):(P=this.stepsToXpath(T),L=R.evaluate(P,R,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),L}},{key:'fixMiss',value:function(T,_,N,R){var O,B,L=this.findNode(T.slice(0,-1),N,R),P=L.childNodes,A=this.normalizedMap(P,k,R),z=T[T.length-1].index;for(var W in A){if(!A.hasOwnProperty(W))return;if(A[W]===z)if(O=P[W],B=O.textContent.length,_>B)_=_-B;else{L=O.nodeType===v?O.childNodes[0]:O;break}}return{container:L,offset:_}}},{key:'toRange',value:function(T,_){var L,P,A,O,z,W,U,N=T||document,R=N.createRange(),B=this,M=!!_&&null!=N.querySelector('.'+_);if(B.range?(L=B.start,z=B.path.steps.concat(L.steps),A=this.findNode(z,N,M?_:null),P=B.end,W=B.path.steps.concat(P.steps),O=this.findNode(W,N,M?_:null)):(L=B.path,z=B.path.steps,A=this.findNode(B.path.steps,N,M?_:null)),A)try{null==L.terminal.offset?R.setStart(A,0):R.setStart(A,L.terminal.offset)}catch(I){U=this.fixMiss(z,L.terminal.offset,N,M?_:null),R.setStart(U.container,U.offset)}else return null;if(O)try{null==P.terminal.offset?R.setEnd(O,0):R.setEnd(O,P.terminal.offset)}catch(I){U=this.fixMiss(W,B.end.terminal.offset,N,M?_:null),R.setEnd(U.container,U.offset)}return R}},{key:'isCfiString',value:function(T){return'string'==typeof T&&0===T.indexOf('epubcfi(')&&')'===T[T.length-1]}},{key:'generateChapterComponent',value:function(T,_,N){var R=parseInt(_),L='/'+(T+1)+'/';return L+=2*(R+1),N&&(L+='['+N+']'),L}}]),E}();u.default=C,s.exports=u['default']},function(s,u,p){'use strict';function f(k,C){if(!(k instanceof C))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var g=function(){function k(C,E){for(var S=0;S<E.length;S++){var T=E[S];T.enumerable=T.enumerable||!1,T.configurable=!0,'value'in T&&(T.writable=!0),Object.defineProperty(C,T.key,T)}}return function(C,E,S){return E&&k(C.prototype,E),S&&k(C,S),C}}(),y=p(19),x=function(C){return C&&C.__esModule?C:{default:C}}(y),v=function(){function k(C){f(this,k),this.layout=C}return g(k,[{key:'section',value:function(E){var S=this.findRanges(E),T=this.rangeListToCfiList(E.section.cfiBase,S);return T}},{key:'page',value:function(E,S,T,_){var N=E&&E.document&&E.document.body;return N?this.rangePairToCfiPair(S,{start:this.findStart(N,T,_),end:this.findEnd(N,T,_)}):void 0}},{key:'walk',value:function(E,S){for(var _,N,T=document.createTreeWalker(E,NodeFilter.SHOW_TEXT,{acceptNode:function(L){return 0<L.data.trim().length?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);(_=T.nextNode())&&(N=S(_),!N););return N}},{key:'findRanges',value:function(E){var L,P,S=[],T=E.contents.scrollWidth(),_=this.layout.count(T),N=this.layout.column,R=this.layout.gap;for(var A=0;A<_.pages;A++)L=(N+R)*A,P=N*(A+1)+R*A,S.push({start:this.findStart(E.document.body,L,P),end:this.findEnd(E.document.body,L,P)});return S}},{key:'findStart',value:function(E,S,T){for(var N,R,_=[E],L=E;_.length;)if(N=_.shift(),R=this.walk(N,function(P){var A,O,B,z;return(P.nodeType==Node.TEXT_NODE?(z=document.createRange(),z.selectNodeContents(P),B=z.getBoundingClientRect()):B=P.getBoundingClientRect(),A=B.left,O=B.right,A>=S&&A<=T)?P:O>S?P:void(L=P,_.push(P))}),R)return this.findTextStartRange(R,S,T);return this.findTextStartRange(L,S,T)}},{key:'findEnd',value:function(E,S,T){for(var N,L,_=[E],R=E;_.length;)if(N=_.shift(),L=this.walk(N,function(P){var A,O,B,z;return(P.nodeType==Node.TEXT_NODE?(z=document.createRange(),z.selectNodeContents(P),B=z.getBoundingClientRect()):B=P.getBoundingClientRect(),A=B.left,O=B.right,A>T&&R)?R:O>T?P:void(R=P,_.push(P))}),L)return this.findTextEndRange(L,S,T);return this.findTextEndRange(R,S,T)}},{key:'findTextStartRange',value:function(E,S){var _,N,T=this.splitTextNodeIntoRanges(E);for(var R=0;R<T.length;R++)if(_=T[R],N=_.getBoundingClientRect(),N.left>=S)return _;return T[0]}},{key:'findTextEndRange',value:function(E,S,T){var N,R,L,_=this.splitTextNodeIntoRanges(E);for(var P=0;P<_.length;P++){if(R=_[P],L=R.getBoundingClientRect(),L.left>T&&N)return N;if(L.right>T)return R;N=R}return _[_.length-1]}},{key:'splitTextNodeIntoRanges',value:function(E,S){var R,T=[],_=E.textContent||'',N=_.trim(),L=E.ownerDocument,P=S||' ',A=N.indexOf(P);if(-1===A||E.nodeType!=Node.TEXT_NODE)return R=L.createRange(),R.selectNodeContents(E),[R];for(R=L.createRange(),R.setStart(E,0),R.setEnd(E,A),T.push(R),R=!1;-1!=A;)A=N.indexOf(P,A+1),0<A&&(R&&(R.setEnd(E,A),T.push(R)),R=L.createRange(),R.setStart(E,A+1));return R&&(R.setEnd(E,N.length),T.push(R)),T}},{key:'rangePairToCfiPair',value:function(E,S){var T=S.start,_=S.end;T.collapse(!0),_.collapse(!0);var N=new x.default(T,E).toString(),R=new x.default(_,E).toString();return{start:N,end:R}}},{key:'rangeListToCfiList',value:function(E,S){var _,T=[];for(var N=0;N<S.length;N++)_=this.rangePairToCfiPair(E,S[N]),T.push(_);return T}}]),k}();u.default=v,s.exports=u['default']},function(s,u,p){'use strict';Object.defineProperty(u,'__esModule',{value:!0}),u.replaceBase=function(v,k){var C,E;v&&(E=(0,f.qs)(v,'head'),C=(0,f.qs)(E,'base'),!C&&(C=v.createElement('base'),E.insertBefore(C,E.firstChild)),C.setAttribute('href',k.url))},u.replaceCanonical=function(v,k){var C,E,S=k.url;v&&(C=(0,f.qs)(v,'head'),E=(0,f.qs)(C,'link[rel=\'canonical\']'),E?E.setAttribute('href',S):(E=v.createElement('link'),E.setAttribute('rel','canonical'),E.setAttribute('href',S),C.appendChild(E)))},u.replaceLinks=function(v,k){var C=v.querySelectorAll('a[href]'),E=(0,f.qs)(v.ownerDocument,'base'),S=E?E.href:void 0,T=function(N){var R=N.getAttribute('href');if(0!==R.indexOf('mailto:')){var L=-1<R.indexOf('://'),P=new y.default(R,S);L?N.setAttribute('target','_blank'):N.onclick=function(){return P&&P.hash?k(P.Path.path+P.hash):P?k(P.Path.path):k(R),!1}}}.bind(this);for(var _=0;_<C.length;_++)T(C[_])},u.substitute=function(v,k,C){return k.forEach(function(E,S){E&&C[S]&&(v=v.replace(new RegExp(E,'g'),C[S]))}),v};var f=p(17),g=p(22),y=function(v){return v&&v.__esModule?v:{default:v}}(g)},function(s,u,p){'use strict';function f(S){return S&&S.__esModule?S:{default:S}}function g(S,T){if(!(S instanceof T))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var y=function(){function S(T,_){for(var N=0;N<_.length;N++){var R=_[N];R.enumerable=R.enumerable||!1,R.configurable=!0,'value'in R&&(R.writable=!0),Object.defineProperty(T,R.key,R)}}return function(T,_,N){return _&&S(T.prototype,_),N&&S(T,N),T}}(),x=p(23),v=f(x),k=p(24),C=f(k),E=function(){function S(T,_){g(this,S);var N=-1<T.indexOf('://'),R=T;if(this.Url=void 0,this.href=T,this.protocol='',this.origin='',this.hash='',this.hash='',this.search='',this.base=_,!N&&!1!==_&&'string'!=typeof _&&window&&window.location&&(this.base=window.location.href),N||this.base)try{this.Url=this.base?new URL(T,this.base):new URL(T),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,R=this.Url.pathname}catch(L){this.Url=void 0}this.Path=new v.default(R),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}return y(S,[{key:'path',value:function(){return this.Path}},{key:'resolve',value:function(_){var R,N=-1<_.indexOf('://');return N?_:(R=C.default.resolve(this.directory,_),this.origin+R)}},{key:'relative',value:function(_){return C.default.relative(_,this.directory)}},{key:'toString',value:function(){return this.href}}]),S}();u.default=E,s.exports=u['default']},function(s,u,p){'use strict';function f(k,C){if(!(k instanceof C))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(u,'__esModule',{value:!0});var g=function(){function k(C,E){for(var S=0;S<E.length;S++){var T=E[S];T.enumerable=T.enumerable||!1,T.configurable=!0,'value'in T&&(T.writable=!0),Object.defineProperty(C,T.key,T)}}return function(C,E,S){return E&&k(C.prototype,E),S&&k(C,S),C}}(),y=p(24),x=function(C){return C&&C.__esModule?C:{default:C}}(y),v=function(){function k(C){f(this,k);var E,S;E=C.indexOf('://'),-1<E&&(C=new URL(C).pathname),S=this.parse(C),this.path=C,this.directory=this.isDirectory(C)?C:S.dir+'/',this.filename=S.base,this.extension=S.ext.slice(1)}return g(k,[{key:'parse',value:function(E){return x.default.parse(E)}},{key:'isAbsolute',value:function(E){return x.default.isAbsolute(E||this.path)}},{key:'isDirectory',value:function(E){return'/'===E.charAt(E.length-1)}},{key:'resolve',value:function(E){return x.default.resolve(this.directory,E)}},{key:'relative',value:function(E){return x.default.relative(this.directory,E)}},{key:'splitPath',value:function(E){return this.splitPathRe.exec(E).slice(1)}},{key:'toString',value:function(){return this.path}}]),k}();u.default=v,s.exports=u['default']},function(s,u,p){(function(f){'use strict';function g(k){if('string'!=typeof k)throw new TypeError('Path must be a string. Received '+k)}function y(k,C){var E='',S=-1,T=0,_;for(var N=0;N<=k.length;++N){if(N<k.length)_=k.charCodeAt(N);else if(47===_)break;else _=47;if(47===_){if(S==N-1||1==T);else if(S!=N-1&&2==T){if(2>E.length||46!==E.charCodeAt(E.length-1)||46!==E.charCodeAt(E.length-2))if(2<E.length){for(var R=E.length-1,L=R;0<=L&&47!==E.charCodeAt(L);--L);if(L!==R){E=-1===L?'':E.slice(0,L),S=N,T=0;continue}}else if(2===E.length||1===E.length){E='',S=N,T=0;continue}C&&(0<E.length?E+='/..':E='..')}else 0<E.length?E+='/'+k.slice(S+1,N):E=k.slice(S+1,N);S=N,T=0}else 46===_&&-1!=T?++T:T=-1}return E}function x(k,C){var E=C.dir||C.root,S=C.base||(C.name||'')+(C.ext||'');return E?E===C.root?E+S:E+k+S:S}if(!f)var f={cwd:function(){return'/'}};var v={resolve:function(){var S,C='',E=!1;for(var T=arguments.length-1;-1<=T&&!E;T--){var _;(0<=T?_=arguments[T]:(void 0==S&&(S=f.cwd()),_=S),g(_),0!==_.length)&&(C=_+'/'+C,E=47===_.charCodeAt(0))}return(C=y(C,!E),E)?0<C.length?'/'+C:'/':0<C.length?C:'.'},normalize:function(C){if(g(C),0===C.length)return'.';var E=47===C.charCodeAt(0),S=47===C.charCodeAt(C.length-1);return C=y(C,!E),0!==C.length||E||(C='.'),0<C.length&&S&&(C+='/'),E?'/'+C:C},isAbsolute:function(C){return g(C),0<C.length&&47===C.charCodeAt(0)},join:function(){if(0===arguments.length)return'.';var C;for(var E=0;E<arguments.length;++E){var S=arguments[E];g(S),0<S.length&&(C==void 0?C=S:C+='/'+S)}return void 0===C?'.':v.normalize(C)},relative:function(C,E){if(g(C),g(E),C===E)return'';if(C=v.resolve(C),E=v.resolve(E),C===E)return'';for(var S=1;S<C.length&&47===C.charCodeAt(S);++S);for(var T=C.length,_=T-S,N=1;N<E.length&&47===E.charCodeAt(N);++N);for(var R=E.length,L=R-N,P=_<L?_:L,A=-1,O=0;O<=P;++O){if(O===P){if(L>P){if(47===E.charCodeAt(N+O))return E.slice(N+O+1);if(0==O)return E.slice(N+O)}else _>P&&(47===C.charCodeAt(S+O)?A=O:0===O&&(A=0));break}var B=C.charCodeAt(S+O),z=E.charCodeAt(N+O);if(B!==z)break;else 47===B&&(A=O)}var W='';for(O=S+A+1;O<=T;++O)(O===T||47===C.charCodeAt(O))&&(W+=0===W.length?'..':'/..');return 0<W.length?W+E.slice(N+A):(N+=A,47===E.charCodeAt(N)&&++N,E.slice(N))},_makeLong:function(C){return C},dirname:function(C){if(g(C),0===C.length)return'.';var E=C.charCodeAt(0),S=47===E,T=-1,_=!0;for(var N=C.length-1;1<=N;--N)if(E=C.charCodeAt(N),47!==E)_=!1;else if(!_){T=N;break}return-1===T?S?'/':'.':S&&1===T?'//':C.slice(0,T)},basename:function(C,E){if(E!==void 0&&'string'!=typeof E)throw new TypeError('"ext" argument must be a string');g(C);var S=0,T=-1,_=!0,N;if(void 0!==E&&0<E.length&&E.length<=C.length){if(E.length===C.length&&E===C)return'';var R=E.length-1,L=-1;for(N=C.length-1;0<=N;--N){var P=C.charCodeAt(N);if(47!==P)-1==L&&(_=!1,L=N+1),0<=R&&(P===E.charCodeAt(R)?-1==--R&&(T=N):(R=-1,T=L));else if(!_){S=N+1;break}}return S===T?T=L:-1===T&&(T=C.length),C.slice(S,T)}for(N=C.length-1;0<=N;--N)if(47!==C.charCodeAt(N))-1==T&&(_=!1,T=N+1);else if(!_){S=N+1;break}return-1===T?'':C.slice(S,T)},extname:function(C){g(C);var E=-1,S=0,T=-1,_=!0,N=0;for(var R=C.length-1;0<=R;--R){var L=C.charCodeAt(R);if(47===L){if(!_){S=R+1;break}continue}-1==T&&(_=!1,T=R+1),46===L?-1==E?E=R:1!=N&&(N=1):-1!=E&&(N=-1)}return-1===E||-1===T||0==N||1==N&&E===T-1&&E===S+1?'':C.slice(E,T)},format:function(C){if(null===C||'object'!=typeof C)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof C);return x('/',C)},parse:function(C){g(C);var E={root:'',dir:'',base:'',ext:'',name:''};if(0===C.length)return E;var _,S=C.charCodeAt(0),T=47===S;T?(E.root='/',_=1):_=0;for(var N=-1,R=0,L=-1,P=!0,A=C.length-1,O=0;A>=_;--A){if(S=C.charCodeAt(A),47===S){if(!P){R=A+1;break}continue}-1==L&&(P=!1,L=A+1),46===S?-1==N?N=A:1!=O&&(O=1):-1!=N&&(O=-1)}return-1==N||-1==L||0==O||1==O&&N==L-1&&N==R+1?-1!=L&&(0==R&&T?E.base=E.name=C.slice(1,L):E.base=E.name=C.slice(R,L)):(0==R&&T?(E.name=C.slice(1,N),E.base=C.slice(1,L)):(E.name=C.slice(R,N),E.base=C.slice(R,L)),E.ext=C.slice(N,L)),0<R?E.dir=C.slice(0,R-1):T&&(E.dir='/'),E},sep:'/',delimiter:':',posix:null};s.exports=v}).call(u,p(25))},function(s){function u(){throw new Error('setTimeout has not been defined')}function p(){throw new Error('clearTimeout has not been defined')}function f(L){if(E===setTimeout)return setTimeout(L,0);if((E===u||!E)&&setTimeout)return E=setTimeout,setTimeout(L,0);try{return E(L,0)}catch(P){try{return E.call(null,L,0)}catch(A){return E.call(this,L,0)}}}function g(L){if(S===clearTimeout)return clearTimeout(L);if((S===p||!S)&&clearTimeout)return S=clearTimeout,clearTimeout(L);try{return S(L)}catch(P){try{return S.call(null,L)}catch(A){return S.call(this,L)}}}function y(){_&&N&&(_=!1,N.length?T=N.concat(T):R=-1,T.length&&x())}function x(){if(!_){var L=f(y);_=!0;for(var P=T.length;P;){for(N=T,T=[];++R<P;)N&&N[R].run();R=-1,P=T.length}N=null,_=!1,g(L)}}function v(L,P){this.fun=L,this.array=P}function k(){}var C=s.exports={},E,S;(function(){try{E='function'==typeof setTimeout?setTimeout:u}catch(L){E=u}try{S='function'==typeof clearTimeout?clearTimeout:p}catch(L){S=p}})();var T=[],_=!1,N,R=-1;C.nextTick=function(L){var P=Array(arguments.length-1);if(1<arguments.length)for(var A=1;A<arguments.length;A++)P[A-1]=arguments[A];T.push(new v(L,P)),1!==T.length||_||f(x)},v.prototype.run=function(){this.fun.apply(null,this.array)},C.title='browser',C.browser=!0,C.env={},C.argv=[],C.version='',C.versions={},C.on=k,C.addListener=k,C.once=k,C.off=k,C.removeListener=k,C.removeAllListeners=k,C.emit=k,C.binding=function(){throw new Error('process.binding is not supported')},C.cwd=function(){return'/'},C.chdir=function(){throw new Error('process.chdir is not supported')},C.umask=function(){return 0}}])});