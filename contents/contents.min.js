var _Stringprototype=String.prototype,_Mathmax=Math.max,_Mathfloor=Math.floor;(function(u,p){'object'==typeof exports&&'object'==typeof module?module.exports=p(require('xmldom')):'function'==typeof define&&define.amd?define(['xmldom'],p):'object'==typeof exports?exports.EPUBJSContents=p(require('xmldom')):u.EPUBJSContents=p(u.xmldom)})(this,function(s){return function(u){function p(v){if(f[v])return f[v].exports;var k=f[v]={i:v,l:!1,exports:{}};return u[v].call(k.exports,k,k.exports,p),k.l=!0,k.exports}var f={};return p.m=u,p.c=f,p.i=function(v){return v},p.d=function(v,k,C){p.o(v,k)||Object.defineProperty(v,k,{configurable:!1,enumerable:!0,get:C})},p.n=function(v){var k=v&&v.__esModule?function(){return v['default']}:function(){return v};return p.d(k,'a',k),k},p.o=function(v,k){return Object.prototype.hasOwnProperty.call(v,k)},p.p='',p(p.s=26)}([function(u,p,f){'use strict';function v(pe,fe){if(!(pe instanceof fe))throw new TypeError('Cannot call a class as a function')}function C(){var pe=new Date().getTime(),fe='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(he){var ge=0|(pe+16*Math.random())%16;return pe=_Mathfloor(pe/16),('x'==he?ge:8|7&ge).toString(16)});return fe}function S(pe){return!isNaN(parseFloat(pe))&&isFinite(pe)}function L(pe,fe,he,ge,me){var xe,ye=ge||0,be=me||fe.length,ve=parseInt(ye+(be-ye)/2);return(he||(he=function(Ce,we){return Ce>we?1:Ce<we?-1:Ce==we?0:void 0}),0>=be-ye)?ve:(xe=he(fe[ve],pe),1==be-ye?0<xe?ve:ve+1:0===xe?ve:-1===xe?L(pe,fe,he,ve,be):L(pe,fe,he,ye,ve))}function P(pe,fe,he,ge,me){var xe,ye=ge||0,be=me||fe.length,ve=parseInt(ye+(be-ye)/2);return(he||(he=function(Ce,we){return Ce>we?1:Ce<we?-1:Ce==we?0:void 0}),0>=be-ye)?-1:(xe=he(fe[ve],pe),1==be-ye?0===xe?ve:-1:0===xe?ve:-1===xe?P(pe,fe,he,ve,be):P(pe,fe,he,ye,ve))}function W(pe,fe){for(var me,he=pe.parentNode,ge=he.childNodes,ye=-1,be=0;be<ge.length&&(me=ge[be],me.nodeType===fe&&ye++,me!=pe);be++);return ye}function J(pe,fe){return'undefined'==typeof pe.querySelector?pe.getElementsByTagName(fe):pe.querySelectorAll(fe)}function Z(pe,fe,he){for(var me,ge=document.createTreeWalker(pe,he,null,!1);me=ge.nextNode();)fe(me)}function $(pe,fe){if(fe(pe))return!0;if(pe=pe.firstChild,pe)do{var he=$(pe,fe);if(he)return!0;pe=pe.nextSibling}while(pe)}function ie(pe){for(var fe=[pe];pe;pe=pe.parentNode)fe.unshift(pe);return fe}Object.defineProperty(p,'__esModule',{value:!0});var le=function(){function pe(fe,he){for(var me,ge=0;ge<he.length;ge++)me=he[ge],me.enumerable=me.enumerable||!1,me.configurable=!0,'value'in me&&(me.writable=!0),Object.defineProperty(fe,me.key,me)}return function(fe,he,ge){return he&&pe(fe.prototype,he),ge&&pe(fe,ge),fe}}();p.isElement=function(pe){return!!(pe&&1==pe.nodeType)},p.uuid=C,p.documentHeight=function(){return _Mathmax(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},p.isNumber=S,p.isFloat=function(pe){return S(pe)&&_Mathfloor(pe)!==pe},p.prefixed=function(pe){var fe=['-Webkit-','-moz-','-o-','-ms-'],he=pe[0].toUpperCase()+pe.slice(1),ge=fe.length;if('undefined'==typeof document||'undefined'!=typeof document.body.style[pe])return pe;for(var me=0;me<ge;me++)if('undefined'!=typeof document.body.style[fe[me]+he])return fe[me]+he;return pe},p.defaults=function(pe){for(var ge,fe=1,he=arguments.length;fe<he;fe++)for(var me in ge=arguments[fe],ge)void 0===pe[me]&&(pe[me]=ge[me]);return pe},p.extend=function(pe){var fe=[].slice.call(arguments,1);return fe.forEach(function(he){he&&Object.getOwnPropertyNames(he).forEach(function(ge){Object.defineProperty(pe,ge,Object.getOwnPropertyDescriptor(he,ge))})}),pe},p.insert=function(pe,fe,he){var ge=L(pe,fe,he);return fe.splice(ge,0,pe),ge},p.locationOf=L,p.indexOfSorted=P,p.bounds=function(pe){var fe=window.getComputedStyle(pe),me=0,ye=0;return['width','paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(be){me+=parseFloat(fe[be])||0}),['height','paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(be){ye+=parseFloat(fe[be])||0}),{height:ye,width:me}},p.borders=function(pe){var fe=window.getComputedStyle(pe),me=0,ye=0;return['paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(be){me+=parseFloat(fe[be])||0}),['paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(be){ye+=parseFloat(fe[be])||0}),{height:ye,width:me}},p.windowBounds=function(){var pe=window.innerWidth,fe=window.innerHeight;return{top:0,left:0,right:pe,bottom:fe,width:pe,height:fe}},p.cleanStringForXpath=function(pe){var fe=pe.match(/[^'"]+|['"]/g);return fe=fe.map(function(he){return'\''===he?'"\'"':'"'===he?'\'"\'':'\''+he+'\''}),'concat(\'\','+fe.join(',')+')'},p.indexOfNode=W,p.indexOfTextNode=function(pe){return W(pe,se)},p.indexOfElementNode=function(pe){return W(pe,re)},p.isXml=function(pe){return-1<['xml','opf','ncx'].indexOf(pe)},p.createBlob=function(pe,fe){return new Blob([pe],{type:fe})},p.createBlobUrl=function(pe,fe){var ge,he=window.URL||window.webkitURL||window.mozURL,me=this.createBlob(pe,fe);return ge=he.createObjectURL(me),ge},p.createBase64Url=function(pe,fe){var he,ge;if('string'==typeof pe)return he=btoa(pe),ge='data:'+fe+';base64,'+he,ge},p.type=function(pe){return Object.prototype.toString.call(pe).slice(8,-1)},p.parse=function(pe,fe,he){var ge,me;return me='undefined'==typeof DOMParser||he?f(28).DOMParser:DOMParser,65279===pe.charCodeAt(0)&&(pe=pe.slice(1)),ge=new me().parseFromString(pe,fe),ge},p.qs=function(pe,fe){var he;if(!pe)throw new Error('No Element Provided');return'undefined'==typeof pe.querySelector?(he=pe.getElementsByTagName(fe),he.length)?he[0]:void 0:pe.querySelector(fe)},p.qsa=J,p.qsp=function(pe,fe,he){var ge,me;if('undefined'!=typeof pe.querySelector){for(var ye in fe+='[',he)fe+=ye+'=\''+he[ye]+'\'';return fe+=']',pe.querySelector(fe)}return(ge=pe.getElementsByTagName(fe),me=Array.prototype.slice.call(ge,0).filter(function(be){for(var ve in he)if(be.getAttribute(ve)===he[ve])return!0;return!1}),me)?me[0]:void 0},p.sprint=function(pe,fe){var he=pe.ownerDocument||pe;'undefined'==typeof he.createTreeWalker?$(pe,function(ge){ge&&3===ge.nodeType&&fe(ge)},!0):Z(pe,fe,NodeFilter.SHOW_TEXT)},p.treeWalker=Z,p.walk=$,p.blob2base64=function(pe){return new Promise(function(fe){var ge=new FileReader;ge.readAsDataURL(pe),ge.onloadend=function(){fe(ge.result)}})},p.defer=function(){var pe=this;this.resolve=null,this.reject=null,this.id=C(),this.promise=new Promise(function(fe,he){pe.resolve=fe,pe.reject=he}),Object.freeze(this)},p.querySelectorByType=function(pe,fe,he){var ge;if('undefined'!=typeof pe.querySelector&&(ge=pe.querySelector(fe+'[*|type="'+he+'"]')),!ge||0===ge.length){ge=J(pe,fe);for(var me=0;me<ge.length;me++)if(ge[me].getAttributeNS('http://www.idpf.org/2007/ops','type')===he)return ge[me]}else return ge},p.findChildren=function(pe){for(var me,fe=[],he=pe.childNodes,ge=0;ge<he.length;ge++)me=he[ge],1===me.nodeType&&fe.push(me);return fe},p.parents=ie;var oe=p.requestAnimationFrame='undefined'!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),re=1,se=3,ce=p.RangeObject=function(){function pe(){v(this,pe),this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}return le(pe,[{key:'setStart',value:function(he,ge){this.startContainer=he,this.startOffset=ge,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}},{key:'setEnd',value:function(he,ge){this.endContainer=he,this.endOffset=ge,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}},{key:'collapse',value:function(he){this.collapsed=!0,he?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}},{key:'selectNode',value:function(he){var ge=he.parentNode,me=Array.prototype.indexOf.call(ge.childNodes,he);this.setStart(ge,me),this.setEnd(ge,me+1)}},{key:'selectNodeContents',value:function(he){var ge=he.childNodes[he.childNodes-1],me=3===he.nodeType?he.textContent.length:parent.childNodes.length;this.setStart(he,0),this.setEnd(he,me)}},{key:'_commonAncestorContainer',value:function(he,ge){var me=ie(he||this.startContainer),ye=ie(ge||this.endContainer);if(me[0]==ye[0])for(var be=0;be<me.length;be++)if(me[be]!=ye[be])return me[be-1]}},{key:'_checkCollapsed',value:function(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}},{key:'toString',value:function(){}}]),pe}()},function(u,p,f){'use strict';function v(N,A){if(!(N instanceof A))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var k='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(N){return typeof N}:function(N){return N&&'function'==typeof Symbol&&N.constructor===Symbol&&N!==Symbol.prototype?'symbol':typeof N},C=function(){function N(A,L){for(var O,P=0;P<L.length;P++)O=L[P],O.enumerable=O.enumerable||!1,O.configurable=!0,'value'in O&&(O.writable=!0),Object.defineProperty(A,O.key,O)}return function(A,L,P){return L&&N(A.prototype,L),P&&N(A,P),A}}(),E=f(0),S=1,_=3,R=function(){function N(A,L,P){v(this,N);var O;if(this.str='',this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof N))return new N(A,L,P);if('string'==typeof L?this.base=this.parseComponent(L):'object'===('undefined'==typeof L?'undefined':k(L))&&L.steps&&(this.base=L),O=this.checkType(A),'string'===O)return this.str=A,(0,E.extend)(this,this.parse(A));if('range'===O)return(0,E.extend)(this,this.fromRange(A,this.base,P));if('node'===O)return(0,E.extend)(this,this.fromNode(A,this.base,P));if('EpubCFI'===O&&A.path)return A;if(!A)return this;throw new TypeError('not a valid argument for EpubCFI')}return C(N,[{key:'checkType',value:function(L){return this.isCfiString(L)?'string':'object'===('undefined'==typeof L?'undefined':k(L))&&('Range'===(0,E.type)(L)||'undefined'!=typeof L.startContainer)?'range':'object'===('undefined'==typeof L?'undefined':k(L))&&'undefined'!=typeof L.nodeType?'node':'object'===('undefined'==typeof L?'undefined':k(L))&&L instanceof N&&'EpubCFI'}},{key:'parse',value:function(L){var O,B,z,P={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return'string'==typeof L?(0===L.indexOf('epubcfi(')&&')'===L[L.length-1]&&(L=L.slice(8,L.length-1)),O=this.getChapterComponent(L),!O)?{spinePos:-1}:(P.base=this.parseComponent(O),B=this.getPathComponent(L),P.path=this.parseComponent(B),z=this.getRange(L),z&&(P.range=!0,P.start=this.parseComponent(z[0]),P.end=this.parseComponent(z[1])),P.spinePos=P.base.steps[1].index,P):{spinePos:-1}}},{key:'parseComponent',value:function(L){var z,P={steps:[],terminal:{offset:null,assertion:null}},O=L.split(':'),B=O[0].split('/');return 1<O.length&&(z=O[1],P.terminal=this.parseTerminal(z)),''===B[0]&&B.shift(),P.steps=B.map(function(M){return this.parseStep(M)}.bind(this)),P}},{key:'parseStep',value:function(L){var P,O,B,z,M;if(z=L.match(/\[(.*)\]/),z&&z[1]&&(M=z[1]),O=parseInt(L),!isNaN(O))return 0==O%2?(P='element',B=O/2-1):(P='text',B=(O-1)/2),{type:P,index:B,id:M||null}}},{key:'parseTerminal',value:function(L){var P,O,B=L.match(/\[(.*)\]/);return B&&B[1]?(P=parseInt(L.split('[')[0])||null,O=B[1]):P=parseInt(L)||null,{offset:P,assertion:O}}},{key:'getChapterComponent',value:function(L){var P=L.split('!');return P[0]}},{key:'getPathComponent',value:function(L){var P=L.split('!');if(P[1]){var O=P[1].split(',');return O[0]}}},{key:'getRange',value:function(L){var P=L.split(',');return 3===P.length&&[P[1],P[2]]}},{key:'getCharecterOffsetComponent',value:function(L){var P=L.split(':');return P[1]||''}},{key:'joinSteps',value:function(L){return L?L.map(function(P){var O='';return'element'===P.type&&(O+=2*(P.index+1)),'text'===P.type&&(O+=1+2*P.index),P.id&&(O+='['+P.id+']'),O}).join('/'):''}},{key:'segmentString',value:function(L){var A='/';return A+=this.joinSteps(L.steps),L.terminal&&null!=L.terminal.offset&&(A+=':'+L.terminal.offset),L.terminal&&null!=L.terminal.assertion&&(A+='['+L.terminal.assertion+']'),A}},{key:'toString',value:function(){var L='epubcfi(';return L+=this.segmentString(this.base),L+='!',L+=this.segmentString(this.path),this.start&&(L+=',',L+=this.segmentString(this.start)),this.end&&(L+=',',L+=this.segmentString(this.end)),L+=')',L}},{key:'compare',value:function(L,P){var O,B,z,M;if('string'==typeof L&&(L=new N(L)),'string'==typeof P&&(P=new N(P)),L.spinePos>P.spinePos)return 1;if(L.spinePos<P.spinePos)return-1;L.range?(O=L.path.steps.concat(L.start.steps),z=L.start.terminal):(O=L.path.steps,z=L.path.terminal),P.range?(B=P.path.steps.concat(P.start.steps),M=P.start.terminal):(B=P.path.steps,M=P.path.terminal);for(var W=0;W<O.length;W++){if(!O[W])return-1;if(!B[W])return 1;if(O[W].index>B[W].index)return 1;if(O[W].index<B[W].index)return-1}return O.length<B.length?1:z.offset>M.offset?1:z.offset<M.offset?-1:0}},{key:'step',value:function(L){var P=L.nodeType===_?'text':'element';return{id:L.id,tagName:L.tagName,type:P,index:this.position(L)}}},{key:'filteredStep',value:function(L,P){var B,O=this.filter(L,P);if(O)return B=O.nodeType===_?'text':'element',{id:O.id,tagName:O.tagName,type:B,index:this.filteredPosition(O,P)}}},{key:'pathTo',value:function(L,P,O){for(var M,B={steps:[],terminal:{offset:null,assertion:null}},z=L;z&&z.parentNode&&z.parentNode.nodeType!=9;)M=O?this.filteredStep(z,O):this.step(z),M&&B.steps.unshift(M),z=z.parentNode;return null!=P&&0<=P&&(B.terminal.offset=P,'text'!=B.steps[B.steps.length-1].type&&B.steps.push({type:'text',index:0})),B}},{key:'equalStep',value:function(L,P){return L&&P&&L.index===P.index&&L.id===P.id&&L.type===P.type}},{key:'fromRange',value:function(L,P,O){var B={range:!1,base:{},path:{},start:null,end:null},z=L.startContainer,M=L.endContainer,W=L.startOffset,D=L.endOffset,U=!1;if(O&&(U=null!=z.ownerDocument.querySelector('.'+O)),'string'==typeof P?(B.base=this.parseComponent(P),B.spinePos=B.base.steps[1].index):'object'===('undefined'==typeof P?'undefined':k(P))&&(B.base=P),L.collapsed)U&&(W=this.patchOffset(z,W,O)),B.path=this.pathTo(z,W,O);else{B.range=!0,U&&(W=this.patchOffset(z,W,O)),B.start=this.pathTo(z,W,O),U&&(D=this.patchOffset(M,D,O)),B.end=this.pathTo(M,D,O),B.path={steps:[],terminal:null};var H,I=B.start.steps.length;for(H=0;H<I&&this.equalStep(B.start.steps[H],B.end.steps[H]);H++)H===I-1?B.start.terminal===B.end.terminal&&(B.path.steps.push(B.start.steps[H]),B.range=!1):B.path.steps.push(B.start.steps[H]);B.start.steps=B.start.steps.slice(B.path.steps.length),B.end.steps=B.end.steps.slice(B.path.steps.length)}return B}},{key:'fromNode',value:function(L,P,O){var B={range:!1,base:{},path:{},start:null,end:null};return'string'==typeof P?(B.base=this.parseComponent(P),B.spinePos=B.base.steps[1].index):'object'===('undefined'==typeof P?'undefined':k(P))&&(B.base=P),B.path=this.pathTo(L,null,O),B}},{key:'filter',value:function(L,P){var O,B,z,M,W,D=!1;return L.nodeType===_?(D=!0,z=L.parentNode,O=L.parentNode.classList.contains(P)):(D=!1,O=L.classList.contains(P)),O&&D?(M=z.previousSibling,W=z.nextSibling,M&&M.nodeType===_?B=M:W&&W.nodeType===_&&(B=W),B?B:L):O&&!D?!1:L}},{key:'patchOffset',value:function(L,P,O){if(L.nodeType!=_)throw new Error('Anchor must be a text node');var B=L,z=P;for(L.parentNode.classList.contains(O)&&(B=L.parentNode);B.previousSibling;){if(B.previousSibling.nodeType!==S)z+=B.previousSibling.textContent.length;else if(B.previousSibling.classList.contains(O))z+=B.previousSibling.textContent.length;else break;B=B.previousSibling}return z}},{key:'normalizedMap',value:function(L,P,O){var M,D,U,B={},z=-1,W=L.length;for(M=0;M<W;M++)D=L[M].nodeType,D===S&&L[M].classList.contains(O)&&(D=_),0<M&&D===_&&U===_?B[M]=z:P===D&&(++z,B[M]=z),U=D;return B}},{key:'position',value:function(L){var P,O;return L.nodeType===S?(P=L.parentNode.children,!P&&(P=(0,E.findChildren)(L.parentNode)),O=Array.prototype.indexOf.call(P,L)):(P=this.textNodes(L.parentNode),O=P.indexOf(L)),O}},{key:'filteredPosition',value:function(L,P){var O,B,z;return L.nodeType===S?(O=L.parentNode.children,z=this.normalizedMap(O,S,P)):(O=L.parentNode.childNodes,L.parentNode.classList.contains(P)&&(L=L.parentNode,O=L.parentNode.childNodes),z=this.normalizedMap(O,_,P)),B=Array.prototype.indexOf.call(O,L),z[B]}},{key:'stepsToXpath',value:function(L){var P=['.','*'];return L.forEach(function(O){var B=O.index+1;O.id?P.push('*[position()='+B+' and @id=\''+O.id+'\']'):'text'===O.type?P.push('text()['+B+']'):P.push('*['+B+']')}),P.join('/')}},{key:'stepsToQuerySelector',value:function(L){var P=['html'];return L.forEach(function(O){var B=O.index+1;O.id?P.push('#'+O.id):'text'===O.type||P.push('*:nth-child('+B+')')}),P.join('>')}},{key:'textNodes',value:function(L,P){return Array.prototype.slice.call(L.childNodes).filter(function(O){return O.nodeType===_||P&&O.classList.contains(P)})}},{key:'walkToNode',value:function(L,P,O){var M,W,U,B=P||document,z=B.documentElement,D=L.length;for(U=0;U<D&&(W=L[U],'element'===W.type?W.id?z=B.getElementById(W.id):(M=z.children||(0,E.findChildren)(z),z=M[W.index]):'text'===W.type&&(z=this.textNodes(z,O)[W.index]),!!z);U++);return z}},{key:'findNode',value:function(L,P,O){var z,M,B=P||document;return O||'undefined'==typeof B.evaluate?O?z=this.walkToNode(L,B,O):z=this.walkToNode(L,B):(M=this.stepsToXpath(L),z=B.evaluate(M,B,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),z}},{key:'fixMiss',value:function(L,P,O,B){var D,U,z=this.findNode(L.slice(0,-1),O,B),M=z.childNodes,W=this.normalizedMap(M,_,B),I=L[L.length-1].index;for(var H in W){if(!W.hasOwnProperty(H))return;if(W[H]===I)if(D=M[H],U=D.textContent.length,P>U)P-=U;else{z=D.nodeType===S?D.childNodes[0]:D;break}}return{container:z,offset:P}}},{key:'toRange',value:function(L,P){var B,z,M,W,D,I,H,X,O=L||document,U=this,F=!!P&&null!=O.querySelector('.'+P);if(B='undefined'==typeof O.createRange?new E.RangeObject:O.createRange(),U.range?(z=U.start,I=U.path.steps.concat(z.steps),W=this.findNode(I,O,F?P:null),M=U.end,H=U.path.steps.concat(M.steps),D=this.findNode(H,O,F?P:null)):(z=U.path,I=U.path.steps,W=this.findNode(U.path.steps,O,F?P:null)),W)try{null==z.terminal.offset?B.setStart(W,0):B.setStart(W,z.terminal.offset)}catch(Y){X=this.fixMiss(I,z.terminal.offset,O,F?P:null),B.setStart(X.container,X.offset)}else return console.log('NO START'),null;if(D)try{null==M.terminal.offset?B.setEnd(D,0):B.setEnd(D,M.terminal.offset)}catch(Y){X=this.fixMiss(H,U.end.terminal.offset,O,F?P:null),B.setEnd(X.container,X.offset)}return B}},{key:'isCfiString',value:function(L){return'string'==typeof L&&0===L.indexOf('epubcfi(')&&')'===L[L.length-1]}},{key:'generateChapterComponent',value:function(L,P,O){var B=parseInt(P),M='/'+2*(L+1)+'/';return M+=2*(B+1),O&&(M+='['+O+']'),M}}]),N}();p.default=R,u.exports=p['default']},function(u,p,f){'use strict';(function(v){function k(_){if('string'!=typeof _)throw new TypeError('Path must be a string. Received '+_)}function C(_,T){for(var L,R='',N=-1,A=0,P=0;P<=_.length;++P){if(P<_.length)L=_.charCodeAt(P);else if(47===L)break;else L=47;if(47===L){if(N==P-1||1==A);else if(N!=P-1&&2==A){if(2>R.length||46!==R.charCodeAt(R.length-1)||46!==R.charCodeAt(R.length-2))if(2<R.length){for(var O=R.length-1,B=O;0<=B&&47!==R.charCodeAt(B);--B);if(B!=O){R=-1==B?'':R.slice(0,B),N=P,A=0;continue}}else if(2===R.length||1===R.length){R='',N=P,A=0;continue}T&&(0<R.length?R+='/..':R='..')}else 0<R.length?R+='/'+_.slice(N+1,P):R=_.slice(N+1,P);N=P,A=0}else 46===L&&-1!=A?++A:A=-1}return R}function E(_,T){var R=T.dir||T.root,N=T.base||(T.name||'')+(T.ext||'');return R?R===T.root?R+N:R+_+N:N}if(!v)var v={cwd:function(){return'/'}};var S={resolve:function(){for(var N,T='',R=!1,A=arguments.length-1;-1<=A&&!R;A--){var L;(0<=A?L=arguments[A]:(void 0==N&&(N=v.cwd()),L=N),k(L),0!==L.length)&&(T=L+'/'+T,R=47===L.charCodeAt(0))}return T=C(T,!R),R?0<T.length?'/'+T:'/':0<T.length?T:'.'},normalize:function(T){if(k(T),0===T.length)return'.';var R=47===T.charCodeAt(0),N=47===T.charCodeAt(T.length-1);return T=C(T,!R),0!==T.length||R||(T='.'),0<T.length&&N&&(T+='/'),R?'/'+T:T},isAbsolute:function(T){return k(T),0<T.length&&47===T.charCodeAt(0)},join:function(){if(0===arguments.length)return'.';for(var T,N,R=0;R<arguments.length;++R)N=arguments[R],k(N),0<N.length&&(void 0==T?T=N:T+='/'+N);return void 0===T?'.':S.normalize(T)},relative:function(T,R){if(k(T),k(R),T===R)return'';if(T=S.resolve(T),R=S.resolve(R),T===R)return'';for(var N=1;N<T.length&&47===T.charCodeAt(N);++N);for(var A=T.length,L=A-N,P=1;P<R.length&&47===R.charCodeAt(P);++P);for(var O=R.length,B=O-P,z=L<B?L:B,M=-1,W=0;W<=z;++W){if(W==z){if(B>z){if(47===R.charCodeAt(P+W))return R.slice(P+W+1);if(0==W)return R.slice(P+W)}else L>z&&(47===T.charCodeAt(N+W)?M=W:0==W&&(M=0));break}var D=T.charCodeAt(N+W),U=R.charCodeAt(P+W);if(D!==U)break;else 47===D&&(M=W)}var I='';for(W=N+M+1;W<=A;++W)(W===A||47===T.charCodeAt(W))&&(I+=0===I.length?'..':'/..');return 0<I.length?I+R.slice(P+M):(P+=M,47===R.charCodeAt(P)&&++P,R.slice(P))},_makeLong:function(T){return T},dirname:function(T){if(k(T),0===T.length)return'.';for(var R=T.charCodeAt(0),N=47===R,A=-1,L=!0,P=T.length-1;1<=P;--P)if(R=T.charCodeAt(P),47!==R)L=!1;else if(!L){A=P;break}return-1===A?N?'/':'.':N&&1===A?'//':T.slice(0,A)},basename:function(T,R){if(R!==void 0&&'string'!=typeof R)throw new TypeError('"ext" argument must be a string');k(T);var N=0,A=-1,L=!0,P;if(void 0!==R&&0<R.length&&R.length<=T.length){if(R.length===T.length&&R===T)return'';var O=R.length-1,B=-1;for(P=T.length-1;0<=P;--P){var z=T.charCodeAt(P);if(47!==z)-1==B&&(L=!1,B=P+1),0<=O&&(z===R.charCodeAt(O)?-1==--O&&(A=P):(O=-1,A=B));else if(!L){N=P+1;break}}return N===A?A=B:-1===A&&(A=T.length),T.slice(N,A)}for(P=T.length-1;0<=P;--P)if(47!==T.charCodeAt(P))-1==A&&(L=!1,A=P+1);else if(!L){N=P+1;break}return-1===A?'':T.slice(N,A)},extname:function(T){k(T);for(var B,R=-1,N=0,A=-1,L=!0,P=0,O=T.length-1;0<=O;--O){if(B=T.charCodeAt(O),47===B){if(!L){N=O+1;break}continue}-1==A&&(L=!1,A=O+1),46===B?-1==R?R=O:1!=P&&(P=1):-1!==R&&(P=-1)}return-1===R||-1===A||0==P||1==P&&R===A-1&&R===N+1?'':T.slice(R,A)},format:function(T){if(null===T||'object'!=typeof T)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof T);return E('/',T)},parse:function(T){k(T);var R={root:'',dir:'',base:'',ext:'',name:''};if(0===T.length)return R;var L,N=T.charCodeAt(0),A=47===N;A?(R.root='/',L=1):L=0;for(var P=-1,O=0,B=-1,z=!0,M=T.length-1,W=0;M>=L;--M){if(N=T.charCodeAt(M),47===N){if(!z){O=M+1;break}continue}-1==B&&(z=!1,B=M+1),46===N?-1==P?P=M:1!=W&&(W=1):-1!=P&&(W=-1)}return-1==P||-1==B||0==W||1==W&&P==B-1&&P==O+1?-1!=B&&(0==O&&A?R.base=R.name=T.slice(1,B):R.base=R.name=T.slice(O,B)):(0==O&&A?(R.name=T.slice(1,P),R.base=T.slice(1,B)):(R.name=T.slice(O,P),R.base=T.slice(O,B)),R.ext=T.slice(P,B)),0<O?R.dir=T.slice(0,O-1):A&&(R.dir='/'),R},sep:'/',delimiter:':',posix:null};u.exports=S}).call(p,f(27))},function(u,p,f){'use strict';function v(M){return M&&M.__esModule?M:{default:M}}function k(M,W){if(!(M instanceof W))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function M(W,D){var U=[],I=!0,H=!1,F;try{for(var Y,X=W[Symbol.iterator]();!(I=(Y=X.next()).done)&&(U.push(Y.value),!(D&&U.length===D));I=!0);}catch(K){H=!0,F=K}finally{try{!I&&X['return']&&X['return']()}finally{if(H)throw F}}return U}return function(W,D){if(Array.isArray(W))return W;if(Symbol.iterator in Object(W))return M(W,D);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),E=function(){function M(W,D){for(var I,U=0;U<D.length;U++)I=D[U],I.enumerable=I.enumerable||!1,I.configurable=!0,'value'in I&&(I.writable=!0),Object.defineProperty(W,I.key,I)}return function(W,D,U){return D&&M(W.prototype,D),U&&M(W,U),W}}(),S=f(8),_=v(S),T=f(0),R=f(1),N=v(R),A=f(4),L=v(A),P=f(6),O=f(24),B=['keydown','keyup','keypressed','mouseup','mousedown','click','touchend','touchstart'],z=function(){function M(W,D,U){k(this,M),this.epubcfi=new N.default,this.document=W,this.documentElement=this.document.documentElement,this.content=D||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.cfiBase=U||'',this.pane=void 0,this.listeners()}return E(M,[{key:'width',value:function(D){var U=this.content;return D&&(0,T.isNumber)(D)&&(D+='px'),D&&(U.style.width=D),this.window.getComputedStyle(U).width}},{key:'height',value:function(D){var U=this.content;return D&&(0,T.isNumber)(D)&&(D+='px'),D&&(U.style.height=D),this.window.getComputedStyle(U).height}},{key:'contentWidth',value:function(D){var U=this.content||this.document.body;return D&&(0,T.isNumber)(D)&&(D+='px'),D&&(U.style.width=D),this.window.getComputedStyle(U).width}},{key:'contentHeight',value:function(D){var U=this.content||this.document.body;return D&&(0,T.isNumber)(D)&&(D+='px'),D&&(U.style.height=D),this.window.getComputedStyle(U).height}},{key:'textWidth',value:function(){var D,U=this.document.createRange(),I=this.content||this.document.body;return U.selectNodeContents(I),D=U.getBoundingClientRect().width,D}},{key:'textHeight',value:function(){var D,U=this.document.createRange(),I=this.content||this.document.body;return U.selectNodeContents(I),D=U.getBoundingClientRect().height,D}},{key:'scrollWidth',value:function(){var D=this.documentElement.scrollWidth;return D}},{key:'scrollHeight',value:function(){var D=this.documentElement.scrollHeight;return D}},{key:'overflow',value:function(D){return D&&(this.documentElement.style.overflow=D),this.window.getComputedStyle(this.documentElement).overflow}},{key:'overflowX',value:function(D){return D&&(this.documentElement.style.overflowX=D),this.window.getComputedStyle(this.documentElement).overflowX}},{key:'overflowY',value:function(D){return D&&(this.documentElement.style.overflowY=D),this.window.getComputedStyle(this.documentElement).overflowY}},{key:'css',value:function(D,U,I){var H=this.content||this.document.body;return U&&H.style.setProperty(D,U,I?'important':''),this.window.getComputedStyle(H)[D]}},{key:'viewport',value:function(D){var K,V,J,Q,G,Z,$=this.document.querySelector('meta[name=\'viewport\']'),ee='';if($&&$.hasAttribute('content')){var te=$.getAttribute('content'),ne=te.match(/width\s*=\s*([^,]*)/g),ae=te.match(/height\s*=\s*([^,]*)/g),ie=te.match(/initial-scale\s*=\s*([^,]*)/g),le=te.match(/minimum-scale\s*=\s*([^,]*)/g),oe=te.match(/maximum-scale\s*=\s*([^,]*)/g),re=te.match(/user-scalable\s*=\s*([^,]*)/g);ne[1]&&(K=ne[1]),ae[1]&&(V=ae[1]),ie[1]&&(J=ie[1]),le[1]&&(Q=le[1]),oe[1]&&(G=oe[1]),re[1]&&(Z=re[1])}return D&&(ee+='width='+(D.width||K),ee+=', height='+(D.height||V),(D.scale||J)&&(ee+=', initial-scale='+(D.scale||J)),(D.scalable||Z)&&(ee+=', minimum-scale='+(D.scale||Q),ee+=', maximum-scale='+(D.scale||G),ee+=', user-scalable='+(D.scalable||Z)),!$&&($=this.document.createElement('meta'),$.setAttribute('name','viewport'),this.document.querySelector('head').appendChild($)),$.setAttribute('content',ee)),{width:parseInt(K),height:parseInt(V)}}},{key:'expand',value:function(){this.emit('expand')}},{key:'listeners',value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),this.resizeListeners(),this.linksHandler()}},{key:'removeListeners',value:function(){this.removeEventListeners(),this.removeSelectionListeners(),clearTimeout(this.expanding)}},{key:'resizeListeners',value:function(){var D,U;clearTimeout(this.expanding),D=this.scrollWidth(),U=this.scrollHeight(),(D!=this._size.width||U!=this._size.height)&&(this._size={width:D,height:U},this.pane&&this.pane.render(),this.emit('resize',this._size)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:'mediaQueryListeners',value:function(){for(var D=this.document.styleSheets,U=function(Y){Y.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),I=0;I<D.length;I+=1){var H;try{H=D[I].cssRules}catch(Y){return}if(!H)return;for(var F=0;F<H.length;F+=1)if(H[F].media){var X=this.window.matchMedia(H[F].media.mediaText);X.addListener(U)}}}},{key:'observe',value:function(D){var U=this,I=new MutationObserver(function(){U._expanding&&U.expand()});return I.observe(D,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),I}},{key:'imageLoadListeners',value:function(){for(var I,U=this.document.querySelectorAll('img'),H=0;H<U.length;H++)I=U[H],'undefined'!=typeof I.naturalWidth&&0===I.naturalWidth&&(I.onload=this.expand.bind(this))}},{key:'fontLoadListeners',value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.expand()}.bind(this))}},{key:'root',value:function(){return this.document?this.document.documentElement:null}},{key:'locationOf',value:function(D,U){var I,H={left:0,top:0};if(this.document){if(this.epubcfi.isCfiString(D)){var F=new N.default(D).toRange(this.document,U);F&&(F.startContainer.nodeType===Node.ELEMENT_NODE?(I=F.startContainer.getBoundingClientRect(),H.left=I.left,H.top=I.top):F.collapsed?I=F.getClientRects()[0]:I=F.getBoundingClientRect())}else if('string'==typeof D&&-1<D.indexOf('#')){var X=D.substring(D.indexOf('#')+1),Y=this.document.getElementById(X);Y&&(I=Y.getBoundingClientRect())}return I&&(H.left=I.left,H.top=I.top),H}}},{key:'addStylesheet',value:function(D){return new Promise(function(U){var H,F=!1;return this.document?(H=this.document.querySelector('link[href=\''+D+'\']'),H?void U(!0):void(H=this.document.createElement('link'),H.type='text/css',H.rel='stylesheet',H.href=D,H.onload=H.onreadystatechange=function(){var X=this;F||this.readyState&&'complete'!=this.readyState||(F=!0,setTimeout(function(){X.pane&&X.pane.render(),U(!0)},1))},this.document.head.appendChild(H))):void U(!1)}.bind(this))}},{key:'addStylesheetRules',value:function(D){var U,I,H='epubjs-inserted-css';if(this.document&&D&&0!==D.length){if(U=this.document.getElementById('#'+H),U||(U=this.document.createElement('style'),U.id=H),this.document.head.appendChild(U),I=U.sheet,'[object Array]'===Object.prototype.toString.call(D))for(var F=0,X=D.length;F<X;F++){var Y=1,K=D[F],V=D[F][0],J='';'[object Array]'===Object.prototype.toString.call(K[1][0])&&(K=K[1],Y=0);for(var G,Q=K.length;Y<Q;Y++)G=K[Y],J+=G[0]+':'+G[1]+(G[2]?' !important':'')+';\n';I.insertRule(V+'{'+J+'}',I.cssRules.length)}else{var Z=Object.keys(D);Z.forEach(function($){var ee=D[$],te=Object.keys(ee),ne=te.map(function(ae){return ae+':'+ee[ae]}).join(';');I.insertRule($+'{'+ne+'}',I.cssRules.length)})}this.pane&&this.pane.render()}}},{key:'addScript',value:function(D){return new Promise(function(U){var H,F=!1;return this.document?void(H=this.document.createElement('script'),H.type='text/javascript',H.async=!0,H.src=D,H.onload=H.onreadystatechange=function(){F||this.readyState&&'complete'!=this.readyState||(F=!0,setTimeout(function(){U(!0)},1))},this.document.head.appendChild(H)):void U(!1)}.bind(this))}},{key:'addClass',value:function(D){var U;this.document&&(U=this.content||this.document.body,U.classList.add(D))}},{key:'removeClass',value:function(D){var U;this.document&&(U=this.content||this.document.body,U.classList.remove(D))}},{key:'addEventListeners',value:function(){this.document&&B.forEach(function(D){this.document.addEventListener(D,this.triggerEvent.bind(this),!1)},this)}},{key:'removeEventListeners',value:function(){this.document&&B.forEach(function(D){this.document.removeEventListener(D,this.triggerEvent,!1)},this)}},{key:'triggerEvent',value:function(D){this.emit(D.type,D)}},{key:'addSelectionListeners',value:function(){this.document&&this.document.addEventListener('selectionchange',this.onSelectionChange.bind(this),!1)}},{key:'removeSelectionListeners',value:function(){this.document&&this.document.removeEventListener('selectionchange',this.onSelectionChange,!1)}},{key:'onSelectionChange',value:function(){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var U=this.window.getSelection();this.triggerSelectedEvent(U)}.bind(this),250)}},{key:'triggerSelectedEvent',value:function(D){var U,I;D&&0<D.rangeCount&&(U=D.getRangeAt(0),!U.collapsed&&(I=new N.default(U,this.cfiBase).toString(),this.emit('selected',I),this.emit('selectedRange',U)))}},{key:'range',value:function(D,U){var I=new N.default(D);return I.toRange(this.document,U)}},{key:'cfiFromRange',value:function(D,U){return new N.default(D,this.cfiBase,U).toString()}},{key:'cfiFromNode',value:function(D,U){return new N.default(D,this.cfiBase,U).toString()}},{key:'map',value:function(D){var W=new L.default(D);return W.section()}},{key:'size',value:function(D,U){0<=D&&this.width(D),0<=U&&this.height(U),this.css('margin','0'),this.css('box-sizing','border-box')}},{key:'columns',value:function(D,U,I,H){var F=(0,T.prefixed)('column-axis'),X=(0,T.prefixed)('column-gap'),Y=(0,T.prefixed)('column-width'),K=(0,T.prefixed)('column-fill');this.width(D),this.height(U),this.viewport({width:D,height:U,scale:1,scalable:'no'}),this.css('overflow-y','hidden'),this.css('margin','0',!0),this.css('padding','0',!0),this.css('box-sizing','border-box'),this.css('max-width','inherit'),this.css(F,'horizontal'),this.css(K,'auto'),this.css(X,H+'px'),this.css(Y,I+'px')}},{key:'scaler',value:function(D,U,I){var F='';this.css('transform-origin','top left'),(0<=U||0<=I)&&(F=' translate('+(U||0)+'px, '+(I||0)+'px )'),this.css('transform','scale('+D+')'+F)}},{key:'fit',value:function(D,U){var I=this.viewport(),H=D/I.width,F=U/I.height,X=H<F?H:F,Y=(U-I.height*X)/2;this.width(D),this.height(U),this.overflow('hidden'),this.viewport({scale:1}),this.scaler(X,0,Y),this.css('background-color','transparent')}},{key:'mapPage',value:function(D,U,I,H,F){var X=new L.default(U,F);return X.page(this,D,I,H)}},{key:'linksHandler',value:function(){var D=this;(0,P.replaceLinks)(this.content,function(U){D.emit('link',U)})}},{key:'highlight',value:function(D){var U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},I=arguments[2],H=this.range(D);U.epubcfi=D,this.pane||(this.pane=new O.Pane(this.content,this.document.body));var F=new O.Highlight(H,'epubjs-hl',U,{fill:'yellow','fill-opacity':'0.3','mix-blend-mode':'multiply'}),X=this.pane.addMark(F);return I&&X.element.addEventListener('click',I),X}},{key:'underline',value:function(D){var U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},I=arguments[2],H=this.range(D);U.epubcfi=D,this.pane||(this.pane=new O.Pane(this.content,this.document.body));var F=new O.Underline(H,'epubjs-ul',U,{stroke:'black','stroke-opacity':'0.3','mix-blend-mode':'multiply'}),X=this.pane.addMark(F);return I&&X.element.addEventListener('click',I),X}},{key:'mark',value:function(D){var U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},I=arguments[2],H=this.range(D),F=H.commonAncestorContainer,X=1===F.nodeType?F:F.parentNode;X.setAttribute('ref','epubjs-mk'),X.dataset.epubcfi=D,U&&Object.entries(U).forEach(function(Y){var K=C(Y,2),V=K[0],J=K[1];X.dataset[V]=J}),I&&X.addEventListener('click',I)}},{key:'destroy',value:function(){this.observer&&this.observer.disconnect(),this.removeListeners()}}],[{key:'listenedEvents',get:function(){return B}}]),M}();(0,_.default)(z.prototype),p.default=z,u.exports=p['default']},function(u,p,f){'use strict';function k(T,R){if(!(T instanceof R))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function T(R,N){for(var L,A=0;A<N.length;A++)L=N[A],L.enumerable=L.enumerable||!1,L.configurable=!0,'value'in L&&(L.writable=!0),Object.defineProperty(R,L.key,L)}return function(R,N,A){return N&&T(R.prototype,N),A&&T(R,A),R}}(),E=f(1),S=function(T){return T&&T.__esModule?T:{default:T}}(E),_=function(){function T(R,N){k(this,T),this.layout=R,this.horizontal='paginated'===this.layout.flow,this._dev=N}return C(T,[{key:'section',value:function(N){var A=this.findRanges(N),L=this.rangeListToCfiList(N.section.cfiBase,A);return L}},{key:'page',value:function(N,A,L,P){var B,O=N&&N.document&&N.document.body;if(O){if(B=this.rangePairToCfiPair(A,{start:this.findStart(O,L,P),end:this.findEnd(O,L,P)}),!0===this._dev){var z=N.document,M=new S.default(B.start).toRange(z),W=new S.default(B.end).toRange(z),D=z.defaultView.getSelection(),U=z.createRange();D.removeAllRanges(),U.setStart(M.startContainer,M.startOffset),U.setEnd(W.endContainer,W.endOffset),D.addRange(U)}return B}}},{key:'walk',value:function(N,A){for(var P,O,L=document.createTreeWalker(N,NodeFilter.SHOW_TEXT,{acceptNode:function(z){return 0<z.data.trim().length?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);(P=L.nextNode())&&(O=A(P),!O););return O}},{key:'findRanges',value:function(N){for(var M,W,A=[],L=N.contents.scrollWidth(),P=Math.ceil(L/this.layout.spreadWidth),O=P*this.layout.divisor,B=this.layout.columnWidth,z=this.layout.gap,D=0;D<O.pages;D++)M=(B+z)*D,W=B*(D+1)+z*D,A.push({start:this.findStart(N.document.body,M,W),end:this.findEnd(N.document.body,M,W)});return A}},{key:'findStart',value:function(N,A,L){for(var B,z,P=this,O=[N],M=N;O.length;)if(B=O.shift(),z=this.walk(B,function(W){var D,U,I,H;return(W.nodeType==Node.TEXT_NODE?(H=document.createRange(),H.selectNodeContents(W),I=H.getBoundingClientRect()):I=W.getBoundingClientRect(),D=P.horizontal?I.left:I.top,U=P.horizontal?I.right:I.bottom,D>=A&&D<=L)?W:U>A?W:void(M=W,O.push(W))}),z)return this.findTextStartRange(z,A,L);return this.findTextStartRange(M,A,L)}},{key:'findEnd',value:function(N,A,L){for(var B,M,P=this,O=[N],z=N;O.length;)if(B=O.shift(),M=this.walk(B,function(W){var D,U,I,H;return(W.nodeType==Node.TEXT_NODE?(H=document.createRange(),H.selectNodeContents(W),I=H.getBoundingClientRect()):I=W.getBoundingClientRect(),D=P.horizontal?I.left:I.top,U=P.horizontal?I.right:I.bottom,D>L&&z)?z:U>L?W:void(z=W,O.push(W))}),M)return this.findTextEndRange(M,A,L);return this.findTextEndRange(z,A,L)}},{key:'findTextStartRange',value:function(N,A){for(var O,B,z,P=this.splitTextNodeIntoRanges(N),M=0;M<P.length;M++)if(O=P[M],B=O.getBoundingClientRect(),z=this.horizontal?B.left:B.top,z>=A)return O;return P[0]}},{key:'findTextEndRange',value:function(N,A,L){for(var O,B,z,M,W,P=this.splitTextNodeIntoRanges(N),D=0;D<P.length;D++){if(B=P[D],z=B.getBoundingClientRect(),M=this.horizontal?z.left:z.top,W=this.horizontal?z.right:z.bottom,M>L&&O)return O;if(W>L)return B;O=B}return P[P.length-1]}},{key:'splitTextNodeIntoRanges',value:function(N,A){var B,L=[],P=N.textContent||'',O=P.trim(),z=N.ownerDocument,M=A||' ',W=O.indexOf(M);if(-1===W||N.nodeType!=Node.TEXT_NODE)return B=z.createRange(),B.selectNodeContents(N),[B];for(B=z.createRange(),B.setStart(N,0),B.setEnd(N,W),L.push(B),B=!1;-1!=W;)W=O.indexOf(M,W+1),0<W&&(B&&(B.setEnd(N,W),L.push(B)),B=z.createRange(),B.setStart(N,W+1));return B&&(B.setEnd(N,O.length),L.push(B)),L}},{key:'rangePairToCfiPair',value:function(N,A){var L=A.start,P=A.end;L.collapse(!0),P.collapse(!1);var O=new S.default(L,N).toString(),B=new S.default(P,N).toString();return{start:O,end:B}}},{key:'rangeListToCfiList',value:function(N,A){for(var P,L=[],O=0;O<A.length;O++)P=this.rangePairToCfiPair(N,A[O]),L.push(P);return L}}]),T}();p.default=_,u.exports=p['default']},function(u,p,f){'use strict';function k(T,R){if(!(T instanceof R))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function T(R,N){for(var L,A=0;A<N.length;A++)L=N[A],L.enumerable=L.enumerable||!1,L.configurable=!0,'value'in L&&(L.writable=!0),Object.defineProperty(R,L.key,L)}return function(R,N,A){return N&&T(R.prototype,N),A&&T(R,A),R}}(),E=f(2),S=function(T){return T&&T.__esModule?T:{default:T}}(E),_=function(){function T(R){k(this,T);var N,A;N=R.indexOf('://'),-1<N&&(R=new URL(R).pathname),A=this.parse(R),this.path=R,this.directory=this.isDirectory(R)?R:A.dir+'/',this.filename=A.base,this.extension=A.ext.slice(1)}return C(T,[{key:'parse',value:function(N){return S.default.parse(N)}},{key:'isAbsolute',value:function(N){return S.default.isAbsolute(N||this.path)}},{key:'isDirectory',value:function(N){return'/'===N.charAt(N.length-1)}},{key:'resolve',value:function(N){return S.default.resolve(this.directory,N)}},{key:'relative',value:function(N){return S.default.relative(this.directory,N)}},{key:'splitPath',value:function(N){return this.splitPathRe.exec(N).slice(1)}},{key:'toString',value:function(){return this.path}}]),T}();p.default=_,u.exports=p['default']},function(u,p,f){'use strict';Object.defineProperty(p,'__esModule',{value:!0}),p.replaceBase=function(N,A){var L,P;N&&(P=(0,_.qs)(N,'head'),L=(0,_.qs)(P,'base'),!L&&(L=N.createElement('base'),P.insertBefore(L,P.firstChild)),L.setAttribute('href',A.url))},p.replaceCanonical=function(N,A){var L,P,O=A.url;N&&(L=(0,_.qs)(N,'head'),P=(0,_.qs)(L,'link[rel=\'canonical\']'),P?P.setAttribute('href',O):(P=N.createElement('link'),P.setAttribute('rel','canonical'),P.setAttribute('href',O),L.appendChild(P)))},p.replaceLinks=function(N,A){for(var L=N.querySelectorAll('a[href]'),P=(0,_.qs)(N.ownerDocument,'base'),O=P?P.href:void 0,B=function(M){var W=M.getAttribute('href');if(0!==W.indexOf('mailto:')){var D=-1<W.indexOf('://'),U=new R.default(W,O);D?M.setAttribute('target','_blank'):M.onclick=function(){return U&&U.hash?A(U.Path.path+U.hash):U?A(U.Path.path):A(W),!1}}}.bind(this),z=0;z<L.length;z++)B(L[z])},p.substitute=function(N,A,L){return A.forEach(function(P,O){P&&L[O]&&(N=N.replace(new RegExp(P,'g'),L[O]))}),N};var _=f(0),T=f(7),R=function(N){return N&&N.__esModule?N:{default:N}}(T)},function(u,p,f){'use strict';function v(N){return N&&N.__esModule?N:{default:N}}function k(N,A){if(!(N instanceof A))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function N(A,L){for(var O,P=0;P<L.length;P++)O=L[P],O.enumerable=O.enumerable||!1,O.configurable=!0,'value'in O&&(O.writable=!0),Object.defineProperty(A,O.key,O)}return function(A,L,P){return L&&N(A.prototype,L),P&&N(A,P),A}}(),E=f(5),S=v(E),_=f(2),T=v(_),R=function(){function N(A,L){k(this,N);var P=-1<A.indexOf('://'),O=A;if(this.Url=void 0,this.href=A,this.protocol='',this.origin='',this.hash='',this.hash='',this.search='',this.base=L,!P&&!1!==L&&'string'!=typeof L&&window&&window.location&&(this.base=window.location.href),P||this.base)try{this.Url=this.base?new URL(A,this.base):new URL(A),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,O=this.Url.pathname}catch(B){this.Url=void 0}this.Path=new S.default(O),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}return C(N,[{key:'path',value:function(){return this.Path}},{key:'resolve',value:function(L){var O,P=-1<L.indexOf('://');return P?L:(O=T.default.resolve(this.directory,L),this.origin+O)}},{key:'relative',value:function(L){return T.default.relative(L,this.directory)}},{key:'toString',value:function(){return this.href}}]),N}();p.default=R,u.exports=p['default']},function(u,p,f){'use strict';var A,L,P,O,B,z,M,v=f(9),k=f(18),C=Function.prototype.apply,E=Function.prototype.call,S=Object.create,_=Object.defineProperty,T=Object.defineProperties,R=Object.prototype.hasOwnProperty,N={configurable:!0,enumerable:!1,writable:!0};A=function(W,D){var U;return k(D),R.call(this,'__ee__')?U=this.__ee__:(U=N.value=S(null),_(this,'__ee__',N),N.value=null),U[W]?'object'==typeof U[W]?U[W].push(D):U[W]=[U[W],D]:U[W]=D,this},L=function(W,D){var U,I;return k(D),I=this,A.call(this,W,U=function(){P.call(I,W,U),C.call(D,this,arguments)}),U.__eeOnceListener__=D,this},P=function(W,D){var U,I,H,F;if(k(D),!R.call(this,'__ee__'))return this;if(U=this.__ee__,!U[W])return this;if(I=U[W],'object'==typeof I)for(F=0;H=I[F];++F)(H===D||H.__eeOnceListener__===D)&&(2===I.length?U[W]=I[F?0:1]:I.splice(F,1));else(I===D||I.__eeOnceListener__===D)&&delete U[W];return this},O=function(W){var D,U,I,H,F;if(R.call(this,'__ee__')&&(H=this.__ee__[W],!!H))if('object'==typeof H){for(U=arguments.length,F=Array(U-1),D=1;D<U;++D)F[D-1]=arguments[D];for(H=H.slice(),D=0;I=H[D];++D)C.call(I,this,F)}else switch(arguments.length){case 1:E.call(H,this);break;case 2:E.call(H,this,arguments[1]);break;case 3:E.call(H,this,arguments[1],arguments[2]);break;default:for(U=arguments.length,F=Array(U-1),D=1;D<U;++D)F[D-1]=arguments[D];C.call(H,this,F);}},B={on:A,once:L,off:P,emit:O},z={on:v(A),once:v(L),off:v(P),emit:v(O)},M=T({},z),u.exports=p=function(W){return null==W?S(M):T(Object(W),z)},p.methods=B},function(u,p,f){'use strict';var S,v=f(10),k=f(17),C=f(13),E=f(20);S=u.exports=function(_,T){var R,N,A,L,P;return 2>arguments.length||'string'!=typeof _?(L=T,T=_,_=null):L=arguments[2],null==_?(R=A=!0,N=!1):(R=E.call(_,'c'),N=E.call(_,'e'),A=E.call(_,'w')),P={value:T,configurable:R,enumerable:N,writable:A},L?v(k(L),P):P},S.gs=function(_,T,R){var N,A,L,P;return'string'==typeof _?L=arguments[3]:(L=R,R=T,T=_,_=null),null==T?T=void 0:C(T)?null==R?R=void 0:!C(R)&&(L=R,R=void 0):(L=T,T=R=void 0),null==_?(N=!0,A=!1):(N=E.call(_,'c'),A=E.call(_,'e')),P={get:T,set:R,configurable:N,enumerable:A},L?v(k(L),P):P}},function(u,p,f){'use strict';u.exports=f(11)()?Object.assign:f(12)},function(u){'use strict';u.exports=function(){var k,v=Object.assign;return!('function'!=typeof v)&&(k={foo:'raz'},v(k,{bar:'dwa'},{trzy:'trzy'}),'razdwatrzy'===k.foo+k.bar+k.trzy)}},function(u,p,f){'use strict';var v=f(14),k=f(19);u.exports=function(E,S){var _,T,N,R=_Mathmax(arguments.length,2);for(E=Object(k(E)),N=function(A){try{E[A]=S[A]}catch(L){_||(_=L)}},T=1;T<R;++T)S=arguments[T],v(S).forEach(N);if(_!==void 0)throw _;return E}},function(u){'use strict';u.exports=function(v){return'function'==typeof v}},function(u,p,f){'use strict';u.exports=f(15)()?Object.keys:f(16)},function(u){'use strict';u.exports=function(){try{return Object.keys('primitive'),!0}catch(v){return!1}}},function(u){'use strict';var v=Object.keys;u.exports=function(k){return v(null==k?k:Object(k))}},function(u){'use strict';var v=Array.prototype.forEach,k=Object.create,C=function(E,S){for(var _ in E)S[_]=E[_]};u.exports=function(){var S=k(null);return v.call(arguments,function(_){null==_||C(Object(_),S)}),S}},function(u){'use strict';u.exports=function(v){if('function'!=typeof v)throw new TypeError(v+' is not a function');return v}},function(u){'use strict';u.exports=function(v){if(null==v)throw new TypeError('Cannot use null or undefined');return v}},function(u,p,f){'use strict';u.exports=f(21)()?_Stringprototype.contains:f(22)},function(u){'use strict';var v='razdwatrzy';u.exports=function(){return!('function'!=typeof v.contains)&&!0===v.contains('dwa')&&!1===v.contains('foo')}},function(u){'use strict';var v=_Stringprototype.indexOf;u.exports=function(k){return-1<v.call(this,k,arguments[1])}},function(u,p){'use strict';function k(E){var S=Object.assign({},E,{bubbles:!1});try{return new MouseEvent(E.type,S)}catch(T){var _=document.createEvent('MouseEvents');return _.initMouseEvent(E.type,!1,S.cancelable,S.view,S.detail,S.screenX,S.screenY,S.clientX,S.clientY,S.ctrlKey,S.altKey,S.shiftKey,S.metaKey,S.button,S.relatedTarget),_}}function C(E,S,_){function T(P,O,B){var z=P.top+P.height,M=P.left+P.width;return P.top<=B&&P.left<=O&&z>B&&M>O}var R=E.getBoundingClientRect();if(!T(R,S,_))return!1;for(var N=E.getClientRects(),A=0,L=N.length;A<L;A++)if(T(N[A],S,_))return!0;return!1}p.a={proxyMouse:function(E,S){function _(R){for(var A,N=S.length-1;0<=N;N--)if(A=S[N],!!C(A,R.clientX,R.clientY)){A.dispatchEvent(k(R));break}}for(var T of['mouseup','mousedown','click'])E.addEventListener(T,(R)=>_(R),!1)}}},function(u,p,f){'use strict';function v(A){var L=A.getBoundingClientRect();return{top:L.top+A.ownerDocument.body.scrollTop,left:L.left+A.ownerDocument.body.scrollLeft,height:L.height+A.scrollHeight,width:L.width+A.scrollWidth}}function k(A,L){A.style.top=`${L.top}px`,A.style.left=`${L.left}px`,A.style.height=`${L.height}px`,A.style.width=`${L.width}px`}function C(A,L){return L.right<=A.right&&L.left>=A.left&&L.top>=A.top&&L.bottom<=A.bottom}Object.defineProperty(p,'__esModule',{value:!0});var E=f(25),S=f(23);p.Pane=class{constructor(A,L=document.body){this.target=A,this.element=E.a.createElement('svg'),this.marks=[],this.element.style.position='absolute',this.element.setAttribute('pointer-events','none'),S.a.proxyMouse(this.target,this.marks),L.appendChild(this.element),this.render()}addMark(A){var L=E.a.createElement('g');return this.element.appendChild(L),A.bind(L),this.marks.push(A),A.render(),A}removeMark(A){var L=this.marks.indexOf(A);if(-1!==L){var P=A.unbind();this.element.removeChild(P),this.marks.splice(L,1)}}render(){k(this.element,v(this.target));for(var A of this.marks)A.render()}};class T{constructor(){this.element=null}bind(A){this.element=A}unbind(){var A=this.element;return this.element=null,A}render(){}dispatchEvent(A){this.element&&this.element.dispatchEvent(A)}getBoundingClientRect(){return this.element.getBoundingClientRect()}getClientRects(){for(var A=[],L=this.element.firstChild;L;)A.push(L.getBoundingClientRect()),L=L.nextSibling;return A}filteredRanges(){var A=Array.from(this.range.getClientRects());return A.filter((L)=>{for(var P=0;P<A.length;P++){if(A[P]===L)return!0;let O=C(A[P],L);if(O)return!1}return!0})}}p.Mark=T;class R extends T{constructor(A,L,P,O){super(),this.range=A,this.className=L,this.data=P||{},this.attributes=O||{}}bind(A){for(var L in super.bind(A),this.data)this.data.hasOwnProperty(L)&&(this.element.dataset[L]=this.data[L]);for(var L in this.attributes)this.attributes.hasOwnProperty(L)&&this.element.setAttribute(L,this.attributes[L]);this.className&&this.element.classList.add(this.className)}render(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var A=this.element.ownerDocument.createDocumentFragment(),L=this.filteredRanges(),P=this.element.getBoundingClientRect(),O=0,B=L.length;O<B;O++){var z=L[O],M=E.a.createElement('rect');M.setAttribute('x',z.left-P.left),M.setAttribute('y',z.top-P.top),M.setAttribute('height',z.height),M.setAttribute('width',z.width),A.appendChild(M)}this.element.appendChild(A)}}p.Highlight=R;p.Underline=class extends R{constructor(A,L,P,O){super(A,L,P,O)}render(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var A=this.element.ownerDocument.createDocumentFragment(),L=this.filteredRanges(),P=this.element.getBoundingClientRect(),O=0,B=L.length;O<B;O++){var z=L[O],M=E.a.createElement('rect');M.setAttribute('x',z.left-P.left),M.setAttribute('y',z.top-P.top),M.setAttribute('height',z.height),M.setAttribute('width',z.width),M.setAttribute('fill','none');var W=E.a.createElement('line');W.setAttribute('x1',z.left-P.left),W.setAttribute('x2',z.left-P.left+z.width),W.setAttribute('y1',z.top-P.top+z.height-1),W.setAttribute('y2',z.top-P.top+z.height-1),W.setAttribute('stroke-width',1),W.setAttribute('stroke','black'),W.setAttribute('stroke-linecap','square'),A.appendChild(M),A.appendChild(W)}this.element.appendChild(A)}}},function(u,p){'use strict';p.a={createElement:function(k){return document.createElementNS('http://www.w3.org/2000/svg',k)}}},function(u,p,f){var v=f(3);u.exports=v},function(u){function f(){throw new Error('setTimeout has not been defined')}function v(){throw new Error('clearTimeout has not been defined')}function k(z){if(N===setTimeout)return setTimeout(z,0);if((N===f||!N)&&setTimeout)return N=setTimeout,setTimeout(z,0);try{return N(z,0)}catch(M){try{return N.call(null,z,0)}catch(W){return N.call(this,z,0)}}}function C(z){if(A===clearTimeout)return clearTimeout(z);if((A===v||!A)&&clearTimeout)return A=clearTimeout,clearTimeout(z);try{return A(z)}catch(M){try{return A.call(null,z)}catch(W){return A.call(this,z)}}}function E(){P&&O&&(P=!1,O.length?L=O.concat(L):B=-1,L.length&&S())}function S(){if(!P){var z=k(E);P=!0;for(var M=L.length;M;){for(O=L,L=[];++B<M;)O&&O[B].run();B=-1,M=L.length}O=null,P=!1,C(z)}}function _(z,M){this.fun=z,this.array=M}function T(){}var R=u.exports={},N,A;(function(){try{N='function'==typeof setTimeout?setTimeout:f}catch(z){N=f}try{A='function'==typeof clearTimeout?clearTimeout:v}catch(z){A=v}})();var L=[],P=!1,O,B=-1;R.nextTick=function(z){var M=Array(arguments.length-1);if(1<arguments.length)for(var W=1;W<arguments.length;W++)M[W-1]=arguments[W];L.push(new _(z,M)),1!==L.length||P||k(S)},_.prototype.run=function(){this.fun.apply(null,this.array)},R.title='browser',R.browser=!0,R.env={},R.argv=[],R.version='',R.versions={},R.on=T,R.addListener=T,R.once=T,R.off=T,R.removeListener=T,R.removeAllListeners=T,R.emit=T,R.binding=function(){throw new Error('process.binding is not supported')},R.cwd=function(){return'/'},R.chdir=function(){throw new Error('process.chdir is not supported')},R.umask=function(){return 0}},function(u){u.exports=s}])});