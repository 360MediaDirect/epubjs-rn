var _Stringprototype=String.prototype,_Mathmax=Math.max,_Mathfloor=Math.floor;(function(u,p){'object'==typeof exports&&'object'==typeof module?module.exports=p(require('xmldom')):'function'==typeof define&&define.amd?define(['xmldom'],p):'object'==typeof exports?exports.EPUBJSContents=p(require('xmldom')):u.EPUBJSContents=p(u.xmldom)})(this,function(s){return function(u){function p(v){if(f[v])return f[v].exports;var k=f[v]={i:v,l:!1,exports:{}};return u[v].call(k.exports,k,k.exports,p),k.l=!0,k.exports}var f={};return p.m=u,p.c=f,p.i=function(v){return v},p.d=function(v,k,C){p.o(v,k)||Object.defineProperty(v,k,{configurable:!1,enumerable:!0,get:C})},p.n=function(v){var k=v&&v.__esModule?function(){return v['default']}:function(){return v};return p.d(k,'a',k),k},p.o=function(v,k){return Object.prototype.hasOwnProperty.call(v,k)},p.p='',p(p.s=26)}([function(u,p,f){'use strict';function v(pe,fe){if(!(pe instanceof fe))throw new TypeError('Cannot call a class as a function')}function C(){var pe=new Date().getTime(),fe='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(he){var ge=0|(pe+16*Math.random())%16;return pe=_Mathfloor(pe/16),('x'==he?ge:8|7&ge).toString(16)});return fe}function S(pe){return!isNaN(parseFloat(pe))&&isFinite(pe)}function L(pe,fe,he,ge,me){var ke,ye=ge||0,be=me||fe.length,ve=parseInt(ye+(be-ye)/2);return(he||(he=function(Ce,we){return Ce>we?1:Ce<we?-1:Ce==we?0:void 0}),0>=be-ye)?ve:(ke=he(fe[ve],pe),1==be-ye?0<ke?ve:ve+1:0===ke?ve:-1===ke?L(pe,fe,he,ve,be):L(pe,fe,he,ye,ve))}function P(pe,fe,he,ge,me){var ke,ye=ge||0,be=me||fe.length,ve=parseInt(ye+(be-ye)/2);return(he||(he=function(Ce,we){return Ce>we?1:Ce<we?-1:Ce==we?0:void 0}),0>=be-ye)?-1:(ke=he(fe[ve],pe),1==be-ye?0===ke?ve:-1:0===ke?ve:-1===ke?P(pe,fe,he,ve,be):P(pe,fe,he,ye,ve))}function W(pe,fe){for(var me,he=pe.parentNode,ge=he.childNodes,ye=-1,be=0;be<ge.length&&(me=ge[be],me.nodeType===fe&&ye++,me!=pe);be++);return ye}function I(pe,fe){return new Blob([pe],{type:fe})}function Q(pe,fe){return'undefined'==typeof pe.querySelector?pe.getElementsByTagName(fe):pe.querySelectorAll(fe)}function Z(pe,fe,he){for(var me,ge=document.createTreeWalker(pe,he,null,!1);me=ge.nextNode();)fe(me)}function $(pe,fe){if(fe(pe))return!0;if(pe=pe.firstChild,pe)do{var he=$(pe,fe);if(he)return!0;pe=pe.nextSibling}while(pe)}function ie(pe){for(var fe=[pe];pe;pe=pe.parentNode)fe.unshift(pe);return fe}Object.defineProperty(p,'__esModule',{value:!0});var le=function(){function pe(fe,he){for(var me,ge=0;ge<he.length;ge++)me=he[ge],me.enumerable=me.enumerable||!1,me.configurable=!0,'value'in me&&(me.writable=!0),Object.defineProperty(fe,me.key,me)}return function(fe,he,ge){return he&&pe(fe.prototype,he),ge&&pe(fe,ge),fe}}();p.isElement=function(pe){return!!(pe&&1==pe.nodeType)},p.uuid=C,p.documentHeight=function(){return _Mathmax(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},p.isNumber=S,p.isFloat=function(pe){return S(pe)&&_Mathfloor(pe)!==pe},p.prefixed=function(pe){var fe=['-Webkit-','-moz-','-o-','-ms-'],he=pe[0].toUpperCase()+pe.slice(1),ge=fe.length;if('undefined'==typeof document||'undefined'!=typeof document.body.style[pe])return pe;for(var me=0;me<ge;me++)if('undefined'!=typeof document.body.style[fe[me]+he])return fe[me]+he;return pe},p.defaults=function(pe){for(var ge,fe=1,he=arguments.length;fe<he;fe++)for(var me in ge=arguments[fe],ge)void 0===pe[me]&&(pe[me]=ge[me]);return pe},p.extend=function(pe){var fe=[].slice.call(arguments,1);return fe.forEach(function(he){he&&Object.getOwnPropertyNames(he).forEach(function(ge){Object.defineProperty(pe,ge,Object.getOwnPropertyDescriptor(he,ge))})}),pe},p.insert=function(pe,fe,he){var ge=L(pe,fe,he);return fe.splice(ge,0,pe),ge},p.locationOf=L,p.indexOfSorted=P,p.bounds=function(pe){var fe=window.getComputedStyle(pe),me=0,ye=0;return['width','paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(be){me+=parseFloat(fe[be])||0}),['height','paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(be){ye+=parseFloat(fe[be])||0}),{height:ye,width:me}},p.borders=function(pe){var fe=window.getComputedStyle(pe),me=0,ye=0;return['paddingRight','paddingLeft','marginRight','marginLeft','borderRightWidth','borderLeftWidth'].forEach(function(be){me+=parseFloat(fe[be])||0}),['paddingTop','paddingBottom','marginTop','marginBottom','borderTopWidth','borderBottomWidth'].forEach(function(be){ye+=parseFloat(fe[be])||0}),{height:ye,width:me}},p.windowBounds=function(){var pe=window.innerWidth,fe=window.innerHeight;return{top:0,left:0,right:pe,bottom:fe,width:pe,height:fe}},p.cleanStringForXpath=function(pe){var fe=pe.match(/[^'"]+|['"]/g);return fe=fe.map(function(he){return'\''===he?'"\'"':'"'===he?'\'"\'':'\''+he+'\''}),'concat(\'\','+fe.join(',')+')'},p.indexOfNode=W,p.indexOfTextNode=function(pe){return W(pe,se)},p.indexOfElementNode=function(pe){return W(pe,re)},p.isXml=function(pe){return-1<['xml','opf','ncx'].indexOf(pe)},p.createBlob=I,p.createBlobUrl=function(pe,fe){var ge,he=window.URL||window.webkitURL||window.mozURL,me=I(pe,fe);return ge=he.createObjectURL(me),ge},p.createBase64Url=function(pe,fe){var he,ge;if('string'==typeof pe)return he=btoa(pe),ge='data:'+fe+';base64,'+he,ge},p.type=function(pe){return Object.prototype.toString.call(pe).slice(8,-1)},p.parse=function(pe,fe,he){var ge,me;return me='undefined'==typeof DOMParser||he?f(28).DOMParser:DOMParser,65279===pe.charCodeAt(0)&&(pe=pe.slice(1)),ge=new me().parseFromString(pe,fe),ge},p.qs=function(pe,fe){var he;if(!pe)throw new Error('No Element Provided');return'undefined'==typeof pe.querySelector?(he=pe.getElementsByTagName(fe),he.length)?he[0]:void 0:pe.querySelector(fe)},p.qsa=Q,p.qsp=function(pe,fe,he){var ge,me;if('undefined'!=typeof pe.querySelector){for(var ye in fe+='[',he)fe+=ye+'=\''+he[ye]+'\'';return fe+=']',pe.querySelector(fe)}return(ge=pe.getElementsByTagName(fe),me=Array.prototype.slice.call(ge,0).filter(function(be){for(var ve in he)if(be.getAttribute(ve)===he[ve])return!0;return!1}),me)?me[0]:void 0},p.sprint=function(pe,fe){var he=pe.ownerDocument||pe;'undefined'==typeof he.createTreeWalker?$(pe,function(ge){ge&&3===ge.nodeType&&fe(ge)},!0):Z(pe,fe,NodeFilter.SHOW_TEXT)},p.treeWalker=Z,p.walk=$,p.blob2base64=function(pe){return new Promise(function(fe){var ge=new FileReader;ge.readAsDataURL(pe),ge.onloadend=function(){fe(ge.result)}})},p.defer=function(){var pe=this;this.resolve=null,this.reject=null,this.id=C(),this.promise=new Promise(function(fe,he){pe.resolve=fe,pe.reject=he}),Object.freeze(this)},p.querySelectorByType=function(pe,fe,he){var ge;if('undefined'!=typeof pe.querySelector&&(ge=pe.querySelector(fe+'[*|type="'+he+'"]')),!ge||0===ge.length){ge=Q(pe,fe);for(var me=0;me<ge.length;me++)if(ge[me].getAttributeNS('http://www.idpf.org/2007/ops','type')===he)return ge[me]}else return ge},p.findChildren=function(pe){for(var me,fe=[],he=pe.childNodes,ge=0;ge<he.length;ge++)me=he[ge],1===me.nodeType&&fe.push(me);return fe},p.parents=ie;var oe=p.requestAnimationFrame='undefined'!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),re=1,se=3,ce=p.RangeObject=function(){function pe(){v(this,pe),this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}return le(pe,[{key:'setStart',value:function(he,ge){this.startContainer=he,this.startOffset=ge,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}},{key:'setEnd',value:function(he,ge){this.endContainer=he,this.endOffset=ge,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}},{key:'collapse',value:function(he){this.collapsed=!0,he?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}},{key:'selectNode',value:function(he){var ge=he.parentNode,me=Array.prototype.indexOf.call(ge.childNodes,he);this.setStart(ge,me),this.setEnd(ge,me+1)}},{key:'selectNodeContents',value:function(he){var ge=he.childNodes[he.childNodes-1],me=3===he.nodeType?he.textContent.length:parent.childNodes.length;this.setStart(he,0),this.setEnd(he,me)}},{key:'_commonAncestorContainer',value:function(he,ge){var me=ie(he||this.startContainer),ye=ie(ge||this.endContainer);if(me[0]==ye[0])for(var be=0;be<me.length;be++)if(me[be]!=ye[be])return me[be-1]}},{key:'_checkCollapsed',value:function(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}},{key:'toString',value:function(){}}]),pe}()},function(u,p,f){'use strict';(function(v){function k(R){if('string'!=typeof R)throw new TypeError('Path must be a string. Received '+R)}function C(R,T){for(var L,_='',N=-1,A=0,P=0;P<=R.length;++P){if(P<R.length)L=R.charCodeAt(P);else if(47===L)break;else L=47;if(47===L){if(N==P-1||1==A);else if(N!=P-1&&2==A){if(2>_.length||46!==_.charCodeAt(_.length-1)||46!==_.charCodeAt(_.length-2))if(2<_.length){for(var O=_.length-1,B=O;0<=B&&47!==_.charCodeAt(B);--B);if(B!=O){_=-1==B?'':_.slice(0,B),N=P,A=0;continue}}else if(2===_.length||1===_.length){_='',N=P,A=0;continue}T&&(0<_.length?_+='/..':_='..')}else 0<_.length?_+='/'+R.slice(N+1,P):_=R.slice(N+1,P);N=P,A=0}else 46===L&&-1!=A?++A:A=-1}return _}function E(R,T){var _=T.dir||T.root,N=T.base||(T.name||'')+(T.ext||'');return _?_===T.root?_+N:_+R+N:N}if(!v)var v={cwd:function(){return'/'}};var S={resolve:function(){for(var N,T='',_=!1,A=arguments.length-1;-1<=A&&!_;A--){var L;(0<=A?L=arguments[A]:(void 0==N&&(N=v.cwd()),L=N),k(L),0!==L.length)&&(T=L+'/'+T,_=47===L.charCodeAt(0))}return T=C(T,!_),_?0<T.length?'/'+T:'/':0<T.length?T:'.'},normalize:function(T){if(k(T),0===T.length)return'.';var _=47===T.charCodeAt(0),N=47===T.charCodeAt(T.length-1);return T=C(T,!_),0!==T.length||_||(T='.'),0<T.length&&N&&(T+='/'),_?'/'+T:T},isAbsolute:function(T){return k(T),0<T.length&&47===T.charCodeAt(0)},join:function(){if(0===arguments.length)return'.';for(var T,N,_=0;_<arguments.length;++_)N=arguments[_],k(N),0<N.length&&(void 0==T?T=N:T+='/'+N);return void 0===T?'.':S.normalize(T)},relative:function(T,_){if(k(T),k(_),T===_)return'';if(T=S.resolve(T),_=S.resolve(_),T===_)return'';for(var N=1;N<T.length&&47===T.charCodeAt(N);++N);for(var A=T.length,L=A-N,P=1;P<_.length&&47===_.charCodeAt(P);++P);for(var O=_.length,B=O-P,z=L<B?L:B,M=-1,W=0;W<=z;++W){if(W==z){if(B>z){if(47===_.charCodeAt(P+W))return _.slice(P+W+1);if(0==W)return _.slice(P+W)}else L>z&&(47===T.charCodeAt(N+W)?M=W:0==W&&(M=0));break}var D=T.charCodeAt(N+W),U=_.charCodeAt(P+W);if(D!==U)break;else 47===D&&(M=W)}var H='';for(W=N+M+1;W<=A;++W)(W===A||47===T.charCodeAt(W))&&(H+=0===H.length?'..':'/..');return 0<H.length?H+_.slice(P+M):(P+=M,47===_.charCodeAt(P)&&++P,_.slice(P))},_makeLong:function(T){return T},dirname:function(T){if(k(T),0===T.length)return'.';for(var _=T.charCodeAt(0),N=47===_,A=-1,L=!0,P=T.length-1;1<=P;--P)if(_=T.charCodeAt(P),47!==_)L=!1;else if(!L){A=P;break}return-1===A?N?'/':'.':N&&1===A?'//':T.slice(0,A)},basename:function(T,_){if(_!==void 0&&'string'!=typeof _)throw new TypeError('"ext" argument must be a string');k(T);var N=0,A=-1,L=!0,P;if(void 0!==_&&0<_.length&&_.length<=T.length){if(_.length===T.length&&_===T)return'';var O=_.length-1,B=-1;for(P=T.length-1;0<=P;--P){var z=T.charCodeAt(P);if(47!==z)-1==B&&(L=!1,B=P+1),0<=O&&(z===_.charCodeAt(O)?-1==--O&&(A=P):(O=-1,A=B));else if(!L){N=P+1;break}}return N===A?A=B:-1===A&&(A=T.length),T.slice(N,A)}for(P=T.length-1;0<=P;--P)if(47!==T.charCodeAt(P))-1==A&&(L=!1,A=P+1);else if(!L){N=P+1;break}return-1===A?'':T.slice(N,A)},extname:function(T){k(T);for(var B,_=-1,N=0,A=-1,L=!0,P=0,O=T.length-1;0<=O;--O){if(B=T.charCodeAt(O),47===B){if(!L){N=O+1;break}continue}-1==A&&(L=!1,A=O+1),46===B?-1==_?_=O:1!=P&&(P=1):-1!==_&&(P=-1)}return-1===_||-1===A||0==P||1==P&&_===A-1&&_===N+1?'':T.slice(_,A)},format:function(T){if(null===T||'object'!=typeof T)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof T);return E('/',T)},parse:function(T){k(T);var _={root:'',dir:'',base:'',ext:'',name:''};if(0===T.length)return _;var L,N=T.charCodeAt(0),A=47===N;A?(_.root='/',L=1):L=0;for(var P=-1,O=0,B=-1,z=!0,M=T.length-1,W=0;M>=L;--M){if(N=T.charCodeAt(M),47===N){if(!z){O=M+1;break}continue}-1==B&&(z=!1,B=M+1),46===N?-1==P?P=M:1!=W&&(W=1):-1!=P&&(W=-1)}return-1==P||-1==B||0==W||1==W&&P==B-1&&P==O+1?-1!=B&&(0==O&&A?_.base=_.name=T.slice(1,B):_.base=_.name=T.slice(O,B)):(0==O&&A?(_.name=T.slice(1,P),_.base=T.slice(1,B)):(_.name=T.slice(O,P),_.base=T.slice(O,B)),_.ext=T.slice(P,B)),0<O?_.dir=T.slice(0,O-1):A&&(_.dir='/'),_},sep:'/',delimiter:':',posix:null};u.exports=S}).call(p,f(27))},function(u,p,f){'use strict';function v(A,L){if(!(A instanceof L))throw new TypeError('Cannot call a class as a function')}var k='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(A){return typeof A}:function(A){return A&&'function'==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?'symbol':typeof A};Object.defineProperty(p,'__esModule',{value:!0});var C='function'==typeof Symbol&&'symbol'===k(Symbol.iterator)?function(A){return'undefined'==typeof A?'undefined':k(A)}:function(A){return A&&'function'==typeof Symbol&&A.constructor===Symbol&&A!==Symbol.prototype?'symbol':'undefined'==typeof A?'undefined':k(A)},E=function(){function A(L,P){for(var B,O=0;O<P.length;O++)B=P[O],B.enumerable=B.enumerable||!1,B.configurable=!0,'value'in B&&(B.writable=!0),Object.defineProperty(L,B.key,B)}return function(L,P,O){return P&&A(L.prototype,P),O&&A(L,O),L}}(),S=f(0),R=1,T=3,N=function(){function A(L,P,O){v(this,A);var B;if(this.str='',this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof A))return new A(L,P,O);if('string'==typeof P?this.base=this.parseComponent(P):'object'===('undefined'==typeof P?'undefined':C(P))&&P.steps&&(this.base=P),B=this.checkType(L),'string'===B)return this.str=L,(0,S.extend)(this,this.parse(L));if('range'===B)return(0,S.extend)(this,this.fromRange(L,this.base,O));if('node'===B)return(0,S.extend)(this,this.fromNode(L,this.base,O));if('EpubCFI'===B&&L.path)return L;if(!L)return this;throw new TypeError('not a valid argument for EpubCFI')}return E(A,[{key:'checkType',value:function(P){return this.isCfiString(P)?'string':'object'===('undefined'==typeof P?'undefined':C(P))&&('Range'===(0,S.type)(P)||'undefined'!=typeof P.startContainer)?'range':'object'===('undefined'==typeof P?'undefined':C(P))&&'undefined'!=typeof P.nodeType?'node':'object'===('undefined'==typeof P?'undefined':C(P))&&P instanceof A&&'EpubCFI'}},{key:'parse',value:function(P){var B,z,M,O={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return'string'==typeof P?(0===P.indexOf('epubcfi(')&&')'===P[P.length-1]&&(P=P.slice(8,P.length-1)),B=this.getChapterComponent(P),!B)?{spinePos:-1}:(O.base=this.parseComponent(B),z=this.getPathComponent(P),O.path=this.parseComponent(z),M=this.getRange(P),M&&(O.range=!0,O.start=this.parseComponent(M[0]),O.end=this.parseComponent(M[1])),O.spinePos=O.base.steps[1].index,O):{spinePos:-1}}},{key:'parseComponent',value:function(P){var M,O={steps:[],terminal:{offset:null,assertion:null}},B=P.split(':'),z=B[0].split('/');return 1<B.length&&(M=B[1],O.terminal=this.parseTerminal(M)),''===z[0]&&z.shift(),O.steps=z.map(function(W){return this.parseStep(W)}.bind(this)),O}},{key:'parseStep',value:function(P){var O,B,z,M,W;if(M=P.match(/\[(.*)\]/),M&&M[1]&&(W=M[1]),B=parseInt(P),!isNaN(B))return 0==B%2?(O='element',z=B/2-1):(O='text',z=(B-1)/2),{type:O,index:z,id:W||null}}},{key:'parseTerminal',value:function(P){var O,B,z=P.match(/\[(.*)\]/);return z&&z[1]?(O=parseInt(P.split('[')[0])||null,B=z[1]):O=parseInt(P)||null,{offset:O,assertion:B}}},{key:'getChapterComponent',value:function(P){var O=P.split('!');return O[0]}},{key:'getPathComponent',value:function(P){var O=P.split('!');if(O[1]){var B=O[1].split(',');return B[0]}}},{key:'getRange',value:function(P){var O=P.split(',');return 3===O.length&&[O[1],O[2]]}},{key:'getCharecterOffsetComponent',value:function(P){var O=P.split(':');return O[1]||''}},{key:'joinSteps',value:function(P){return P?P.map(function(O){var B='';return'element'===O.type&&(B+=2*(O.index+1)),'text'===O.type&&(B+=1+2*O.index),O.id&&(B+='['+O.id+']'),B}).join('/'):''}},{key:'segmentString',value:function(P){var L='/';return L+=this.joinSteps(P.steps),P.terminal&&null!=P.terminal.offset&&(L+=':'+P.terminal.offset),P.terminal&&null!=P.terminal.assertion&&(L+='['+P.terminal.assertion+']'),L}},{key:'toString',value:function(){var P='epubcfi(';return P+=this.segmentString(this.base),P+='!',P+=this.segmentString(this.path),this.start&&(P+=',',P+=this.segmentString(this.start)),this.end&&(P+=',',P+=this.segmentString(this.end)),P+=')',P}},{key:'compare',value:function(P,O){var B,z,M,W;if('string'==typeof P&&(P=new A(P)),'string'==typeof O&&(O=new A(O)),P.spinePos>O.spinePos)return 1;if(P.spinePos<O.spinePos)return-1;P.range?(B=P.path.steps.concat(P.start.steps),M=P.start.terminal):(B=P.path.steps,M=P.path.terminal),O.range?(z=O.path.steps.concat(O.start.steps),W=O.start.terminal):(z=O.path.steps,W=O.path.terminal);for(var D=0;D<B.length;D++){if(!B[D])return-1;if(!z[D])return 1;if(B[D].index>z[D].index)return 1;if(B[D].index<z[D].index)return-1}return B.length<z.length?1:M.offset>W.offset?1:M.offset<W.offset?-1:0}},{key:'step',value:function(P){var O=P.nodeType===T?'text':'element';return{id:P.id,tagName:P.tagName,type:O,index:this.position(P)}}},{key:'filteredStep',value:function(P,O){var z,B=this.filter(P,O);if(B)return z=B.nodeType===T?'text':'element',{id:B.id,tagName:B.tagName,type:z,index:this.filteredPosition(B,O)}}},{key:'pathTo',value:function(P,O,B){for(var W,z={steps:[],terminal:{offset:null,assertion:null}},M=P;M&&M.parentNode&&M.parentNode.nodeType!=9;)W=B?this.filteredStep(M,B):this.step(M),W&&z.steps.unshift(W),M=M.parentNode;return null!=O&&0<=O&&(z.terminal.offset=O,'text'!=z.steps[z.steps.length-1].type&&z.steps.push({type:'text',index:0})),z}},{key:'equalStep',value:function(P,O){return P&&O&&P.index===O.index&&P.id===O.id&&P.type===O.type}},{key:'fromRange',value:function(P,O,B){var z={range:!1,base:{},path:{},start:null,end:null},M=P.startContainer,W=P.endContainer,D=P.startOffset,U=P.endOffset,H=!1;if(B&&(H=null!=M.ownerDocument.querySelector('.'+B)),'string'==typeof O?(z.base=this.parseComponent(O),z.spinePos=z.base.steps[1].index):'object'===('undefined'==typeof O?'undefined':C(O))&&(z.base=O),P.collapsed)H&&(D=this.patchOffset(M,D,B)),z.path=this.pathTo(M,D,B);else{z.range=!0,H&&(D=this.patchOffset(M,D,B)),z.start=this.pathTo(M,D,B),H&&(U=this.patchOffset(W,U,B)),z.end=this.pathTo(W,U,B),z.path={steps:[],terminal:null};var F,I=z.start.steps.length;for(F=0;F<I&&this.equalStep(z.start.steps[F],z.end.steps[F]);F++)F===I-1?z.start.terminal===z.end.terminal&&(z.path.steps.push(z.start.steps[F]),z.range=!1):z.path.steps.push(z.start.steps[F]);z.start.steps=z.start.steps.slice(z.path.steps.length),z.end.steps=z.end.steps.slice(z.path.steps.length)}return z}},{key:'fromNode',value:function(P,O,B){var z={range:!1,base:{},path:{},start:null,end:null};return'string'==typeof O?(z.base=this.parseComponent(O),z.spinePos=z.base.steps[1].index):'object'===('undefined'==typeof O?'undefined':C(O))&&(z.base=O),z.path=this.pathTo(P,null,B),z}},{key:'filter',value:function(P,O){var B,z,M,W,D,U=!1;return P.nodeType===T?(U=!0,M=P.parentNode,B=P.parentNode.classList.contains(O)):(U=!1,B=P.classList.contains(O)),B&&U?(W=M.previousSibling,D=M.nextSibling,W&&W.nodeType===T?z=W:D&&D.nodeType===T&&(z=D),z?z:P):B&&!U?!1:P}},{key:'patchOffset',value:function(P,O,B){if(P.nodeType!=T)throw new Error('Anchor must be a text node');var z=P,M=O;for(P.parentNode.classList.contains(B)&&(z=P.parentNode);z.previousSibling;){if(z.previousSibling.nodeType!==R)M+=z.previousSibling.textContent.length;else if(z.previousSibling.classList.contains(B))M+=z.previousSibling.textContent.length;else break;z=z.previousSibling}return M}},{key:'normalizedMap',value:function(P,O,B){var W,U,H,z={},M=-1,D=P.length;for(W=0;W<D;W++)U=P[W].nodeType,U===R&&P[W].classList.contains(B)&&(U=T),0<W&&U===T&&H===T?z[W]=M:O===U&&(++M,z[W]=M),H=U;return z}},{key:'position',value:function(P){var O,B;return P.nodeType===R?(O=P.parentNode.children,!O&&(O=(0,S.findChildren)(P.parentNode)),B=Array.prototype.indexOf.call(O,P)):(O=this.textNodes(P.parentNode),B=O.indexOf(P)),B}},{key:'filteredPosition',value:function(P,O){var B,z,M;return P.nodeType===R?(B=P.parentNode.children,M=this.normalizedMap(B,R,O)):(B=P.parentNode.childNodes,P.parentNode.classList.contains(O)&&(P=P.parentNode,B=P.parentNode.childNodes),M=this.normalizedMap(B,T,O)),z=Array.prototype.indexOf.call(B,P),M[z]}},{key:'stepsToXpath',value:function(P){var O=['.','*'];return P.forEach(function(B){var z=B.index+1;B.id?O.push('*[position()='+z+' and @id=\''+B.id+'\']'):'text'===B.type?O.push('text()['+z+']'):O.push('*['+z+']')}),O.join('/')}},{key:'stepsToQuerySelector',value:function(P){var O=['html'];return P.forEach(function(B){var z=B.index+1;B.id?O.push('#'+B.id):'text'===B.type||O.push('*:nth-child('+z+')')}),O.join('>')}},{key:'textNodes',value:function(P,O){return Array.prototype.slice.call(P.childNodes).filter(function(B){return B.nodeType===T||O&&B.classList.contains(O)})}},{key:'walkToNode',value:function(P,O,B){var W,D,H,z=O||document,M=z.documentElement,U=P.length;for(H=0;H<U&&(D=P[H],'element'===D.type?D.id?M=z.getElementById(D.id):(W=M.children||(0,S.findChildren)(M),M=W[D.index]):'text'===D.type&&(M=this.textNodes(M,B)[D.index]),!!M);H++);return M}},{key:'findNode',value:function(P,O,B){var M,W,z=O||document;return B||'undefined'==typeof z.evaluate?B?M=this.walkToNode(P,z,B):M=this.walkToNode(P,z):(W=this.stepsToXpath(P),M=z.evaluate(W,z,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),M}},{key:'fixMiss',value:function(P,O,B,z){var U,H,M=this.findNode(P.slice(0,-1),B,z),W=M.childNodes,D=this.normalizedMap(W,T,z),I=P[P.length-1].index;for(var F in D){if(!D.hasOwnProperty(F))return;if(D[F]===I)if(U=W[F],H=U.textContent.length,O>H)O-=H;else{M=U.nodeType===R?U.childNodes[0]:U;break}}return{container:M,offset:O}}},{key:'toRange',value:function(P,O){var z,M,W,D,U,I,F,Y,B=P||document,H=this,X=!!O&&null!=B.querySelector('.'+O);if(z='undefined'==typeof B.createRange?new S.RangeObject:B.createRange(),H.range?(M=H.start,I=H.path.steps.concat(M.steps),D=this.findNode(I,B,X?O:null),W=H.end,F=H.path.steps.concat(W.steps),U=this.findNode(F,B,X?O:null)):(M=H.path,I=H.path.steps,D=this.findNode(H.path.steps,B,X?O:null)),D)try{null==M.terminal.offset?z.setStart(D,0):z.setStart(D,M.terminal.offset)}catch(K){Y=this.fixMiss(I,M.terminal.offset,B,X?O:null),z.setStart(Y.container,Y.offset)}else return console.log('NO START'),null;if(U)try{null==W.terminal.offset?z.setEnd(U,0):z.setEnd(U,W.terminal.offset)}catch(K){Y=this.fixMiss(F,H.end.terminal.offset,B,X?O:null),z.setEnd(Y.container,Y.offset)}return z}},{key:'isCfiString',value:function(P){return'string'==typeof P&&0===P.indexOf('epubcfi(')&&')'===P[P.length-1]}},{key:'generateChapterComponent',value:function(P,O,B){var z=parseInt(O),W='/'+2*(P+1)+'/';return W+=2*(z+1),B&&(W+='['+B+']'),W}}]),A}();p.default=N,u.exports=p['default']},function(u,p,f){'use strict';function k(T,_){if(!(T instanceof _))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function T(_,N){for(var L,A=0;A<N.length;A++)L=N[A],L.enumerable=L.enumerable||!1,L.configurable=!0,'value'in L&&(L.writable=!0),Object.defineProperty(_,L.key,L)}return function(_,N,A){return N&&T(_.prototype,N),A&&T(_,A),_}}(),E=f(1),S=function(T){return T&&T.__esModule?T:{default:T}}(E),R=function(){function T(_){k(this,T);var N,A;N=_.indexOf('://'),-1<N&&(_=new URL(_).pathname),A=this.parse(_),this.path=_,this.directory=this.isDirectory(_)?_:A.dir+'/',this.filename=A.base,this.extension=A.ext.slice(1)}return C(T,[{key:'parse',value:function(N){return S.default.parse(N)}},{key:'isAbsolute',value:function(N){return S.default.isAbsolute(N||this.path)}},{key:'isDirectory',value:function(N){return'/'===N.charAt(N.length-1)}},{key:'resolve',value:function(N){return S.default.resolve(this.directory,N)}},{key:'relative',value:function(N){return S.default.relative(this.directory,N)}},{key:'splitPath',value:function(N){return this.splitPathRe.exec(N).slice(1)}},{key:'toString',value:function(){return this.path}}]),T}();p.default=R,u.exports=p['default']},function(u,p,f){'use strict';function v(z){return z&&z.__esModule?z:{default:z}}function k(z,M){if(!(z instanceof M))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function z(M,W){for(var U,D=0;D<W.length;D++)U=W[D],U.enumerable=U.enumerable||!1,U.configurable=!0,'value'in U&&(U.writable=!0),Object.defineProperty(M,U.key,U)}return function(M,W,D){return W&&z(M.prototype,W),D&&z(M,D),M}}(),E=f(5),S=v(E),R=f(0),T=f(2),_=v(T),N=f(23),A=v(N),L=f(24),P=f(21),O=['keydown','keyup','keypressed','mouseup','mousedown','click','touchend','touchstart'],B=function(){function z(M,W,D){k(this,z),this.epubcfi=new _.default,this.document=M,this.documentElement=this.document.documentElement,this.content=W||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.cfiBase=D||'',this.pane=void 0,this.highlights={},this.underlines={},this.marks={},this.listeners()}return C(z,[{key:'width',value:function(W){var D=this.content;return W&&(0,R.isNumber)(W)&&(W+='px'),W&&(D.style.width=W),this.window.getComputedStyle(D).width}},{key:'height',value:function(W){var D=this.content;return W&&(0,R.isNumber)(W)&&(W+='px'),W&&(D.style.height=W),this.window.getComputedStyle(D).height}},{key:'contentWidth',value:function(W){var D=this.content||this.document.body;return W&&(0,R.isNumber)(W)&&(W+='px'),W&&(D.style.width=W),this.window.getComputedStyle(D).width}},{key:'contentHeight',value:function(W){var D=this.content||this.document.body;return W&&(0,R.isNumber)(W)&&(W+='px'),W&&(D.style.height=W),this.window.getComputedStyle(D).height}},{key:'textWidth',value:function(){var W,D=this.document.createRange(),U=this.content||this.document.body;return D.selectNodeContents(U),W=D.getBoundingClientRect().width,W}},{key:'textHeight',value:function(){var W,D=this.document.createRange(),U=this.content||this.document.body;return D.selectNodeContents(U),W=D.getBoundingClientRect().height,W}},{key:'scrollWidth',value:function(){var W=this.documentElement.scrollWidth;return W}},{key:'scrollHeight',value:function(){var W=this.documentElement.scrollHeight;return W}},{key:'overflow',value:function(W){return W&&(this.documentElement.style.overflow=W),this.window.getComputedStyle(this.documentElement).overflow}},{key:'overflowX',value:function(W){return W&&(this.documentElement.style.overflowX=W),this.window.getComputedStyle(this.documentElement).overflowX}},{key:'overflowY',value:function(W){return W&&(this.documentElement.style.overflowY=W),this.window.getComputedStyle(this.documentElement).overflowY}},{key:'css',value:function(W,D,U){var H=this.content||this.document.body;return D&&H.style.setProperty(W,D,U?'important':''),this.window.getComputedStyle(H)[W]}},{key:'viewport',value:function(W){var Y,K,J,Q,V,G,Z=this.document.querySelector('meta[name=\'viewport\']'),$='';if(Z&&Z.hasAttribute('content')){var ee=Z.getAttribute('content'),te=ee.match(/width\s*=\s*([^,]*)/g),ne=ee.match(/height\s*=\s*([^,]*)/g),ae=ee.match(/initial-scale\s*=\s*([^,]*)/g),ie=ee.match(/minimum-scale\s*=\s*([^,]*)/g),le=ee.match(/maximum-scale\s*=\s*([^,]*)/g),oe=ee.match(/user-scalable\s*=\s*([^,]*)/g);te[1]&&(Y=te[1]),ne[1]&&(K=ne[1]),ae[1]&&(J=ae[1]),ie[1]&&(Q=ie[1]),le[1]&&(V=le[1]),oe[1]&&(G=oe[1])}return W&&($+='width='+(W.width||Y),$+=', height='+(W.height||K),(W.scale||J)&&($+=', initial-scale='+(W.scale||J)),(W.scalable||G)&&($+=', minimum-scale='+(W.scale||Q),$+=', maximum-scale='+(W.scale||V),$+=', user-scalable='+(W.scalable||G)),!Z&&(Z=this.document.createElement('meta'),Z.setAttribute('name','viewport'),this.document.querySelector('head').appendChild(Z)),Z.setAttribute('content',$)),{width:parseInt(Y),height:parseInt(K)}}},{key:'expand',value:function(){this.emit('expand')}},{key:'listeners',value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),this.resizeListeners(),this.linksHandler()}},{key:'removeListeners',value:function(){this.removeEventListeners(),this.removeSelectionListeners(),clearTimeout(this.expanding)}},{key:'resizeListeners',value:function(){var W,D;clearTimeout(this.expanding),W=this.scrollWidth(),D=this.scrollHeight(),(W!=this._size.width||D!=this._size.height)&&(this._size={width:W,height:D},this.pane&&this.pane.render(),this.emit('resize',this._size)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:'mediaQueryListeners',value:function(){for(var W=this.document.styleSheets,D=function(X){X.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),U=0;U<W.length;U+=1){var H;try{H=W[U].cssRules}catch(X){return}if(!H)return;for(var I=0;I<H.length;I+=1)if(H[I].media){var F=this.window.matchMedia(H[I].media.mediaText);F.addListener(D)}}}},{key:'observe',value:function(W){var D=this,U=new MutationObserver(function(){D._expanding&&D.expand()});return U.observe(W,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),U}},{key:'imageLoadListeners',value:function(){for(var U,D=this.document.querySelectorAll('img'),H=0;H<D.length;H++)U=D[H],'undefined'!=typeof U.naturalWidth&&0===U.naturalWidth&&(U.onload=this.expand.bind(this))}},{key:'fontLoadListeners',value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.expand()}.bind(this))}},{key:'root',value:function(){return this.document?this.document.documentElement:null}},{key:'locationOf',value:function(W,D){var U,H={left:0,top:0};if(this.document){if(this.epubcfi.isCfiString(W)){var I=new _.default(W).toRange(this.document,D);I&&(I.startContainer.nodeType===Node.ELEMENT_NODE?(U=I.startContainer.getBoundingClientRect(),H.left=U.left,H.top=U.top):I.collapsed?U=I.getClientRects()[0]:U=I.getBoundingClientRect())}else if('string'==typeof W&&-1<W.indexOf('#')){var F=W.substring(W.indexOf('#')+1),X=this.document.getElementById(F);X&&(U=X.getBoundingClientRect())}return U&&(H.left=U.left,H.top=U.top),H}}},{key:'addStylesheet',value:function(W){return new Promise(function(D){var H,I=!1;return this.document?(H=this.document.querySelector('link[href=\''+W+'\']'),H?void D(!0):void(H=this.document.createElement('link'),H.type='text/css',H.rel='stylesheet',H.href=W,H.onload=H.onreadystatechange=function(){var F=this;I||this.readyState&&'complete'!=this.readyState||(I=!0,setTimeout(function(){F.pane&&F.pane.render(),D(!0)},1))},this.document.head.appendChild(H))):void D(!1)}.bind(this))}},{key:'addStylesheetRules',value:function(W){var D,U,H='epubjs-inserted-css';if(this.document&&W&&0!==W.length){if(D=this.document.getElementById('#'+H),D||(D=this.document.createElement('style'),D.id=H),this.document.head.appendChild(D),U=D.sheet,'[object Array]'===Object.prototype.toString.call(W))for(var I=0,F=W.length;I<F;I++){var X=1,Y=W[I],K=W[I][0],J='';'[object Array]'===Object.prototype.toString.call(Y[1][0])&&(Y=Y[1],X=0);for(var V,Q=Y.length;X<Q;X++)V=Y[X],J+=V[0]+':'+V[1]+(V[2]?' !important':'')+';\n';U.insertRule(K+'{'+J+'}',U.cssRules.length)}else{var G=Object.keys(W);G.forEach(function(Z){var $=W[Z],ee=Object.keys($),te=ee.map(function(ne){return ne+':'+$[ne]}).join(';');U.insertRule(Z+'{'+te+'}',U.cssRules.length)})}this.pane&&this.pane.render()}}},{key:'addScript',value:function(W){return new Promise(function(D){var H,I=!1;return this.document?void(H=this.document.createElement('script'),H.type='text/javascript',H.async=!0,H.src=W,H.onload=H.onreadystatechange=function(){I||this.readyState&&'complete'!=this.readyState||(I=!0,setTimeout(function(){D(!0)},1))},this.document.head.appendChild(H)):void D(!1)}.bind(this))}},{key:'addClass',value:function(W){var D;this.document&&(D=this.content||this.document.body,D.classList.add(W))}},{key:'removeClass',value:function(W){var D;this.document&&(D=this.content||this.document.body,D.classList.remove(W))}},{key:'addEventListeners',value:function(){this.document&&O.forEach(function(W){this.document.addEventListener(W,this.triggerEvent.bind(this),!1)},this)}},{key:'removeEventListeners',value:function(){this.document&&O.forEach(function(W){this.document.removeEventListener(W,this.triggerEvent,!1)},this)}},{key:'triggerEvent',value:function(W){this.emit(W.type,W)}},{key:'addSelectionListeners',value:function(){this.document&&this.document.addEventListener('selectionchange',this.onSelectionChange.bind(this),!1)}},{key:'removeSelectionListeners',value:function(){this.document&&this.document.removeEventListener('selectionchange',this.onSelectionChange,!1)}},{key:'onSelectionChange',value:function(){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var D=this.window.getSelection();this.triggerSelectedEvent(D)}.bind(this),250)}},{key:'triggerSelectedEvent',value:function(W){var D,U;W&&0<W.rangeCount&&(D=W.getRangeAt(0),!D.collapsed&&(U=new _.default(D,this.cfiBase).toString(),this.emit('selected',U),this.emit('selectedRange',D)))}},{key:'range',value:function(W,D){var U=new _.default(W);return U.toRange(this.document,D)}},{key:'cfiFromRange',value:function(W,D){return new _.default(W,this.cfiBase,D).toString()}},{key:'cfiFromNode',value:function(W,D){return new _.default(W,this.cfiBase,D).toString()}},{key:'map',value:function(W){var M=new A.default(W);return M.section()}},{key:'size',value:function(W,D){0<=W&&this.width(W),0<=D&&this.height(D),this.css('margin','0'),this.css('box-sizing','border-box')}},{key:'columns',value:function(W,D,U,H){var I=(0,R.prefixed)('column-axis'),F=(0,R.prefixed)('column-gap'),X=(0,R.prefixed)('column-width'),Y=(0,R.prefixed)('column-fill');this.width(W),this.height(D),this.viewport({width:W,height:D,scale:1,scalable:'no'}),this.css('overflow-y','hidden'),this.css('margin','0',!0),this.css('padding','0',!0),this.css('box-sizing','border-box'),this.css('max-width','inherit'),this.css(I,'horizontal'),this.css(Y,'auto'),this.css(F,H+'px'),this.css(X,U+'px')}},{key:'scaler',value:function(W,D,U){var I='';this.css('transform-origin','top left'),(0<=D||0<=U)&&(I=' translate('+(D||0)+'px, '+(U||0)+'px )'),this.css('transform','scale('+W+')'+I)}},{key:'fit',value:function(W,D){var U=this.viewport(),H=W/U.width,I=D/U.height,F=H<I?H:I,X=(D-U.height*F)/2;this.width(W),this.height(D),this.overflow('hidden'),this.viewport({scale:1}),this.scaler(F,0,X),this.css('background-color','transparent')}},{key:'mapPage',value:function(W,D,U,H,I){var F=new A.default(D,I);return F.page(this,W,U,H)}},{key:'linksHandler',value:function(){var W=this;(0,L.replaceLinks)(this.content,function(D){W.emit('link',D)})}},{key:'highlight',value:function(W){var D=this,U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},H=arguments[2],I=this.range(W),F=function(){D.emit('markClicked',W,U)};U.epubcfi=W,this.pane||(this.pane=new P.Pane(this.content,this.document.body));var X=new P.Highlight(I,'epubjs-hl',U,{fill:'yellow','fill-opacity':'0.3','mix-blend-mode':'multiply'}),Y=this.pane.addMark(X);return this.highlights[W]={mark:Y,element:Y.element,listeners:[F,H]},Y.element.addEventListener('click',F),H&&Y.element.addEventListener('click',H),Y}},{key:'underline',value:function(W){var D=this,U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},H=arguments[2],I=this.range(W),F=function(){D.emit('markClicked',W,U)};U.epubcfi=W,this.pane||(this.pane=new P.Pane(this.content,this.document.body));var X=new P.Underline(I,'epubjs-ul',U,{stroke:'black','stroke-opacity':'0.3','mix-blend-mode':'multiply'}),Y=this.pane.addMark(X);return this.underlines[W]={mark:Y,element:Y.element,listeners:[F,H]},Y.element.addEventListener('click',F),H&&Y.element.addEventListener('click',H),Y}},{key:'mark',value:function(W){var D=this,U=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},H=arguments[2],I=this.range(W),F=I.commonAncestorContainer,X=1===F.nodeType?F:F.parentNode,Y=function(){D.emit('markClicked',W,U)};return X.setAttribute('ref','epubjs-mk'),X.dataset.epubcfi=W,U&&Object.keys(U).forEach(function(K){X.dataset[K]=U[K]}),X.addEventListener('click',Y),H&&X.addEventListener('click',H),this.marks[W]={element:X,listeners:[Y,H]},X}},{key:'unhighlight',value:function(W){var D;W in this.highlights&&(D=this.highlights[W],this.pane.removeMark(D.mark),D.listeners.forEach(function(U){U&&D.element.removeEventListener('click',U)}),delete this.highlights[W])}},{key:'ununderline',value:function(W){var D;W in this.underlines&&(D=this.underlines[W],this.pane.removeMark(D.mark),D.listeners.forEach(function(U){U&&D.element.removeEventListener('click',U)}),delete this.underlines[W])}},{key:'unmark',value:function(W){var D;W in this.marks&&(D=this.marks[W],D.element.removeAttribute('ref'),D.listeners.forEach(function(U){U&&D.element.removeEventListener('click',U)}),delete this.marks[W])}},{key:'destroy',value:function(){this.observer&&this.observer.disconnect(),this.removeListeners()}}],[{key:'listenedEvents',get:function(){return O}}]),z}();(0,S.default)(B.prototype),p.default=B,u.exports=p['default']},function(u,p,f){'use strict';var A,L,P,O,B,z,M,v=f(6),k=f(15),C=Function.prototype.apply,E=Function.prototype.call,S=Object.create,R=Object.defineProperty,T=Object.defineProperties,_=Object.prototype.hasOwnProperty,N={configurable:!0,enumerable:!1,writable:!0};A=function(W,D){var U;return k(D),_.call(this,'__ee__')?U=this.__ee__:(U=N.value=S(null),R(this,'__ee__',N),N.value=null),U[W]?'object'==typeof U[W]?U[W].push(D):U[W]=[U[W],D]:U[W]=D,this},L=function(W,D){var U,H;return k(D),H=this,A.call(this,W,U=function(){P.call(H,W,U),C.call(D,this,arguments)}),U.__eeOnceListener__=D,this},P=function(W,D){var U,H,I,F;if(k(D),!_.call(this,'__ee__'))return this;if(U=this.__ee__,!U[W])return this;if(H=U[W],'object'==typeof H)for(F=0;I=H[F];++F)(I===D||I.__eeOnceListener__===D)&&(2===H.length?U[W]=H[F?0:1]:H.splice(F,1));else(H===D||H.__eeOnceListener__===D)&&delete U[W];return this},O=function(W){var D,U,H,I,F;if(_.call(this,'__ee__')&&(I=this.__ee__[W],!!I))if('object'==typeof I){for(U=arguments.length,F=Array(U-1),D=1;D<U;++D)F[D-1]=arguments[D];for(I=I.slice(),D=0;H=I[D];++D)C.call(H,this,F)}else switch(arguments.length){case 1:E.call(I,this);break;case 2:E.call(I,this,arguments[1]);break;case 3:E.call(I,this,arguments[1],arguments[2]);break;default:for(U=arguments.length,F=Array(U-1),D=1;D<U;++D)F[D-1]=arguments[D];C.call(I,this,F);}},B={on:A,once:L,off:P,emit:O},z={on:v(A),once:v(L),off:v(P),emit:v(O)},M=T({},z),u.exports=p=function(W){return null==W?S(M):T(Object(W),z)},p.methods=B},function(u,p,f){'use strict';var S,v=f(7),k=f(14),C=f(10),E=f(17);S=u.exports=function(R,T){var _,N,A,L,P;return 2>arguments.length||'string'!=typeof R?(L=T,T=R,R=null):L=arguments[2],null==R?(_=A=!0,N=!1):(_=E.call(R,'c'),N=E.call(R,'e'),A=E.call(R,'w')),P={value:T,configurable:_,enumerable:N,writable:A},L?v(k(L),P):P},S.gs=function(R,T,_){var N,A,L,P;return'string'==typeof R?L=arguments[3]:(L=_,_=T,T=R,R=null),null==T?T=void 0:C(T)?null==_?_=void 0:!C(_)&&(L=_,_=void 0):(L=T,T=_=void 0),null==R?(N=!0,A=!1):(N=E.call(R,'c'),A=E.call(R,'e')),P={get:T,set:_,configurable:N,enumerable:A},L?v(k(L),P):P}},function(u,p,f){'use strict';u.exports=f(8)()?Object.assign:f(9)},function(u){'use strict';u.exports=function(){var k,v=Object.assign;return!('function'!=typeof v)&&(k={foo:'raz'},v(k,{bar:'dwa'},{trzy:'trzy'}),'razdwatrzy'===k.foo+k.bar+k.trzy)}},function(u,p,f){'use strict';var v=f(11),k=f(16);u.exports=function(E,S){var R,T,N,_=_Mathmax(arguments.length,2);for(E=Object(k(E)),N=function(A){try{E[A]=S[A]}catch(L){R||(R=L)}},T=1;T<_;++T)S=arguments[T],v(S).forEach(N);if(R!==void 0)throw R;return E}},function(u){'use strict';u.exports=function(v){return'function'==typeof v}},function(u,p,f){'use strict';u.exports=f(12)()?Object.keys:f(13)},function(u){'use strict';u.exports=function(){try{return Object.keys('primitive'),!0}catch(v){return!1}}},function(u){'use strict';var v=Object.keys;u.exports=function(k){return v(null==k?k:Object(k))}},function(u){'use strict';var v=Array.prototype.forEach,k=Object.create,C=function(E,S){for(var R in E)S[R]=E[R]};u.exports=function(){var S=k(null);return v.call(arguments,function(R){null==R||C(Object(R),S)}),S}},function(u){'use strict';u.exports=function(v){if('function'!=typeof v)throw new TypeError(v+' is not a function');return v}},function(u){'use strict';u.exports=function(v){if(null==v)throw new TypeError('Cannot use null or undefined');return v}},function(u,p,f){'use strict';u.exports=f(18)()?_Stringprototype.contains:f(19)},function(u){'use strict';var v='razdwatrzy';u.exports=function(){return!('function'!=typeof v.contains)&&!0===v.contains('dwa')&&!1===v.contains('foo')}},function(u){'use strict';var v=_Stringprototype.indexOf;u.exports=function(k){return-1<v.call(this,k,arguments[1])}},function(u,p){'use strict';function k(E){var S=Object.assign({},E,{bubbles:!1});try{return new MouseEvent(E.type,S)}catch(T){var R=document.createEvent('MouseEvents');return R.initMouseEvent(E.type,!1,S.cancelable,S.view,S.detail,S.screenX,S.screenY,S.clientX,S.clientY,S.ctrlKey,S.altKey,S.shiftKey,S.metaKey,S.button,S.relatedTarget),R}}function C(E,S,R){function T(P,O,B){var z=P.top+P.height,M=P.left+P.width;return P.top<=B&&P.left<=O&&z>B&&M>O}var _=E.getBoundingClientRect();if(!T(_,S,R))return!1;for(var N=E.getClientRects(),A=0,L=N.length;A<L;A++)if(T(N[A],S,R))return!0;return!1}p.a={proxyMouse:function(E,S){function R(_){for(var A,N=S.length-1;0<=N;N--)if(A=S[N],!!C(A,_.clientX,_.clientY)){A.dispatchEvent(k(_));break}}for(var T of['mouseup','mousedown','click'])E.addEventListener(T,(_)=>R(_),!1)}}},function(u,p,f){'use strict';function v(A){var L=A.getBoundingClientRect();return{top:L.top+A.ownerDocument.body.scrollTop,left:L.left+A.ownerDocument.body.scrollLeft,height:L.height+A.scrollHeight,width:L.width+A.scrollWidth}}function k(A,L){A.style.top=`${L.top}px`,A.style.left=`${L.left}px`,A.style.height=`${L.height}px`,A.style.width=`${L.width}px`}function C(A,L){return L.right<=A.right&&L.left>=A.left&&L.top>=A.top&&L.bottom<=A.bottom}Object.defineProperty(p,'__esModule',{value:!0});var E=f(22),S=f(20);p.Pane=class{constructor(A,L=document.body){this.target=A,this.element=E.a.createElement('svg'),this.marks=[],this.element.style.position='absolute',this.element.setAttribute('pointer-events','none'),S.a.proxyMouse(this.target,this.marks),L.appendChild(this.element),this.render()}addMark(A){var L=E.a.createElement('g');return this.element.appendChild(L),A.bind(L),this.marks.push(A),A.render(),A}removeMark(A){var L=this.marks.indexOf(A);if(-1!==L){var P=A.unbind();this.element.removeChild(P),this.marks.splice(L,1)}}render(){k(this.element,v(this.target));for(var A of this.marks)A.render()}};class T{constructor(){this.element=null}bind(A){this.element=A}unbind(){var A=this.element;return this.element=null,A}render(){}dispatchEvent(A){this.element&&this.element.dispatchEvent(A)}getBoundingClientRect(){return this.element.getBoundingClientRect()}getClientRects(){for(var A=[],L=this.element.firstChild;L;)A.push(L.getBoundingClientRect()),L=L.nextSibling;return A}filteredRanges(){var A=Array.from(this.range.getClientRects());return A.filter((L)=>{for(var P=0;P<A.length;P++){if(A[P]===L)return!0;let O=C(A[P],L);if(O)return!1}return!0})}}p.Mark=T;class _ extends T{constructor(A,L,P,O){super(),this.range=A,this.className=L,this.data=P||{},this.attributes=O||{}}bind(A){for(var L in super.bind(A),this.data)this.data.hasOwnProperty(L)&&(this.element.dataset[L]=this.data[L]);for(var L in this.attributes)this.attributes.hasOwnProperty(L)&&this.element.setAttribute(L,this.attributes[L]);this.className&&this.element.classList.add(this.className)}render(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var A=this.element.ownerDocument.createDocumentFragment(),L=this.filteredRanges(),P=this.element.getBoundingClientRect(),O=0,B=L.length;O<B;O++){var z=L[O],M=E.a.createElement('rect');M.setAttribute('x',z.left-P.left),M.setAttribute('y',z.top-P.top),M.setAttribute('height',z.height),M.setAttribute('width',z.width),A.appendChild(M)}this.element.appendChild(A)}}p.Highlight=_;p.Underline=class extends _{constructor(A,L,P,O){super(A,L,P,O)}render(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var A=this.element.ownerDocument.createDocumentFragment(),L=this.filteredRanges(),P=this.element.getBoundingClientRect(),O=0,B=L.length;O<B;O++){var z=L[O],M=E.a.createElement('rect');M.setAttribute('x',z.left-P.left),M.setAttribute('y',z.top-P.top),M.setAttribute('height',z.height),M.setAttribute('width',z.width),M.setAttribute('fill','none');var W=E.a.createElement('line');W.setAttribute('x1',z.left-P.left),W.setAttribute('x2',z.left-P.left+z.width),W.setAttribute('y1',z.top-P.top+z.height-1),W.setAttribute('y2',z.top-P.top+z.height-1),W.setAttribute('stroke-width',1),W.setAttribute('stroke','black'),W.setAttribute('stroke-linecap','square'),A.appendChild(M),A.appendChild(W)}this.element.appendChild(A)}}},function(u,p){'use strict';p.a={createElement:function(k){return document.createElementNS('http://www.w3.org/2000/svg',k)}}},function(u,p,f){'use strict';function k(T,_){if(!(T instanceof _))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function T(_,N){for(var L,A=0;A<N.length;A++)L=N[A],L.enumerable=L.enumerable||!1,L.configurable=!0,'value'in L&&(L.writable=!0),Object.defineProperty(_,L.key,L)}return function(_,N,A){return N&&T(_.prototype,N),A&&T(_,A),_}}(),E=f(2),S=function(T){return T&&T.__esModule?T:{default:T}}(E),R=function(){function T(_,N){k(this,T),this.layout=_,this.horizontal='paginated'===this.layout.flow,this._dev=N}return C(T,[{key:'section',value:function(N){var A=this.findRanges(N),L=this.rangeListToCfiList(N.section.cfiBase,A);return L}},{key:'page',value:function(N,A,L,P){var B,O=N&&N.document&&N.document.body;if(O){if(B=this.rangePairToCfiPair(A,{start:this.findStart(O,L,P),end:this.findEnd(O,L,P)}),!0===this._dev){var z=N.document,M=new S.default(B.start).toRange(z),W=new S.default(B.end).toRange(z),D=z.defaultView.getSelection(),U=z.createRange();D.removeAllRanges(),U.setStart(M.startContainer,M.startOffset),U.setEnd(W.endContainer,W.endOffset),D.addRange(U)}return B}}},{key:'walk',value:function(N,A){for(var P,O,L=document.createTreeWalker(N,NodeFilter.SHOW_TEXT,{acceptNode:function(z){return 0<z.data.trim().length?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);(P=L.nextNode())&&(O=A(P),!O););return O}},{key:'findRanges',value:function(N){for(var M,W,A=[],L=N.contents.scrollWidth(),P=Math.ceil(L/this.layout.spreadWidth),O=P*this.layout.divisor,B=this.layout.columnWidth,z=this.layout.gap,D=0;D<O.pages;D++)M=(B+z)*D,W=B*(D+1)+z*D,A.push({start:this.findStart(N.document.body,M,W),end:this.findEnd(N.document.body,M,W)});return A}},{key:'findStart',value:function(N,A,L){for(var B,z,P=this,O=[N],M=N;O.length;)if(B=O.shift(),z=this.walk(B,function(W){var D,U,H,I;return(W.nodeType==Node.TEXT_NODE?(I=document.createRange(),I.selectNodeContents(W),H=I.getBoundingClientRect()):H=W.getBoundingClientRect(),D=P.horizontal?H.left:H.top,U=P.horizontal?H.right:H.bottom,D>=A&&D<=L)?W:U>A?W:void(M=W,O.push(W))}),z)return this.findTextStartRange(z,A,L);return this.findTextStartRange(M,A,L)}},{key:'findEnd',value:function(N,A,L){for(var B,M,P=this,O=[N],z=N;O.length;)if(B=O.shift(),M=this.walk(B,function(W){var D,U,H,I;return(W.nodeType==Node.TEXT_NODE?(I=document.createRange(),I.selectNodeContents(W),H=I.getBoundingClientRect()):H=W.getBoundingClientRect(),D=P.horizontal?H.left:H.top,U=P.horizontal?H.right:H.bottom,D>L&&z)?z:U>L?W:void(z=W,O.push(W))}),M)return this.findTextEndRange(M,A,L);return this.findTextEndRange(z,A,L)}},{key:'findTextStartRange',value:function(N,A){for(var O,B,z,P=this.splitTextNodeIntoRanges(N),M=0;M<P.length;M++)if(O=P[M],B=O.getBoundingClientRect(),z=this.horizontal?B.left:B.top,z>=A)return O;return P[0]}},{key:'findTextEndRange',value:function(N,A,L){for(var O,B,z,M,W,P=this.splitTextNodeIntoRanges(N),D=0;D<P.length;D++){if(B=P[D],z=B.getBoundingClientRect(),M=this.horizontal?z.left:z.top,W=this.horizontal?z.right:z.bottom,M>L&&O)return O;if(W>L)return B;O=B}return P[P.length-1]}},{key:'splitTextNodeIntoRanges',value:function(N,A){var B,L=[],P=N.textContent||'',O=P.trim(),z=N.ownerDocument,M=A||' ',W=O.indexOf(M);if(-1===W||N.nodeType!=Node.TEXT_NODE)return B=z.createRange(),B.selectNodeContents(N),[B];for(B=z.createRange(),B.setStart(N,0),B.setEnd(N,W),L.push(B),B=!1;-1!=W;)W=O.indexOf(M,W+1),0<W&&(B&&(B.setEnd(N,W),L.push(B)),B=z.createRange(),B.setStart(N,W+1));return B&&(B.setEnd(N,O.length),L.push(B)),L}},{key:'rangePairToCfiPair',value:function(N,A){var L=A.start,P=A.end;L.collapse(!0),P.collapse(!1);var O=new S.default(L,N).toString(),B=new S.default(P,N).toString();return{start:O,end:B}}},{key:'rangeListToCfiList',value:function(N,A){for(var P,L=[],O=0;O<A.length;O++)P=this.rangePairToCfiPair(N,A[O]),L.push(P);return L}}]),T}();p.default=R,u.exports=p['default']},function(u,p,f){'use strict';function v(L){return L&&L.__esModule?L:{default:L}}Object.defineProperty(p,'__esModule',{value:!0}),p.replaceBase=function(L,P){var O,B;L&&(B=(0,R.qs)(L,'head'),O=(0,R.qs)(B,'base'),!O&&(O=L.createElement('base'),B.insertBefore(O,B.firstChild)),O.setAttribute('href',P.url))},p.replaceCanonical=function(L,P){var O,B,z=P.url;L&&(O=(0,R.qs)(L,'head'),B=(0,R.qs)(O,'link[rel=\'canonical\']'),B?B.setAttribute('href',z):(B=L.createElement('link'),B.setAttribute('rel','canonical'),B.setAttribute('href',z),O.appendChild(B)))},p.replaceLinks=function(L,P){var O=L.querySelectorAll('a[href]');if(O.length)for(var B=(0,R.qs)(L.ownerDocument,'base'),z=B?B.getAttribute('href'):void 0,M=function(D){var U=D.getAttribute('href');if(0!==U.indexOf('mailto:')){var H=-1<U.indexOf('://'),I=new _.default(U,z);H?D.setAttribute('target','_blank'):D.onclick=function(){return I&&I.hash?P(I.Path.path+I.hash):I?P(I.Path.path):P(U),!1}}}.bind(this),W=0;W<O.length;W++)M(O[W])},p.substitute=function(L,P,O){return P.forEach(function(B,z){B&&O[z]&&(L=L.replace(new RegExp(B,'g'),O[z]))}),L};var R=f(0),T=f(25),_=v(T),N=f(3),A=v(N)},function(u,p,f){'use strict';function v(N){return N&&N.__esModule?N:{default:N}}function k(N,A){if(!(N instanceof A))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(p,'__esModule',{value:!0});var C=function(){function N(A,L){for(var O,P=0;P<L.length;P++)O=L[P],O.enumerable=O.enumerable||!1,O.configurable=!0,'value'in O&&(O.writable=!0),Object.defineProperty(A,O.key,O)}return function(A,L,P){return L&&N(A.prototype,L),P&&N(A,P),A}}(),E=f(3),S=v(E),R=f(1),T=v(R),_=function(){function N(A,L){k(this,N);var B,P=-1<A.indexOf('://'),O=A;if(this.Url=void 0,this.href=A,this.protocol='',this.origin='',this.hash='',this.hash='',this.search='',this.base=L,!P&&!1!==L&&'string'!=typeof L&&window&&window.location&&(this.base=window.location.href),P||this.base)try{this.Url=this.base?new URL(A,this.base):new URL(A),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,O=this.Url.pathname}catch(z){this.Url=void 0,this.base&&(B=new S.default(this.base),O=B.resolve(O))}this.Path=new S.default(O),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}return C(N,[{key:'path',value:function(){return this.Path}},{key:'resolve',value:function(L){var O,P=-1<L.indexOf('://');return P?L:(O=T.default.resolve(this.directory,L),this.origin+O)}},{key:'relative',value:function(L){return T.default.relative(L,this.directory)}},{key:'toString',value:function(){return this.href}}]),N}();p.default=_,u.exports=p['default']},function(u,p,f){'use strict';var v=f(4);u.exports=v},function(u){function f(){throw new Error('setTimeout has not been defined')}function v(){throw new Error('clearTimeout has not been defined')}function k(z){if(N===setTimeout)return setTimeout(z,0);if((N===f||!N)&&setTimeout)return N=setTimeout,setTimeout(z,0);try{return N(z,0)}catch(M){try{return N.call(null,z,0)}catch(W){return N.call(this,z,0)}}}function C(z){if(A===clearTimeout)return clearTimeout(z);if((A===v||!A)&&clearTimeout)return A=clearTimeout,clearTimeout(z);try{return A(z)}catch(M){try{return A.call(null,z)}catch(W){return A.call(this,z)}}}function E(){P&&O&&(P=!1,O.length?L=O.concat(L):B=-1,L.length&&S())}function S(){if(!P){var z=k(E);P=!0;for(var M=L.length;M;){for(O=L,L=[];++B<M;)O&&O[B].run();B=-1,M=L.length}O=null,P=!1,C(z)}}function R(z,M){this.fun=z,this.array=M}function T(){}var _=u.exports={},N,A;(function(){try{N='function'==typeof setTimeout?setTimeout:f}catch(z){N=f}try{A='function'==typeof clearTimeout?clearTimeout:v}catch(z){A=v}})();var L=[],P=!1,O,B=-1;_.nextTick=function(z){var M=Array(arguments.length-1);if(1<arguments.length)for(var W=1;W<arguments.length;W++)M[W-1]=arguments[W];L.push(new R(z,M)),1!==L.length||P||k(S)},R.prototype.run=function(){this.fun.apply(null,this.array)},_.title='browser',_.browser=!0,_.env={},_.argv=[],_.version='',_.versions={},_.on=T,_.addListener=T,_.once=T,_.off=T,_.removeListener=T,_.removeAllListeners=T,_.emit=T,_.binding=function(){throw new Error('process.binding is not supported')},_.cwd=function(){return'/'},_.chdir=function(){throw new Error('process.chdir is not supported')},_.umask=function(){return 0}},function(u){u.exports=s}])});